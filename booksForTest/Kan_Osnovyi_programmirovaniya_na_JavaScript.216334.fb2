<?xml version="1.0" encoding="windows-1251"?>
<FictionBook xmlns="http://www.gribuser.ru/xml/fictionbook/2.2" xmlns:l="http://www.w3.org/1999/xlink">
<description>
<title-info>
<genre>computers</genre>
<author>
<first-name>Ìàðê</first-name>
<last-name>Êàí</last-name>
</author>
<book-title>Îñíîâû ïðîãðàììèðîâàíèÿ íà JavaScript</book-title>
<annotation>
<p>Êóðñ ïîñâÿùåí èçó÷åíèþ ÿçûêà ïðîãðàììèðîâàíèÿ JavaScript. JavaScript ÿâëÿåòñÿ ÿçûêîì ñöåíàðèåâ (ñêðèïòîâ), êîòîðûé ïðèìåíÿþò â îñíîâíîì äëÿ ñîçäàíèÿ íà Web-ñòðàíèöàõ èíòåðàêòèâíûõ ýëåìåíòîâ. Åãî ìîæíî èñïîëüçîâàòü äëÿ ïîñòðîåíèÿ ìåíþ, ïðîâåðêè ïðàâèëüíîñòè çàïîëíåíèÿ ôîðì, ñìåíû èçîáðàæåíèé èëè äëÿ ÷åãî-òî åùå, ÷òî ìîæíî ñäåëàòü íà Web-ñòðàíèöå.</p>
</annotation>
<date></date>
<lang>ru</lang>
</title-info>
<document-info>
<author>
<nickname>navd</nickname>
</author>
<program-used>HTMLtoFB2 v.0.5</program-used>
<date value="2012-07-15">2012-07-15</date>
<id>8DF9ADF8-C574-441A-A904-D5F8F60FC32F</id>
<version>1.01</version>
<history>
<p>Åâãåíèé Ðåçíè÷åíêî 18.10.2009</p>
<p>Sergey R 12.07.2012</p>
<p>navd: Òåêñò îòôîðìàòèðîâàí çàíîâî, ýòî ïðîùå, ÷åì èñïðàâëÿòü îøèáêè.</p>
<p>Âîîáùå-òî òàêèå òåêñòû ëó÷øå äåëàòü â HTML, à íå â íåäîäåëàííîì, ïðèìèòèâíîì è óáîãîì FB2, â êîòîðîì ê òîìó æå êðèâî ðåàëèçîâàí òåã CODE.</p>
</history>
</document-info>
</description>
<body>
<title>
<p>Ìàðê Êàí</p>
<p>Îñíîâû ïðîãðàììèðîâàíèÿ íà JavaScript</p>
</title>
<section>
<empty-line/>
<image l:href="#logo.png"/>
<empty-line/>
</section>
<section>
<title>
<p><emphasis>Ëåêöèÿ 1.</emphasis> ßçûê ñöåíàðèåâ JavaScript</p>
</title>
<p><emphasis>Ââåäåíèå â ÿçûê ñöåíàðèåâ JavaScript.</emphasis></p>
<p><strong>JavaScript</strong> ÿâëÿåòñÿ ÿçûêîì ñöåíàðèåâ (ñêðèïòîâ), êîòîðûé ïðèìåíÿþò â îñíîâíîì äëÿ ñîçäàíèÿ íà Web-ñòðàíèöàõ èíòåðàêòèâíûõ ýëåìåíòîâ. Åãî ìîæíî èñïîëüçîâàòü äëÿ ïîñòðîåíèÿ ìåíþ, ïðîâåðêè ïðàâèëüíîñòè çàïîëíåíèÿ ôîðì, ñìåíû èçîáðàæåíèé èëè äëÿ ÷åãî-òî åùå, ÷òî ìîæíî ñäåëàòü íà Web-ñòðàíèöå. Åñëè âçãëÿíóòü íà Google Maps èëè ñëóæáó GMail êîìïàíèè Google, òî ìîæíî ïîíÿòü, íà ÷òî ñïîñîáåí ñåãîäíÿ ÿçûê <strong>JavaScript</strong>.</p>
<p>Òàê êàê <strong>JavaScript</strong> ÿâëÿåòñÿ â íàñòîÿùåå âðåìÿ åäèíñòâåííûì ÿçûêîì ñöåíàðèåâ, êîòîðûé ïîääåðæèâàþò âñå îñíîâíûå áðàóçåðû Web (<strong>Internet Explorer</strong>, <strong>Firefox</strong>, <strong>Netscape</strong>, <strong>Safari</strong>, <strong>Opera</strong>, <strong>Camino</strong> è ò.ä.), òî îí èñïîëüçóåòñÿ î÷åíü øèðîêî.</p>
<p>Êîä <strong>JavaScript</strong> îáû÷íî âûïîëíÿåòñÿ Web-áðàóçåðîì êëèåíòà, è â ýòîì ñëó÷àå îí íàçûâàåòñÿ ñöåíàðèåì íà ñòîðîíå êëèåíòà. Íî êîä <strong>JavaScript</strong> ìîæíî âûïîëíÿòü òàêæå íà Web-ñåðâåðå äëÿ ôîðìèðîâàíèÿ äîêóìåíòîâ <strong>HTML</strong>, âîïëîùàÿ òåì ñàìûì ñöåíàðèé íà ñòîðîíå ñåðâåðà. Õîòÿ èñïîëüçîâàíèå <strong>JavaScript</strong> îáû÷íî îãðàíè÷èâàåòñÿ ñöåíàðèÿìè íà ñòîðîíå êëèåíòà, îí ÿâëÿåòñÿ òàêæå î÷åíü ìîùíûì ñåðâåðíûì ÿçûêîì.</p>
<p>Ïðè ñîçäàíèè êîäà <strong>JavaScript</strong> òðåáóåòñÿ ôàêòè÷åñêè òîëüêî òåêñòîâûé ðåäàêòîð è Web-áðàóçåð. Çíàíèå <strong>HTML</strong> è <strong>CSS</strong> áóäåò èãðàòü îïðåäåëåííî ïîëîæèòåëüíóþ ðîëü, è åñëè âû çàõîòèòå èñïîëüçîâàòü íàâûêè <strong>JavaScript</strong> íà Web-ñàéòå, òî ïîíàäîáèòñÿ òàêæå Web-ñàéò. Åñëè ó âàñ óæå åñòü Web-ñàéò, òî îòëè÷íî! Åñëè íåò, òî ñóùåñòâóåò ìíîæåñòâî áåñïëàòíûõ ñåðâåðîâ, êîòîðûå ìîæíî èñïîëüçîâàòü äëÿ ðàçìåùåíèÿ ñâîèõ ñòðàíèö.</p>
<p>×òî êàñàåòñÿ òåêñòîâîãî ðåäàêòîðà, òî â Windows èìååòñÿ ðåäàêòîð NotePad. Õîòÿ ýòîãî áóäåò äîñòàòî÷íî äëÿ ðåäàêòèðîâàíèÿ <strong>JavaScript</strong>, <strong>HTML</strong> è <strong>CSS</strong>, áîëåå ìîùíûé ðåäàêòîð, òàêîé, íàïðèìåð, êàê EditPlus èëè äðóãîé, ìîæåò îêàçàòüñÿ áîëåå óäîáíûì.</p>
<p>Íó, à òåïåðü ìîæíî ïåðåéòè ê ñîçäàíèþ ñöåíàðèÿ <strong>JavaScript</strong>!</p>
<p>Ïðåæäå âñåãî, íåîáõîäèìî óçíàòü, êàê äîáàâèòü ñöåíàðèé <strong>JavaScript</strong> íà ñòðàíèöó <strong>HTML</strong>. Ýòî ìîæíî ñäåëàòü îäíèì èç äâóõ ñïîñîáîâ: ïîìåñòèòü òåãè <strong>Script</strong> íà Web-ñòðàíèöå è ðàñïîëîæèòü êîä <strong>JavaScript</strong> âíóòðè ýòèõ òåãîâ, èëè ïîìåñòèòü âåñü êîä <strong>JavaScript</strong> â îòäåëüíûé ôàéë è ñâÿçàòüñÿ ñ íèì ñ ïîìîùüþ òåãà <strong>Script</strong>.</p>
<p>Ëþáîé èç ýòèõ ìåòîäîâ âïîëíå äîïóñòèì, íî îíè èìåþò ðàçíîå íàçíà÷åíèå. Åñëè èìååòñÿ íåáîëüøîé êîä, êîòîðûé áóäåò èñïîëüçîâàòüñÿ òîëüêî íà îäíîé ñòðàíèöå, òî ðàçìåùåíèå åãî ìåæäó òåãàìè <strong>Script</strong> áóäåò õîðîøèì ðåøåíèåì. Åñëè, îäíàêî, èìååòñÿ áîëüøîé ôðàãìåíò êîäà, êîòîðûé áóäåò èñïîëüçîâàòüñÿ íà íåñêîëüêèõ ñòðàíèöàõ, òî, íàâåðíî, ëó÷øå ïîìåñòèòü ýòîò êîä <strong>JavaScript</strong> â îòäåëüíûé ôàéë è ñîåäèíèòüñÿ ñ íèì. Ýòî äåëàåòñÿ äëÿ òîãî, ÷òîáû íå íóæíî áûëî çàãðóæàòü ýòîò êîä âñÿêèé ðàç ïðè ïîñåùåíèè ðàçëè÷íûõ ñòðàíèö. Êîä çàãðóæàåòñÿ îäèí ðàç, è áðàóçåð ñîõðàíÿåò åãî äëÿ ïîñëåäóþùåãî èñïîëüçîâàíèÿ. Ýòî ïîõîæå íà òî, êàê èñïîëüçóþòñÿ êàñêàäíûå òàáëèöû ñòèëåé (<strong>CSS</strong>).</p>
<p>Íèæå ïðèâåäåíû ïðèìåðû äâóõ ñïîñîáîâ ïîäêëþ÷åíèÿ êîäà <strong>JavaScript</strong>:</p>
<empty-line/>
<p><code>&lt;script type="text/javascript"&gt;&lt;/script&gt;</code></p>
<p><code>&lt;script type="text/javascript" src="scripts/JavaScriptFile.js"&gt;&lt;/script&gt;</code></p>
<empty-line/>
<p>Â ïåðâîì ïðèìåðå, êîä <strong>JavaScript</strong> ïîìåùàåòñÿ ìåæäó ñèìâîëàìè <strong>&gt;</strong> è <strong>&lt;</strong>, ïðÿìî ïåðåä <strong>&lt;/script&gt;</strong>. Åñëè âû ñîâåðøåííî íå çíàåòå, êàê ðàáîòàåò Web-ñòðàíèöà, òî âîò ïðèìåð òîãî, êàê óñòðîåíà ñòðàíèöà <strong>HTML</strong>:</p>
<empty-line/>
<p><code>&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;</code></p>
<p><code>&lt;HTML&gt;</code></p>
<p><code>&lt;HEAD&gt;</code></p>
<p><code>&lt;TITLE&gt; Çäåñü ðàñïîëàãàåòñÿ çàãîëîâîê ñòðàíèöû &lt;/TITLE&gt;</code></p>
<p><code>&lt;META NAME="Generator" CONTENT="EditPlus"&gt;</code></p>
<p><code>&lt;META NAME="Author" CONTENT="Èìÿ àâòîðà"&gt;</code></p>
<p><code>&lt;SCRIPT TYPE="text/javascript"&gt;</code></p>
<p><code>&lt;/SCRIPT&gt;</code></p>
<p><code>&lt;/HEAD&gt;</code></p>
<p><code>&lt;BODY&gt;</code></p>
<p><code>Çäåñü ðàñïîëàãàåòñÿ îñíîâíàÿ ñîäåðæàòåëüíàÿ ÷àñòü Web-ñòðàíèöû (òåëî).</code></p>
<p><code>&lt;/BODY&gt;</code></p>
<p><code>&lt;/HTML&gt;</code></p>
<empty-line/>
<p>Ñîõðàíèòå ýòîò ôàéë ãäå-íèáóäü íà ñâîåì êîìïüþòåðå ñ ðàñøèðåíèåì <strong>.html</strong>, òàê, ÷òîáû ïîëíîå èìÿ ôàéëà áûëî, íàïðèìåð, òàêèì: <strong>JavaScript_Lecture_1.html</strong>. Ïîñëå ñîõðàíåíèÿ ôàéëà ñäåëàéòå íà íåì äâîéíîé ùåë÷îê ìûøüþ, ÷òîáû îòêðûòü â èñïîëüçóåìîì ïî óìîë÷àíèþ áðàóçåðå.</p>
<p>Ïî÷òè ëþáîé ÿçûê ïðîãðàììèðîâàíèÿ â ìèðå èìååò äåëî ñ îáúåêòàìè, íàçûâàåìûìè "ïåðåìåííûìè", è <strong>JavaScript</strong> íå ÿâëÿåòñÿ èñêëþ÷åíèåì. Ïåðåìåííàÿ ÿâëÿåòñÿ ïðîñòî ýëåìåíòîì äàííûõ ñ ïðèñîåäèíåííûì ê íåìó èìåíåì. Îíà ìîæåò ñîäåðæàòü ÷èñëî, ñëîâî èëè ïðåäëîæåíèå (íàçûâàåìûå ñòðîêàìè – <strong>String</strong>) èëè îáúåêò (<strong>Object</strong>), î êîòîðûõ áóäåò ðàññêàçàíî ïîçæå. Åñëè êîäó íåîáõîäèìî ñîîáùèòü, ÷òî èìååòñÿ <strong>5</strong> ÿáëîê, òî ìîæíî ñîçäàòü ïåðåìåííóþ ñ èìåíåì <strong>apples</strong> è çàäàòü åé çíà÷åíèå <strong>5</strong>. Äàâàéòå ñåé÷àñ ýòî ñäåëàåì. Â <strong>JavaScript</strong> äëÿ îïðåäåëåíèÿ ïåðåìåííîé èñïîëüçóåòñÿ êëþ÷åâîå ñëîâî <strong>var</strong>. Îòìåòèì, ÷òî <strong>JavaScript</strong> ðàçëè÷àåò ðåãèñòð ñèìâîëîâ, ïîýòîìó <strong>var</strong> îçíà÷àåò íå òî æå ñàìîå, ÷òî <strong>VAR</strong> èëè <strong>Var</strong>.</p>
<empty-line/>
<p><code>var apples = 5;</code></p>
<empty-line/>
<p>Íåîáõîäèìî ñäåëàòü äâà âàæíûõ çàìå÷àíèÿ â îòíîøåíèè ýòîãî íåáîëüøîãî ôðàãìåíòà êîäà. Ïåðâîå: òðåáóåòñÿ ïîìíèòü î òîì, ÷òî <strong>JavaScript</strong> ÿâëÿåòñÿ "ñëàáî òèïèçèðîâàííûì" ÿçûêîì. Ýòî îçíà÷àåò, ÷òî ïðè îïðåäåëåíèè ïåðåìåííûõ íå òðåáóåòñÿ óêàçûâàòü, êàêîãî îíè òèïà: áóäóò ëè îíè ÷èñëàìè, ñòðîêàìè, îáúåêòàìè, è ò.ä. Âî ìíîãèõ äðóãèõ ÿçûêàõ íåîáõîäèìî äåëàòü ýòî ðàçëè÷èå.</p>
<p>Âòîðîå: îáðàòèòå âíèìàíèå íà òî÷êó ñ çàïÿòîé (<strong>;</strong>) â êîíöå ñòðîêè. Ýòî ãîâîðèò èíòåðïðåòàòîðó <strong>JavaScript</strong>, ÷òî âû çàêîí÷èëè äåëàòü òî, ÷òî äåëàëè â äàííûé ìîìåíò, – â íàøåì ñëó÷àå ýòî çàäàíèå çíà÷åíèÿ <strong>5</strong> ïåðåìåííîé <strong>apples</strong>. Õîòÿ òî÷êà ñ çàïÿòîé íå ÿâëÿåòñÿ îáÿçàòåëüíîé â <strong>JavaScript</strong>, ëó÷øå ïðèâûêíóòü åå èñïîëüçîâàòü.</p>
<p>Èòàê, ìû îïðåäåëèëè â êîäå, ÷òî èìååòñÿ <strong>5</strong> ÿáëîê. ×òî äàëüøå? Èíôîðìàöèÿ î ÿáëîêàõ èìååòñÿ â êîäå, íî íèêòî îá ýòîì íå çíàåò. Íàäî ñîîáùèòü î ÿáëîêàõ! Îäíèì èç íàèáîëåå ðàñïðîñòðàíåííûõ ìåòîäîâ âûâîäà ïðîñòîãî ñîîáùåíèÿ ïîëüçîâàòåëþ ÿâëÿåòñÿ îòïðàâêà óâåäîìëåíèÿ (<strong>alert</strong>):</p>
<empty-line/>
<p><code>var apples = 5;</code></p>
<p><code>alert('Èìååòñÿ' + apples + 'ÿáëîê!');</code></p>
<empty-line/>
<p>Åñëè ïðîòåñòèðîâàòü ýòîò ñöåíàðèé, òî íà ýêðàíå ïîÿâèòñÿ îêíî ñ ñîîáùåíèåì "<strong>Èìååòñÿ 5 ÿáëîê!</strong>" Ñåé÷àñ ïîäõîäÿùåå âðåìÿ, ÷òîáû ââåñòè ñòðîêè (<strong>String</strong>) è òàê íàçûâàåìóþ êîíêàòåíàöèþ èëè ñîåäèíåíèå ñòðîê. Ñòðîêà ÿâëÿåòñÿ ïðîñòî íåáîëüøèì ôðàãìåíòîì òåêñòà è ìîæåò ñîäåðæàòü ëþáîé òåêñò. Â <strong>JavaScript</strong> ìû ñîîáùàåì êîäó, ÷òî èìååòñÿ ñòðîêà, çàêëþ÷àÿ åå â îäèíî÷íûå èëè äâîéíûå êàâû÷êè (<strong>"</strong> èëè <strong>'</strong>). Ìîæíî èñïîëüçîâàòü ëþáîé òèï êàâû÷åê. Çíàêè ïëþñ (<strong>+</strong>) â ïðèìåðå âûøå ñîîáùàþò êîäó, ÷òî ìû ñîåäèíÿåì ñòðîêó ñ ïðåäûäóùåé ñòðîêîé.</p>
<p>Èòàê ìû èìååì ñòðîêó "<strong>Èìååòñÿ</strong>" çà êîòîðîé ñëåäóåò ïåðåìåííàÿ <strong>apples</strong> (ðàâíàÿ <strong>5</strong>), çà êîòîðîé ñëåäóåò åùå îäíà ñòðîêà "<strong>ÿáëîê!</strong>". Ñîåäèíèì èõ âìåñòå è ïîëó÷èì "<strong>Èìååòñÿ 5 ÿáëîê!</strong>". Êîìàíäà <strong>alert</strong> ïîëó÷àåò òî, ÷òî åé ïåðåäàåòñÿ (òî, ÷òî íàõîäèòñÿ ìåæäó ñêîáîê) è îòêðûâàåò îêíî ñ òåêñòîì.</p>
<p>×òî åñëè ìû õîòèì ïðåäëîæèòü ïîëüçîâàòåëþ ñúåñòü ÿáëîêî? Ìîæíî, íàïðèìåð, ñïðîñèòü, ñêîëüêî ÿáëîê îí õîòåë áû ñúåñòü:</p>
<empty-line/>
<p><code>var apples = 5;</code></p>
<p><code>alert('Èìååòñÿ' + apples + 'ÿáëîê!');</code></p>
<p><code>var eat = prompt('Ñêîëüêî ÿáëîê âû õîòèòå ñúåñòü?', '1');</code></p>
<empty-line/>
<p><strong>prompt</strong> ÿâëÿåòñÿ äðóãîé âñòðîåííîé ôóíêöèåé, àíàëîãè÷íîé <strong>alert</strong>. Îäíàêî âìåñòî ïðîñòîãî âûâîäà èíôîðìàöèè îíà òàêæå ïîëó÷àåò ââîä îò ïîëüçîâàòåëÿ. Â äàííîì ñëó÷àå ìû ñïðàøèâàåì ó ïîëüçîâàòåëÿ, ñêîëüêî ÿáëîê îí õîòåë áû ñúåñòü. <strong>'1'</strong> â êîäå ñîîáùàåò ôóíêöèè <strong>prompt</strong>, ÷òî çíà÷åíèåì ïî óìîë÷àíèþ äëÿ êîëè÷åñòâà ÿáëîê áóäåò <strong>1</strong>, òàê êàê ëþäè îáû÷íî åäÿò òîëüêî îäíî ÿáëîêî çà ðàç. Îäíàêî ïîëüçîâàòåëü ìîæåò èçìåíèòü ýòî çíà÷åíèå íà ëþáîå äðóãîå. Êîãäà ïîëüçîâàòåëü ùåëêíåò íà êíîïêå <strong>OK</strong>, ïåðåìåííîé <strong>eat</strong> áóäåò çàäàíî çíà÷åíèå ýòîãî ââîäà. Ïîýòîìó åñëè ïîëüçîâàòåëü ââåäåò <strong>2</strong>, òî <strong>eat</strong> áóäåò ðàâíî <strong>2</strong>.</p>
<p>Ïîýòîìó, åñëè ïîëüçîâàòåëü ñúåë <strong>2</strong> ÿáëîêà, òî îñòàíåòñÿ <strong>3</strong>, òàê? Ïîýòîìó âûïîëíèì íåñêîëüêî ïðîñòûõ ìàòåìàòè÷åñêèõ îïåðàöèé è ïîêàæåì ðåçóëüòàò.</p>
<empty-line/>
<p><code>var apples = 5;</code></p>
<p><code>alert('Èìååòñÿ' + apples + 'ÿáëîê!');</code></p>
<p><code>var eat = prompt('Ñêîëüêî ÿáëîê âû õîòèòå ñúåñòü?', '1');</code></p>
<p><code>apples -= parseInt(eat);</code></p>
<p><code>alert('À òåïåðü èìååòñÿ òîëüêî' + apples + 'ÿáëîê!');</code></p>
<empty-line/>
<p>Çäåñü ìû âèäèì äâà íîâûõ ýëåìåíòà. Ïðåæäå âñåãî, îáðàùåíèå ê ôóíêöèè <strong>parseInt</strong>, êîòîðàÿ ïîëó÷àåò ñòðîêó è âîçâðàùàåò ÷èñëî. Òàê êàê äëÿ âûïîëíåíèÿ ìàòåìàòè÷åñêèõ îïåðàöèé òðåáóþòñÿ ÷èñëà, òî ýòî ãàðàíòèðóåò, ÷òî ìû èìååì ÷èñëî. Åñëè ïîëüçîâàòåëü ââåäåò â ïîëå <strong>2</strong>, òî <strong>parseInt</strong> ïðåâðàòèò ýòî â ÷èñëî <strong>2</strong>.</p>
<p>Çàòåì, îïåðàòîð <strong>– =</strong>, êîòîðûé îçíà÷àåò âû÷èòàíèå èç ëåâîé ÷àñòè îïåðàòîðà çíà÷åíèÿ ïðàâîé ÷àñòè. Ïîýòîìó çíà÷åíèå ïåðåìåííîé <strong>eat</strong> âû÷èòàåòñÿ èç ïåðåìåííîé <strong>apples</strong>. Ìîæíî òàêæå çàïèñàòü ýòó ñòðîêó ñëåäóþùèì îáðàçîì:</p>
<empty-line/>
<p><code>apples = apples – parseInt(eat);</code></p>
<empty-line/>
<p>Ýòî îçíà÷àåò â òî÷íîñòè òî æå ñàìîå è ìîæåò áûòü íåìíîãî ëåã÷å äëÿ ïîíèìàíèÿ. Òåïåðü, êîãäà èçâåñòíî, ñêîëüêî îñòàëîñü ÿáëîê, ìû åùå ðàç ñîîáùàåì ïîëüçîâàòåëþ ýòó èíôîðìàöèþ.</p>
<p>Ñóùåñòâóþò äðóãèå îïåðàòîðû, ïîäîáíûå <strong>– =</strong>, êîòîðûå äåëàþò ïîõîæèå âåùè. Âñåãî èìååòñÿ 8 îáû÷íûõ àðèôìåòè÷åñêèõ îïåðàòîðîâ:</p>
<empty-line/>
<p><code>+</code></p>
<p><code>-</code></p>
<p><code>/</code></p>
<p><code>*</code></p>
<p><code>+=</code></p>
<p><code>-=</code></p>
<p><code>/=</code></p>
<p><code>*=</code></p>
<empty-line/>
<p>Âîò è âñå äëÿ íà÷àëà. Â ñëåäóþùåé ëåêöèè ìû äîáàâèì â êîä ïðîâåðêó, ââåäåì îïåðàòîðû <strong>if</strong> è <strong>else</strong> è âêðàòöå ïîçíàêîìèìñÿ ñ ôóíêöèÿìè.</p>
</section>
<section>
<title>
<p><emphasis>Ëåêöèÿ 2.</emphasis> Îïåðàòîðû è ôóíêöèè</p>
</title>
<p><emphasis>Îñíîâû ïðîâåðêè ñöåíàðèåâ. Îïåðàòîðû if è else. Ñïîñîáû çàïèñè êîììåíòàðèåâ. Êðàòêîå çíàêîìñòâî ñ ôóíêöèÿìè.</emphasis></p>
<p>Ïðè òåñòèðîâàíèè ñöåíàðèÿ, íàïèñàííîãî â ïðåäûäóùåé ëåêöèè, ìîæíî çàìåòèòü, ÷òî ðåçóëüòàò, ïîëó÷àåìûé èç <strong>prompt</strong>, òðåáóåò íåêîòîðîé ïðîâåðêè. Êîãäà ñöåíàðèé ñïðàøèâàåò, ñêîëüêî ÿáëîê æåëàåò ñúåñòü ïîëüçîâàòåëü, òî ïîëüçîâàòåëü ìîæåò ââåñòè ÷èñëî áîëüøå <strong>5</strong>, ìåíüøå <strong>0</strong> èëè ÷òî-òî, ÷òî âîîáùå íå ÿâëÿåòñÿ ÷èñëîì. Â êàæäîì èç òàêèõ ñëó÷àåâ æåëàòåëüíî èíôîðìèðîâàòü ïîëüçîâàòåëåé, ÷òî ââåäåíî íåäîïóñòèìîå çíà÷åíèå.</p>
<p>Òàê êàê â ýòîì ñöåíàðèè èìååòñÿ òîëüêî <strong>5</strong> ÿáëîê, òî ýòî ìàêñèìàëüíîå êîëè÷åñòâî ÿáëîê, êîòîðîå ìîæåò ïîëó÷èòü ïîëüçîâàòåëü. Ïîýòîìó íà÷íåì ñ ïðîâåðêè, ÷òî ââåäåííîå ÷èñëî íå áîëüøå <strong>5</strong>.</p>
<empty-line/>
<p><code>var apples = 5;</code></p>
<p><code>alert('Èìååòñÿ' + apples + 'ÿáëîê!');</code></p>
<p><code>var eat = prompt('Ñêîëüêî ÿáëîê âû õîòèòå ñúåñòü?', '1');</code></p>
<p><code>var eaten = parseInt(eat);</code></p>
<p><code>if(eaten &gt; 5){</code></p>
<p><code>alert('Ïðîñòèòå, íî èìååòñÿ òîëüêî 5 ÿáëîê.' + 'Âû íå ìîæåòå ñúåñòü' + eaten + 'ÿáëîê!');</code></p>
<p><code>} else {</code></p>
<p><code>apples -= eaten;</code></p>
<p><code>alert('À òåïåðü èìååòñÿ òîëüêî' + apples + 'ÿáëîê!');</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Îñíîâíûìè íîâûìè ïîíÿòèÿìè çäåñü ÿâëÿþòñÿ îïåðàòîðû <strong>if</strong> è <strong>else</strong>. Îïåðàòîðû <strong>if</strong> è <strong>else</strong> äîñòàòî÷íî ëåãêî ïîíÿòü. Ïðèâåäåííûé âûøå êîä äàåò âîçìîæíîñòü ñêàçàòü: "Åñëè ïîëüçîâàòåëü âûáðàë äëÿ åäû áîëåå <strong>5</strong> ÿáëîê, òî ñîîáùèòå åìó, ÷òî òàêîãî êîëè÷åñòâà ÿáëîê íåò. Èíà÷å ïîçâîëüòå åìó ñúåñòü ñòîëüêî ÿáëîê, ñêîëüêî îí ïîïðîñèò.".</p>
<p>Îñíîâíîé ñèíòàêñèñ îïåðàòîðà <strong>if / else</strong> ñëåäóþùèé:</p>
<empty-line/>
<p><code>if(óñëîâèå){</code></p>
<p><code>// êîä, êîòîðûé âûïîëíÿåòñÿ, êîãäà ñïðàâåäëèâî óñëîâèå if</code></p>
<p><code>} else {</code></p>
<p><code>// êîä, êîòîðûé âûïîëíÿåòñÿ, êîãäà óñëîâèå if ëîæíî</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Íåîáõîäèìî îòìåòèòü îòêðûâàþùóþ è çàêðûâàþùóþ ñêîáêè, <strong>{</strong> è <strong>}</strong>, â ïðèâåäåííîì âûøå êîäå. Îòêðûâàþùàÿ ñêîáêà ñîîáùàåò êîäó, ãäå íà÷èíàåòñÿ áëîê êîäà, à çàêðûâàþùàÿ ñêîáêà óêàçûâàåò êîäó, ãäå áëîê çàêàí÷èâàåòñÿ. Ïîýòîìó âñå ìåæäó <strong>{</strong> è <strong>}</strong> âûïîëíÿåòñÿ êàê ÷àñòü îïåðàòîðà <strong>if</strong>. Íåîáõîäèìî îòìåòèòü, ÷òî çàêðûâàþùàÿ ñêîáêà îïåðàòîðà <strong>if</strong> ðàçìåùàåòñÿ íåïîñðåäñòâåííî ïåðåä êëþ÷åâûì ñëîâîì <strong>else</strong>. Îïåðàòîð <strong>else</strong> èìååò ñâîé ñîáñòâåííûé íàáîð ñêîáîê è ñâîé ñîáñòâåííûé áëîê äëÿ âûïîëíåíèÿ.</p>
<p>Äâå êîñûå ÷åðòû <strong>//</strong> â ïðèâåäåííîì ïðèìåðå ãîâîðÿò êîäó, ÷òî çäåñü íàõîäèòñÿ êîììåíòàðèé. Êîììåíòàðèé ÿâëÿåòñÿ ÷àñòüþ êîäà, êîòîðûé íå âûïîëíÿåòñÿ. Îíè îáû÷íî èñïîëüçóþòñÿ äëÿ îïèñàíèÿ ôóíêöèé ðåàëüíîãî êîäà, ÷òîáû íå òðåáîâàëîñü èçó÷àòü êîä äëÿ âûÿñíåíèÿ, ÷òî îí äåëàåò. Åñëè, íàïðèìåð, èìååòñÿ î÷åíü äëèííûé ôðàãìåíò êîäà, êîòîðûé ïðîâåðÿåò âõîäÿùèå äàííûå ôîðìû, òî áóäåò âïîëíå ðàçóìíî âñòàâèòü êîììåíòàðèé, ãîâîðÿùèé ÷òî-íèáóäü âðîäå "<strong>Ñëåäóþùèé êîä ïðîâåðÿåò ââîä ïîëüçîâàòåëÿ â ôîðìó</strong>". Â ýòîì ñëó÷àå ëþáîé, êòî áóäåò ïðîñìàòðèâàòü êîä, èëè ñàì àâòîð êîäà íåñêîëüêî ìåñÿöåâ ñïóñòÿ ïîñëå íàïèñàíèÿ, ñðàçó ïîéìåò, ÷òî ýòîò êîä äåëàåò.</p>
<p>Â <strong>JavaScript</strong> ñóùåñòâóåò äâà ñïîñîáà çàïèñè êîììåíòàðèåâ. Ïåðâûé, êîòîðûé ìû óæå âèäåëè, ñîñòîèò â èñïîëüçîâàíèè <strong>//</strong>. Âñå ñëåäóþùåå çà <strong>//</strong> äî êîíöà ñòðîêè ñ÷èòàåòñÿ êîììåíòàðèåì è ïîýòîìó èãíîðèðóåòñÿ ïðè âûïîëíåíèè êîäà. Äðóãîé ñïîñîá ñîñòîèò â èñïîëüçîâàíèè êîìáèíàöèé ñèìâîëîâ <strong>/*</strong> è <strong>*/</strong>, â ýòîì ñëó÷àå âñå, ÷òî íàõîäèòñÿ ìåæäó íèìè, èãíîðèðóåòñÿ.</p>
<empty-line/>
<p><code>// ýòî îäíîñòðî÷íûé êîììåíòàðèé</code></p>
<empty-line/>
<p><code>/*</code></p>
<p><code>åñëè òðåáóåòñÿ áîëåå äëèííûé êîììåíòàðèé, òî</code></p>
<p><code>ëó÷øå èñïîëüçîâàòü "áëî÷íûé êîììåíòàðèé".</code></p>
<p><code>Ýòîò êîììåíòàðèé ÿâëÿåòñÿ áëî÷íûì êîììåíòàðèåì,</code></p>
<p><code>è ïîëíîñòüþ èãíîðèðóåòñÿ ïðè âûïîëíåíèè êîäà</code></p>
<p><code>*/</code></p>
<empty-line/>
<p>Äëÿ êîðîòêîãî ñöåíàðèÿ êîììåíòàðèè íå âñåãäà íóæíû. Íî êîãäà êîä äëèííûé, îíè ñòàíîâÿòñÿ íåîáõîäèìîñòüþ. Ïðîãðàììèñòàì î÷åíü ÷àñòî ïðèõîäèòñÿ ïðîñìàòðèâàòü òûñÿ÷è ñòðîê êîäà â ïîïûòêå íàéòè ìåñòî äëÿ èñïðàâëåíèÿ îøèáêè. Åñëè êîä èìååò õîðîøèå êîììåíòàðèè, òî äîñòàòî÷íî ëåãêî ïî÷òè òî÷íî îïðåäåëèòü, ãäå íàõîäèòñÿ íóæíûé êîä.</p>
<p>Âåðíåìñÿ ê íàøåìó îïåðàòîðó <strong>if</strong>,</p>
<empty-line/>
<p><code>if(eaten &gt; 5){</code></p>
<p><code>alert('Ïðîñòèòå, íî èìååòñÿ òîëüêî 5 ÿáëîê.</code></p>
<p><code>'Âû íå ìîæåòå ñúåñòü' + eaten + 'ÿáëîê!');</code></p>
<p><code>} else {</code></p>
<p><code>apples -= eaten;</code></p>
<p><code>alert('À òåïåðü èìååòñÿ òîëüêî' + apples + 'ÿáëîê!');</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Ìîæíî âèäåòü, ÷òî óñëîâèåì ÿâëÿåòñÿ <strong>eaten &gt; 5</strong>. Çíàê <strong>&gt;</strong> îçíà÷àåò "<strong>áîëüøå ÷åì</strong>", òàê ÷òî ýòî óñëîâèå îçíà÷àåò "<strong>åñëè eaten áîëüøå 5</strong>". Àíàëîãè÷íî, <strong>&lt;</strong> îçíà÷àåò "<strong>ìåíüøå ÷åì</strong>".</p>
<p>Ñóùåñòâóåò äâà äðóãèõ àíàëîãè÷íûõ çíàêà <strong>&gt;=</strong> è <strong>&lt;=</strong>, êîòîðûå îçíà÷àþò "<strong>áîëüøå ÷åì èëè ðàâíî</strong>" è "<strong>ìåíüøå ÷åì èëè ðàâíî</strong>" ñîîòâåòñòâåííî.</p>
<p>Â ïðèâåäåííîì âûøå êîäå ìû ñîîáùàåì ïîëüçîâàòåëþ î òîì, ÷òî îí ââåë çíà÷åíèå áîëüøå <strong>5</strong> ÿáëîê. Òîëüêî åñëè îí âûáðàë ìåíüøå <strong>5</strong> ÿáëîê, ýòî ÷èñëî âû÷èòàåòñÿ èç òåêóùåãî êîëè÷åñòâà ÿáëîê è çàòåì ïîëüçîâàòåëþ ñîîáùàåòñÿ, ñêîëüêî ÿáëîê îñòàëîñü. Îäíàêî ñóùåñòâóåò åùå äâà âîçìîæíûõ ñëó÷àÿ. ×òî, åñëè ïîëüçîâàòåëü ââåäåò ÷èñëî ìåíüøå <strong>0</strong>? ×òî, åñëè îí ââåäåò çíà÷åíèå, êîòîðîå íå ÿâëÿåòñÿ ÷èñëîì? Ïåðâûé ñëó÷àé ÷èòàòåëü ìîæåò òåïåðü îáðàáîòàòü ñàìîñòîÿòåëüíî. Âòîðîé ñëó÷àé òðåáóåò èñïîëüçîâàíèÿ äðóãîé âñòðîåííîé ôóíêöèè, <strong>isNaN</strong>. Ïðè ïîïûòêå ïðåîáðàçîâàòü ÷òî-íèáóäü â ÷èñëî ñ ïîìîùüþ ôóíêöèè <strong>parseInt</strong>, âîçâðàùàåòñÿ çíà÷åíèå <strong>NaN</strong>, åñëè ôóíêöèÿ íå ìîæåò âûïîëíèòü îïåðàöèþ. <strong>NaN</strong> îçíà÷àåò <strong>Not a Number</strong> (Íå ÷èñëî). Åñëè âûçâàòü ôóíêöèþ <strong>parseInt</strong>, íàïðèìåð, ñî çíà÷åíèåì <strong>apple</strong>, òî áóäåò ïîëó÷åíî çíà÷åíèå <strong>NaN</strong>, òàê êàê ñëîâî <strong>apple</strong> íå ÿâëÿåòñÿ ÷èñëîì.</p>
<empty-line/>
<p><code>var apples = 5;</code></p>
<p><code>alert('Èìååòñÿ' + apples + 'ÿáëîê!');</code></p>
<p><code>var eat = prompt('Ñêîëüêî ÿáëîê âû õîòèòå ñúåñòü?', '1');</code></p>
<p><code>var eaten = parseInt(eat);</code></p>
<p><code>if(isNaN(eaten)){</code></p>
<p><code>alert('Âû äîëæíû ââåñòè äîïóñòèìîå ÷èñëî ÿáëîê!');</code></p>
<p><code>} else if(eaten &gt; apples){</code></p>
<p><code>alert('Ïðîñòèòå, íî èìååòñÿ òîëüêî' + apples + 'ÿáëîê.</code></p>
<p><code>'Âû íå ìîæåòå ñúåñòü' + eaten +</code></p>
<p><code>'ÿáëîê!');</code></p>
<p><code>} else if(eaten &lt; 0){</code></p>
<p><code>alert('Ïðîñòèòå, íî âû íå ìîæåòå ñúåñòü</code></p>
<p><code>îòðèöàòåëüíîå êîëè÷åñòâî ÿáëîê!');</code></p>
<p><code>} else {</code></p>
<p><code>apples -= eaten;</code></p>
<p><code>alert('À òåïåðü èìååòñÿ òîëüêî' + apples + 'ÿáëîê!');</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Òåïåðü âñå ýòî äîëæíî áûòü ïîíÿòíî ÷èòàòåëþ. Ïðåæäå âñåãî ïðîâåðÿåòñÿ, ÷òî ââåäåíî äîïóñòèìîå çíà÷åíèå. Åñëè çíà÷åíèå íåäîïóñòèìî, âûâîäèòñÿ ñîîòâåòñòâóþùåå ñîîáùåíèå. Çàòåì ïðîâåðÿåòñÿ, ÷òî ââåäåííîå ÷èñëî íå ïðåâûøàåò êîëè÷åñòâî ñóùåñòâóþùèõ ÿáëîê, à çàòåì – ÷òî ýòî ÷èñëî íå ÿâëÿåòñÿ îòðèöàòåëüíûì. Åñëè âñå ýòè ïðîâåðêè ïðîõîäÿò óñïåøíî, ïîëüçîâàòåëü ñìîæåò ñúåñòü ñòîëüêî ÿáëîê, ñêîëüêî çàõî÷åò. Â êîäå ñäåëàíî åùå îäíî èçìåíåíèå, âìåñòî <strong>if(eaten &gt; 5)</strong> èñïîëüçóåòñÿ <strong>if(eaten &gt; apples)</strong>. Åñëè â ïîñëåäóþùåì êîëè÷åñòâî èìåþùèõñÿ ÿáëîê <strong>var apples = 5;</strong> èçìåíèòñÿ, òî ýòî èçìåíåíèå ïðèøëîñü áû äåëàòü òîëüêî â îäíîì ìåñòå. Ñòàðàéòåñü âñåãäà èñïîëüçîâàòü â êîäå ïåðåìåííûå. Åñëè çíà÷åíèÿ "æåñòêî çàêîäèðîâàíû", êàê áûëî ñäåëàíî ðàíåå â êîäå <strong>if(eaten &gt; 5)</strong>, òî î÷åíü ÷àñòî ïðè âíåñåíèè èçìåíåíèé ïðèäåòñÿ ïîäîëãó èñêàòü ýòè æåñòêî çàêîäèðîâàííûå çíà÷åíèÿ, ÷òîáû óáåäèòüñÿ, ÷òî âíåñåíû âñå íåîáõîäèìûå èçìåíåíèÿ.</p>
<p>Åñëè ïîëüçîâàòåëü ââåë êàêèì-ëèáî îáðàçîì íåäîïóñòèìîå çíà÷åíèå, òî ìîæíî ïîïðîñèòü åãî ïîâòîðíî ââåñòè êîëè÷åñòâî ÿáëîê, êîòîðîå îí õî÷åò ñúåñòü. Îäíèì èç ñïîñîáîâ ñäåëàòü ýòî áûëî áû êîïèðîâàíèå âñåãî êîäà íåñêîëüêî ðàç. Îäíàêî îáû÷íî ýòî íå ñàìîå ëó÷øåå ðåøåíèå. ×òî, åñëè ïîëüçîâàòåëü ââîäèò íåäîïóñòèìîå çíà÷åíèå ñíîâà è ñíîâà? Ìîæíî ïðîäîëæèòü êîïèðîâàíèå êîäà, íî ëåãêî âèäåòü, ÷òî ýòî êðàéíå íåýôôåêòèâíî è î÷åíü òðóäíî ïîääåðæèâàòü êîä â ðàáî÷åì ñîñòîÿíèè.</p>
<p>Â ýòîì ñëó÷àå ëó÷øèì ðåøåíèåì áóäåò èñïîëüçîâàíèå òàê íàçûâàåìîé ôóíêöèè. Ôóíêöèÿ ñîäåðæèò êîä, êîòîðûé âûïîëíÿåò îïðåäåëåííóþ çàäà÷ó. Ìû óæå âèäåëè èñïîëüçîâàíèå ôóíêöèé <strong>alert</strong>, <strong>prompt</strong>, <strong>parseInt</strong> è <strong>isNaN</strong>, êîòîðûå âñòðîåíû â ÿçûê <strong>JavaScript</strong>. Ïðåèìóùåñòâî èñïîëüçîâàíèÿ ôóíêöèé ñîñòîèò â òîì, ÷òî ìîæíî âûïîëíÿòü îäèí è òîò æå áëîê êîäà ñíîâà è ñíîâà, íå êîïèðóÿ ýòîò êîä, Äëÿ âûïîëíåíèÿ ôóíêöèè íåîáõîäèìî íàïèñàòü åå èìÿ, çà êîòîðûì ñëåäóþò ñêîáêè <strong>()</strong>, à âñå çíà÷åíèÿ, ïåðåäàâàåìûå â ôóíêöèþ, çàïèñûâàþòñÿ ìåæäó ñêîáêàìè.</p>
<empty-line/>
<p><code>var apples = 5;</code></p>
<p><code>function eatApples(){</code></p>
<p><code>alert('Èìååòñÿ' + apples + 'ÿáëîê!');</code></p>
<p><code>var eat = prompt('Ñêîëüêî ÿáëîê âû õîòèòå ñúåñòü?', '1');</code></p>
<p><code>var eaten = parseInt(eat);</code></p>
<p><code>if(isNaN(eaten)){</code></p>
<p><code>alert('Âû äîëæíû ââåñòè äîïóñòèìîå ÷èñëî ÿáëîê!');</code></p>
<p><code>eatApples();</code></p>
<p><code>} else if(eaten &gt; apples){</code></p>
<p><code>alert('Ïðîñòèòå, íî èìååòñÿ òîëüêî' + apples + 'ÿáëîê.</code></p>
<p><code>Âû íå ìîæåòå ñúåñòü' + eaten +</code></p>
<p><code>'ÿáëîê!');</code></p>
<p><code>eatApples();</code></p>
<p><code>} else if(eaten &lt; 0){</code></p>
<p><code>alert('Ïðîñòèòå, íî âû íå ìîæåòå ñúåñòü</code></p>
<p><code>îòðèöàòåëüíîå êîëè÷åñòâî ÿáëîê!');</code></p>
<p><code>eatApples();</code></p>
<p><code>} else {</code></p>
<p><code>apples -= eaten;</code></p>
<p><code>alert('À òåïåðü èìååòñÿ òîëüêî' + apples + 'ÿáëîê!');</code></p>
<p><code>if(apples &gt; 0){</code></p>
<p><code>if(confirm('Íå õîòèòå ñúåñòü åùå ÿáëî÷êî?')){</code></p>
<p><code>eatApples();</code></p>
<p><code>}</code></p>
<p><code>} else {</code></p>
<p><code>alert('ßáëîê áîëüøå íåò!');</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Çäåñü âåñü íàø êîä çàïèñàí â âèäå ôóíêöèè ñ èìåíåì <strong>eatApples</strong>. Ìîæíî âèäåòü, ÷òî êàæäûé ðàç, êîãäà ïîëüçîâàòåëü ââîäèò íåâåðíîå çíà÷åíèå, ñíîâà âûçûâàåòñÿ ôóíêöèÿ <strong>eatApples();</strong>, ÷òîáû ïîëüçîâàòåëü ìîã ââåñòè íîâîå çíà÷åíèå. Êîãäà ïîëüçîâàòåëü ââîäèò äîïóñòèìîå çíà÷åíèå, òî îí ëèáî ìîæåò åùå åñòü ÿáëîêè, ëèáî, åñëè âñå ÿáëîêè çàêîí÷èëèñü, îí ïîëó÷èò ñîîòâåòñòâóþùåå ñîîáùåíèå. Çäåñü èñïîëüçóåòñÿ òàêæå îäíà íîâàÿ ôóíêöèÿ, <strong>confirm</strong>. Ôóíêöèÿ <strong>confirm</strong> ïðîñòî âûâîäèò ïîëüçîâàòåëþ ïðèãëàøåíèå <strong>OK or Cancel</strong> ("Äà èëè Îòìåíà"). Åñëè ïîëüçîâàòåëü íàæìåò êíîïêó "<strong>OK</strong>", òî ôóíêöèÿ âîçâðàùàåò çíà÷åíèå <strong>true</strong> (äà). Åñëè ïîëüçîâàòåëü íàæìåò êíîïêó <strong>Cancel</strong> èëè ïðîñòî çàêðîåò îêíî, òî ôóíêöèÿ <strong>confirm</strong> âîçâðàùàåò çíà÷åíèå <strong>false</strong> (íåò). Ïîýòîìó â íàøåì ïðèìåðå ôóíêöèÿ <strong>eatApples</strong> âûçûâàåòñÿ ñíîâà òîëüêî â òîì ñëó÷àå, êîãäà ïîëüçîâàòåëü ùåëêíåò íà êíîïêå <strong>OK</strong>.</p>
<p>Â êîíöå ýòîé ëåêöèè áóäåò ðàññìîòðåíà îáëàñòü äåéñòâèÿ ïåðåìåííîé. Êàê ìîæíî âèäåòü, â ïîñëåäíåì ïðèìåðå ïåðåìåííàÿ <strong>apples</strong> íàõîäèòñÿ âíå ôóíêöèè <strong>eatApples</strong>. Ýòî äåëàåò ïåðåìåííóþ <strong>apples</strong> "ãëîáàëüíîé ïåðåìåííîé", ò.å. îíà áóäåò äîñòóïíà èç ëþáîé ôóíêöèè. Ïåðåìåííàÿ <strong>eat</strong>, ñ äðóãîé ñòîðîíû, ÿâëÿåòñÿ ëîêàëüíîé ïåðåìåííîé è ñóùåñòâóåò òîëüêî âíóòðè ôóíêöèè <strong>eatApples</strong>. Êðîìå òîãî, êàæäûé ðàç ïðè âûçîâå ôóíêöèè <strong>eatApples</strong> ïåðåìåííàÿ <strong>eat</strong> íå áóäåò ñóùåñòâîâàòü, ïîêà íå áóäåò ñíîâà îïðåäåëåíà ôóíêöèåé <strong>prompt</strong>.</p>
<p>×òîáû óâèäåòü ýòó êîíöåïöèþ â äåéñòâèè, íàïèøåì äâå ïðîñòûå ôóíêöèè ñ÷åòà:</p>
<empty-line/>
<p><code>function counting1(){</code></p>
<p><code>var count = 0;</code></p>
<p><code>count++;</code></p>
<p><code>alert(count);</code></p>
<p><code>}</code></p>
<p><code>var count = 0;</code></p>
<p><code>function counting2(){</code></p>
<p><code>count++;</code></p>
<p><code>alert(count);</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Åñëè çàïóñòèòü ýòîò ïðèìåð â áðàóçåðå è ùåëêíóòü íà êàæäîé êíîïêå íåñêîëüêî ðàç, òî ìîæíî çàìåòèòü, ÷òî <strong>counting1</strong> âñåãäà âûäàåò îäíî è òî æå çíà÷åíèå, <strong>1</strong>. <strong>counting2</strong>, ñ äðóãîé ñòîðîíû, âûäàåò óâåëè÷èâàþùååñÿ ÷èñëî. Ïî÷åìó ýòî ïðîèñõîäèò? Ïîñìîòðèì ïðîñòî ñíà÷àëà íà <strong>counting1</strong>. Ìîæíî âèäåòü, ÷òî êàæäûé ðàç ïðè âûïîëíåíèè <strong>counting1</strong> ïðåæäå âñåãî ñîçäàåòñÿ ïåðåìåííàÿ <strong>count</strong> è åå çíà÷åíèå çàäàåòñÿ ðàâíûì <strong>0</strong>. Â ñëåäóþùåé ñòðîêå ïåðåìåííàÿ <strong>count</strong> óâåëè÷èâàåòñÿ íà <strong>1</strong>.</p>
<p>Îïåðàòîð <strong>++</strong> ïîêà åùå íå âñòðå÷àëñÿ. <strong>count++</strong> ïðîñòî óâåëè÷èâàåò <strong>count</strong> íà <strong>1</strong>. Äðóãèìè ñëîâàìè, ýòî â òî÷íîñòè òî æå ñàìîå, ÷òî íàïèñàòü <strong>count += 1</strong> èëè <strong>count = count + 1</strong>. Ïîñêîëüêó óâåëè÷åíèå íà <strong>1</strong> ÿâëÿåòñÿ â ïðîãðàììèðîâàíèè î÷åíü ðàñïðîñòðàíåííûì äåéñòâèåì, òî äëÿ íåãî ñóùåñòâóåò ñïåöèàëüíûé îïåðàòîð. Àíàëîãè÷íî îïåðàòîð <strong>– -</strong> âû÷èòàåò <strong>1</strong> èç ïåðåìåííîé: <strong>count--</strong>.</p>
<p>Êàæäûé ðàç, êîãäà ôóíêöèÿ <strong>counting1</strong> âûïîëíÿåò <strong>alert(count)</strong>, îíà ñîîáùàåò çíà÷åíèå íîâîé ïåðåìåííîé <strong>count</strong> , êîòîðîå òîëüêî ÷òî áûëî îïðåäåëåíî êàê <strong>0+1</strong>.</p>
<p>Òåïåðü ïîñìîòðèì íà <strong>counting2</strong>. Ìîæíî âèäåòü, ÷òî ïåðåìåííàÿ <strong>count</strong> â ýòîì ñëó÷àå íàõîäèòñÿ âíå ôóíêöèè. Äàæå äî âûçîâà ýòîé ôóíêöèè çíà÷åíèå <strong>count</strong> çàäàíî êàê <strong>0</strong>. Ïðè âûçîâå <strong>counting2</strong> ïðåæäå âñåãî ïðîèñõîäèò óâåëè÷åíèå ïåðåìåííîé <strong>count</strong> íà <strong>1</strong>. Òàê êàê ìû íå âîññòàíàâëèâàåì çíà÷åíèå <strong>count</strong> â <strong>0</strong>, êàê â ñëó÷àå <strong>counting1</strong>, òî ïåðåìåííàÿ <strong>count</strong> ïðîäîëæàåò ñîõðàíÿòü ñâîå çíà÷åíèå, è âñå ïðîèñõîäèò, êàê è ïðåäïîëàãàëîñü.</p>
<p>Òåïåðü ÷èòàòåëü ïîëó÷èë îáùåå ïîíèìàíèå íåêîòîðûõ ôóíäàìåíòàëüíûõ ïîíÿòèé ïðîãðàììèðîâàíèÿ è <strong>JavaScript</strong>, â ÷àñòíîñòè. Â ñëåäóþùåé ëåêöèè áóäóò ðàññìîòðåíû öèêëû è ôîðìû.</p>
</section>
<section>
<title>
<p><emphasis>Ëåêöèÿ 3.</emphasis> Ôîðìû è öèêëû</p>
</title>
<p><emphasis>Îñíîâû ðàáîòû ñ ïîëÿìè ôîðì è ñ ôóíêöèÿìè öèêëîâ.</emphasis></p>
<p>Â ïðåäûäóùåé ëåêöèè áûëè ðàññìîòðåíû îïåðàòîðû <strong>if</strong>/<strong>else</strong>, îñíîâû ïðîâåðêè è ôóíêöèé. Åñëè â õîäå äàëüíåéøåãî ÷òåíèÿ âîçíèêíóò êàêèå-òî âîïðîñû, òî èìååò ñìûñë åùå ðàç ïðî÷èòàòü ïðåäûäóùóþ ëåêöèþ.</p>
<p>Ìû çíàåì òåïåðü, êàê ïðîâåðÿòü äàííûå, íî ïðè ñîçäàíèè êîäà <strong>JavaScript</strong> îáû÷íî òðåáóåòñÿ ïðîâåðÿòü íå îñòàâøååñÿ êîëè÷åñòâî âîîáðàæàåìûõ ÿáëîê. Îäíîé èç íàèáîëåå îáùèõ îáëàñòåé ïðèìåíåíèÿ <strong>JavaScript</strong> ÿâëÿþòñÿ ïîëÿ ôîðìû. Ïðåäïîëîæèì, íàïðèìåð, ÷òî èìååòñÿ ïðîñòàÿ êîíòàêòíàÿ ôîðìà. Èíîãäà òðåáóåòñÿ óáåäèòüñÿ, ÷òî ïîëüçîâàòåëü ââåë â ôîðìó ñâîå èìÿ èëè ÷òî îí âûáðàë êàê ìèíèìóì îäíó ðàäèî-êíîïêó äëÿ âîïðîñà. Âîò ïðèìåð òàêîé ôîðìû:</p>
<empty-line/>
<p><code>Èìÿ: Âàø ëþáèìûé öâåò: Ñèíèé Æåëòûé</code></p>
<p><code>Êðàñíûé ×åðíûé</code></p>
<p><code>Çåëåíûé Äðóãîé</code></p>
<p><code>Ôàìèëèÿ:</code></p>
<p><code>Àäðåñ Email:</code></p>
<empty-line/>
<p><code>Îòïðàâèòü ôîðìó Î÷èñòèòü ôîðìó Çàôèêñèðîâàòü ôîðìó íà ìåñòå</code></p>
<empty-line/>
<p>Íèæå ïðåäñòàâëåí êîä ýòîé ôîðìû. Îí ïðèâåäåí òîëüêî äëÿ èëëþñòðàöèè.</p>
<empty-line/>
<p><code>&lt;form name="tutform" onsubmit="return noform();" class="codesnip"</code></p>
<p><code>style="background-color:#FFF;z-index:10;"&gt;</code></p>
<p><code>&lt;table width="100%"&gt;</code></p>
<p><code>&lt;tr&gt;</code></p>
<p><code>&lt;td&gt;Èìÿ:&lt;/td&gt;</code></p>
<p><code>&lt;td&gt;&lt;input name="firstname"&gt;&lt;/td&gt;</code></p>
<p><code>&lt;td&gt;Âàø ëþáèìûé öâåò:&lt;/td&gt;</code></p>
<p><code>&lt;td rowspan="3" valign="top"&gt;</code></p>
<p><code>&lt;input type="radio" name="color" value="blue"&gt;Ñèíèé&lt;br /&gt;</code></p>
<p><code>&lt;input type="radio" name="color" value="red"&gt;Êðàñíûé&lt;br /&gt;</code></p>
<p><code>&lt;input type="radio" name="color" value="green"&gt;Çåëåíûé</code></p>
<p><code>&lt;/td&gt;</code></p>
<p><code>&lt;td rowspan="3" valign="top"&gt;</code></p>
<p><code>&lt;input type="radio" name="color" value="yellow"&gt;Æåëòûé&lt;br /&gt;</code></p>
<p><code>&lt;input type="radio" name="color" value="black"&gt;×åðíûé&lt;br /&gt;</code></p>
<p><code>&lt;input type="radio" name="color" value="other"&gt;Äðóãîé</code></p>
<p><code>&lt;/td&gt;</code></p>
<p><code>&lt;/tr&gt;</code></p>
<p><code>&lt;tr&gt;</code></p>
<p><code>&lt;td&gt;Ôàìèëèÿ:&lt;/td&gt;</code></p>
<p><code>&lt;td&gt;&lt;input name="lastname"&gt;&lt;/td&gt;</code></p>
<p><code>&lt;/tr&gt;</code></p>
<p><code>&lt;tr&gt;</code></p>
<p><code>&lt;td&gt;Àäðåñ Email:&lt;/td&gt;</code></p>
<p><code>&lt;td&gt;&lt;input name="email"&gt;&lt;/td&gt;</code></p>
<p><code>&lt;/tr&gt;</code></p>
<p><code>&lt;tr&gt;</code></p>
<p><code>&lt;td colspan="2"&gt;&lt;input type="submit" value="Îòïðàâèòü ôîðìó"&gt;</code></p>
<p><code>&lt;input type="reset" value="Î÷èñòèòü ôîðìó"&gt;&lt;/td&gt;</code></p>
<p><code>&lt;td colspan="3" align="right"&gt;&lt;button id="lockbutton"</code></p>
<p><code>onclick="swapLock();return false;"&gt;Çàôèêñèðîâàòü ôîðìó íà ìåñòå&lt;/button&gt;&lt;/td&gt;</code></p>
<p><code>&lt;/tr&gt;</code></p>
<p><code>&lt;/table&gt;</code></p>
<p><code>&lt;/form&gt;</code></p>
<empty-line/>
<p>Ïðåæäå âñåãî íåîáõîäèìî óçíàòü, êàê ñîçäàòü îáúåêò <strong>JavaScript</strong>, êîòîðûé ññûëàåòñÿ íà ôîðìó. Ëþáóþ ôîðìó íà ñòðàíèöå ìîæíî óêàçàòü ñ ïîìîùüþ êîíñòðóêöèè <strong>document.forms</strong>. Åñëè èìååòñÿ ôîðìà ñ èìåíåì <strong>tutform</strong>, òî ê íåé ìîæíî îáðàòèòüñÿ ñëåäóþùèì îáðàçîì: <strong>document.forms.tutform</strong>.</p>
<p>Íà ëþáûå ýëåìåíòû âíóòðè ôîðìû (ïîëÿ ââîäà, ïîëÿ âûáîðà, ôëàæêè è ò.ä) ìîæíî ññûëàòüñÿ ñ ïîìîùüþ êîíñòðóêöèè <strong>elements</strong>: <strong>document.forms.ÈìÿÔîðìû.elements</strong>. Åñëè íà ôîðìå èìååòñÿ ïîëå ââîäà ñ èìåíåì <strong>firstname</strong>, òî çíà÷åíèå ýòîãî ïîëÿ ìîæíî âûâåñòè ñëåäóþùèì îáðàçîì:</p>
<empty-line/>
<p><code>alert('Èìÿ:' + document.forms.tutform.elements.firstname.value);</code></p>
<empty-line/>
<p>Åñëè ùåëêíóòü íà ýòîé êíîïêå, à çàòåì îòïðàâèòü ó÷åáíóþ ôîðìó, òî ïîÿâèòñÿ óâåäîìëåíèå ñ òåì çíà÷åíèåì, êîòîðîå áûëî ââåäåíî â ïîëå <strong>Èìÿ</strong>. Êàê ýòî ïðîèñõîäèò? Êîãäà ôîðìà ïîñûëàåòñÿ íà ñåðâåð, Web-áðàóçåð èùåò êîä <strong>onsubmit</strong>. Åñëè ýòîò êîä ñóùåñòâóåò, òî ôîðìà âûïîëíÿåò åãî ïåðåä îòïðàâêîé:</p>
<empty-line/>
<p><code>&lt;SCRIPT TYPE="text/javascript"&gt;</code></p>
<p><code>function validateForm(){</code></p>
<p><code>// êîä ïðîâåðêè ôîðìû íàõîäèòñÿ çäåñü</code></p>
<p><code>}</code></p>
<p><code>&lt;/SCRIPT&gt;</code></p>
<p><code>&lt;FORM ONSUBMIT="return validateForm();"&gt;</code></p>
<p><code>&lt;!-- ýëåìåíòû ôîðìû íàõîäÿòñÿ çäåñü --&gt;</code></p>
<p><code>&lt;/FORM&gt;</code></p>
<empty-line/>
<p>Òåïåðü, çíàÿ, êàê ïîëó÷èòü äîñòóï ê ôîðìå è ýëåìåíòàì íà ýòîé ôîðìå, âûïîëíèì íåêîòîðûå îñíîâíûå ïðîâåðêè. Ðàñïðîñòðàíåííîé çàäà÷åé ÿâëÿåòñÿ ïðîâåðêà, ÷òî èìåííî ïîëüçîâàòåëü ââåë â ïîëå ââîäà. Íàïðèìåð, íàäî ïðîâåðèòü, ÷òî ïîëüçîâàòåëü ââåë ñâîå èìÿ.</p>
<p>Êàê âèäíî èç ïðåäûäóùåãî ôðàãìåíòà êîäà, ñâîéñòâî "<strong>.value</strong>" îáúåêòà ôîðìû ìîæíî èñïîëüçîâàòü äëÿ ïîëó÷åíèÿ åãî çíà÷åíèÿ. Ýòî ðàáîòàåò äëÿ îáúåêòîâ ôîðìû ëþáîãî òèïà. Ïîïðîáóåì òåïåðü ïðîâåðèòü, ÷òî ïîëüçîâàòåëü ââåë íà ôîðìå ñâîè èìÿ è ôàìèëèþ:</p>
<empty-line/>
<p><code>function validateForm(){</code></p>
<p><code>var form_object = document.forms.tutform;</code></p>
<p><code>if(form_object.elements.firstname.value == ''){</code></p>
<p><code>alert('Âû äîëæíû ââåñòè ñâîå èìÿ!');</code></p>
<p><code>return false;</code></p>
<p><code>} else if(form_object.elements.lastname.value == ''){</code></p>
<p><code>alert('Âû äîëæíû ââåñòè ñâîþ ôàìèëèþ!');</code></p>
<p><code>return false;</code></p>
<p><code>}</code></p>
<p><code>return true;</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Âàæíûìè ìîìåíòàìè, êîòîðûå íåîáõîäèìî îòìåòèòü â ýòîé ôóíêöèè, ÿâëÿþòñÿ ñòðîêè <strong>return false</strong>; è <strong>return true</strong>;. Åñëè ôóíêöèÿ ïðîâåðêè âîçâðàùàåò çíà÷åíèå <strong>true</strong>, òî ôîðìà áóäåò îòïðàâëåíà êàê îáû÷íî. Åñëè, îäíàêî, ôóíêöèÿ âåðíåò çíà÷åíèå <strong>false</strong>, òî ôîðìà îòïðàâëåíà íå áóäåò. Íåîáõîäèìî ñîîáùèòü ïîëüçîâàòåëþ, ïî÷åìó ôîðìà íå áûëà îòïðàâëåíà, ïîýòîìó â ôóíêöèþ âñòàâëåíû óâåäîìëåíèÿ (<strong>alert</strong>).</p>
<p>Äðóãèì âàæíûì ïîëåì äëÿ ïðîâåðêè â äåìîíñòðàöèîííîé ôîðìå áóäåò íàáîð ðàäèî-êíîïîê "<strong>Ëþáèìûé öâåò</strong>". Åñëè ùåëêíóòü íåñêîëüêî ðàç íà ýòèõ êíîïêàõ, òî ìîæíî âèäåòü, ÷òî â äàííûé ìîìåíò âðåìåíè ìîæåò áûòü âûáðàíà òîëüêî îäíà èç íèõ. Íî æåëàòåëüíî çíàòü, ÷òî ïîëüçîâàòåëü âûáðàë õîòÿ áû îäíó èç ýòèõ êíîïîê.</p>
<p>Ðàäèî-êíîïêè è ôëàæêè íà ôîðìå ïðåäñòàâëÿþò ñïåöèàëüíóþ ñèòóàöèþ. ×àñòî èìååòñÿ íåñêîëüêî ðàäèî-êíîïîê ñ îäíèì è òåì æå èìåíåì, ÷òî ïî÷òè âñåãäà èñêëþ÷åíî äëÿ ïîëåé ââîäà, ïîëåé âûáîðà è ò.ä.:</p>
<empty-line/>
<p><code>&lt;input type="radio" name="color" value="blue"&gt;Ñèíèé</code></p>
<p><code>&lt;input type="radio" name="color" value="red"&gt;Êðàñíûé</code></p>
<p><code>&lt;input type="radio" name="color" value="green"&gt;Çåëåíûé</code></p>
<empty-line/>
<p>Â ñâÿçè ñ ýòèì ñóùåñòâóåò ñïîñîá äîñòóïà êî âñåì ðàäèî-êíîïêàì ñ îäíèì èìåíåì. Çíà÷åíèå <strong>document.forms.èìÿÔîðìû.elements.èìÿÐàäèîêíîïîê</strong> áóäåò ñîäåðæàòü ñïèñîê ñî âñåìè ðàäèî-êíîïêàìè. Òàê êàê íåîáõîäèìî ïðîâåðèòü, ÷òî õîòÿ áû îäíà ðàäèî-êíîïêà îòìå÷åíà, òî ïîòðåáóåòñÿ ïðîñìîòðåòü âñå ýòè ðàäèî-êíîïêè. Åñëè õîòÿ áû îäíà èç íèõ îòìå÷åíà, ôóíêöèÿ ïðîâåðêè äîëæíà âåðíóòü <strong>true</strong>. Ïîýòîìó ôóíêöèÿ âûãëÿäèò òåïåðü ñëåäóþùèì îáðàçîì:</p>
<empty-line/>
<p><code>function validateForm(){</code></p>
<p><code>var radios = document.forms.tutform.elements.color;</code></p>
<p><code>for(var i=0; i&lt;radios.length; i++){</code></p>
<p><code>if(radios[i].checked) return true;</code></p>
<p><code>}</code></p>
<p><code>alert('Âû äîëæíû âûáðàòü öâåò!');</code></p>
<p><code>return false;</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Íîâûì ýëåìåíòîì â ýòîì êîäå ÿâëÿåòñÿ òàê íàçûâàåìûé öèêë <strong>for</strong>. Îí âûãëÿäèò íåìíîãî áîëåå ñëîæíî, ÷åì åñòü â äåéñòâèòåëüíîñòè, ïîýòîìó ðàçáåðåì åãî ñîñòàâíûå ýëåìåíòû:</p>
<empty-line/>
<p><code>for(var i=0; i&lt;radios.length; i++){</code></p>
<empty-line/>
<p>Âíóòðè ñêîáîê èìååòñÿ òðè çíà÷åíèÿ, ðàçäåëåííûå òî÷êîé ñ çàïÿòîé. Ýòèìè çíà÷åíèÿìè, ïî îòäåëüíîñòè, ÿâëÿþòñÿ:</p>
<empty-line/>
<p><code>var i=0</code></p>
<p><code>i&lt;radios.length</code></p>
<p><code>i++</code></p>
<empty-line/>
<p>Ïåðâîå çíà÷åíèå ÿâëÿåòñÿ ïðîñòî çàäàíèåì çíà÷åíèÿ ïåðåìåííîé. Ýòî äîëæíî áûòü òåïåðü ïîíÿòíî áåç ïðîáëåì. Âòîðîå çíà÷åíèå ÿâëÿåòñÿ óñëîâèåì ïðîâåðêè. Öèêë <strong>for</strong> áóäåò âûïîëíÿòüñÿ, ïîêà ýòî óñëîâèå ïðîâåðêè âîçâðàùåò <strong>true</strong>. Êàê òîëüêî îíî âåðíåò <strong>false</strong>, öèêë <strong>for</strong> îñòàíîâèòñÿ è âûïîëíåíèå êîäà ïðîäîëæèòñÿ ñî ñëåäóþùåé ñòðîêè. Ïîýòîìó óñëîâèå <strong>i&lt;radios.length</strong> ãîâîðèò, ÷òî öèêë <strong>for</strong> äîëæåí âûïîëíÿòüñÿ, ïîêà ïåðåìåííàÿ <strong>i</strong> ìåíüøå ÷èñëà èìåþùèõñÿ ðàäèî-êíîïîê.</p>
<p>"<strong>length</strong>" â äàííîì ñëó÷àå ÿâëÿåòñÿ ñâîéñòâîì ìàññèâà. Ìû ïîêà åùå íå âñòðå÷àëèñü ñ ìàññèâàìè, íî, óïðîùàÿ, ìîæíî ñêàçàòü, ÷òî <strong>radios.length</strong> âîçâðàùàåò ïðîñòî ÷èñëî ýëåìåíòîâ â <strong>radios</strong>, êîòîðîå â äàííîì ñëó÷àå ðàâíî <strong>6</strong>, òàê êàê èìååòñÿ òîëüêî <strong>6</strong> ðàäèî-êíîïîê. Ïîñëåäíåå âûðàæåíèå öèêëà <strong>for</strong>, <strong>i++</strong> , ÿâëÿåòñÿ êîäîì, êîòîðûé äîëæåí âûïîëíÿòüñÿ ïîñëå êàæäîãî øàãà öèêëà.</p>
<p>Ãîâîðÿ áîëåå ïðîñòûì ÿçûêîì, öèêë <strong>for</strong> äåëàåò ñëåäóþùåå:</p>
<p><strong>1</strong> çàäàåò <strong>i</strong> ðàâíûì <strong>0</strong>;</p>
<p><strong>2</strong> ïðîâåðÿåò, ÷òî <strong>i</strong> ìåíüøå <strong>radios.length</strong>, êîòîðîå ðàâíî <strong>6</strong>;</p>
<p><strong>3</strong> åñëè ýòî ñïðàâåäëèâî (<strong>true</strong>), âûïîëíÿåò êîä â öèêëå <strong>for</strong>;</p>
<p><strong>4</strong> ïîñëå âûïîëíåíèÿ êîäà â öèêëå <strong>for</strong> äîáàâëÿåò <strong>1</strong> ê ïåðåìåííîé <strong>i</strong>;</p>
<p><strong>5</strong> ïåðåõîäèò ê øàãó 2, ïîêà âûïîëíÿåòñÿ óñëîâèå <strong>i&lt;radios.length</strong> . Ýòî óñëîâèå íå âûïîëíèòñÿ ïîñëå øåñòîãî âûïîëíåíèÿ öèêëà, êîãäà <strong>i=6</strong>.</p>
<p>Ñóùåñòâóåò äðóãîé òèï öèêëà, êîòîðûé ñåé÷àñ áóäåò ðàññìîòðåí, – òàê íàçûâàåìûé öèêë <strong>while</strong>. Ñëåäóþùèé êîä äåëàåò òî æå ñàìîå, ÷òî è ïðåäûäóùèé öèêë:</p>
<empty-line/>
<p><code>var i=0;</code></p>
<p><code>while(i&lt;radios.length){</code></p>
<p><code>if(radios[i].checked) return true;</code></p>
<p><code>i++;</code></p>
<p><code>}</code></p>
<p><code>alert('Âû äîëæíû âûáðàòü öâåò!');</code></p>
<p><code>return false;</code></p>
<empty-line/>
<p>Ìîæíî âèäåòü, ÷òî çäåñü â öèêëå <strong>while</strong> ïðèñóòñòâóþò òî÷íî òå æå <strong>3</strong> ôðàãìåíòà êîäà, êîòîðûå èìåëèñü â öèêëå <strong>for</strong>: "<strong>var i=0</strong>", "<strong>i&lt;radios.length</strong>" è "<strong>i++</strong>". Åäèíñòâåííîå îòëè÷èå ñîñòîèò â èõ ðàçìåùåíèè. Â öèêëå <strong>while</strong> òîëüêî ïðîâåðêà</p>
<empty-line/>
<p><code>i&lt;radios.length</code></p>
<empty-line/>
<p>÷åì-òî îòëè÷àåòñÿ îò òîãî, ÷òî áûëî íàïèñàíî ðàíüøå. Ýòà ïðîâåðêà ïðîèñõîäèò â ñêîáêàõ ñðàçó ïîñëå <strong>while</strong>. Ïåðåìåííûå èíèöèàëèçèðóþòñÿ ïåðåä öèêëîì <strong>while</strong>, à óâåëè÷åíèå <strong>i</strong>, <strong>i++</strong>, ïðîèñõîäèò âíóòðè öèêëà.</p>
<p>Â ýòèõ öèêëàõ îñòàëîñü îáúÿñíèòü åùå îäíó âåùü: <strong>if(radios[i].checked)</strong>. Ïåðåìåííàÿ <strong>radios</strong> ñîäåðæèò ìàññèâ ðàäèî-êíîïîê ñ èìåíåì <strong>color</strong>. Ìàññèâû áóäóò ðàññìîòðåíû â ñëåäóþùåé ëåêöèè, à çäåñü äàäèì óïðîùåííîå îáúÿñíåíèå: <strong>radios[0]</strong> âîçâðàùàåò ïåðâóþ ðàäèî-êíîïêó, <strong>radios[1]</strong> âîçâðàùàåò âòîðóþ, <strong>radios[2]</strong> – òðåòüþ, è ò.ä. äî <strong>radios[5]</strong>, êîòîðûé âîçâðàùàåò øåñòóþ êíîïêó. Åñëè êíîïîê áóäåò áîëüøå, íàïðèìåð, <strong>100</strong>, òî <strong>radios[99]</strong> áóäåò îáðàùàòüñÿ ê <strong>100</strong>– îé ðàäèî-êíîïêå.</p>
<p>Âñå ýòè ÷èñëà ìîãóò ïîêàçàòüñÿ ñòðàííûìè. Ïî÷åìó <strong>radios[5]</strong> îáðàùàåòñÿ ê øåñòîé ðàäèî-êíîïêå? Â <strong>JavaScript</strong>, êàê è âî ìíîãèõ äðóãèõ ÿçûêàõ ïðîãðàììèðîâàíèÿ, ìíîãèå âåùè íà÷èíàþòñÿ ñ ÷èñëà <strong>0</strong>, à íå ñ <strong>1</strong>. Ýòî ïðîñòî îäèí èç òàêèõ ñëó÷àåâ, íî ýòî âñòðåòèòñÿ åùå íå ðàç. Ïîýòîìó <strong>0</strong> ÿâëÿåòñÿ â äåéñòâèòåëüíîñòè ïåðâûì ýëåìåíòîì, <strong>1</strong> – âòîðûì, è ò.ä.</p>
<p>Â ôîðìå îñòàëîñü ïðîâåðèòü åùå ââîä àäðåñà e-mail. Ýòî â äåéñòâèòåëüíîñòè äîñòàòî÷íî ñëîæíîå äëÿ ïðîâåðêè ïîëå, è ïðàâèëüíàÿ åå ðåàëèçàöèÿ âûõîäèò çà ðàìêè òîãî, ÷òî èçó÷àåòñÿ â ýòîé ëåêöèè, íî ìîæíî âûïîëíèòü íåêîòîðóþ áàçîâóþ ïðîâåðêó. ×òî íóæíî ñäåëàòü? Ìû çíàåì, ÷òî ëþáîé àäðåñ e-mail äîëæåí ñîäåðæàòü îäèí è òîëüêî îäèí ñèìâîë <strong>@</strong>. Îí äîëæåí òàêæå ñîäåðæàòü ïî êðàéíåé ìåðå îäíó òî÷êó ïîñëå ñèìâîëà <strong>@</strong> (òî÷êà îòäåëÿåò èìÿ äîìåíà îò äîìåíà âåðõíåãî óðîâíÿ, íàïðèìåð, "<strong>intuit.ru</strong> ").</p>
<empty-line/>
<p><code>function validateForm(){</code></p>
<p><code>var email = document.forms.tutform.elements.email.value;</code></p>
<p><code>if(email.indexOf('@')&lt;0){</code></p>
<p><code>alert('Â àäðåñå e-mail äîëæåí ïðèñóòñòâîâàòü ñèìâîë @');</code></p>
<p><code>return false;</code></p>
<p><code>} else if(email.indexOf('@') != email.lastIndexOf('@')){</code></p>
<p><code>alert('Â àäðåñå e-mail íå ìîæåò áûòü áîëüøå îäíîãî ñèìâîëà @');</code></p>
<p><code>return false;</code></p>
<p><code>} else if(email.indexOf('.')&lt;0){</code></p>
<p><code>alert('Â àäðåñå e-mail äîëæíà ïðèñóòñòâîâàòü õîòÿ áû îäíà òî÷êà.');</code></p>
<p><code>return false;</code></p>
<p><code>} else if(email.lastIndexOf('.')&lt;email.indexOf('@')){</code></p>
<p><code>alert('Â àäðåñå e-mail äîëæíà ïðèñóòñòâîâàòü õîòÿ áû îäíà òî÷êà ïîñëå ñèìâîëà @');</code></p>
<p><code>return false;</code></p>
<p><code>}</code></p>
<p><code>return true;</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Çäåñü èìåþòñÿ äâå íîâûå ñõîäíûå ôóíêöèè, êîòîðûå òðåáóþò ïîÿñíåíèÿ. Ôóíêöèÿ <strong>indexOf</strong> âîçâðàùàåò ÷èñëî, îïðåäåëÿþùåå ïîçèöèþ îäíîé ñòðîêè â äðóãîé ñòðîêå. <strong>'abcdef'.indexOf('a')</strong> âåðíåò <strong>0</strong> (çäåñü <strong>0</strong> ñíîâà îçíà÷àåò ïåðâóþ ïîçèöèþ). <strong>'abcdef'.indexOf('cdef')</strong> âåðíåò <strong>2</strong>, à <strong>'abcdef'.indexOf('aaa')</strong> âåðíåò <strong>– 1</strong>. <strong>– 1</strong> îçíà÷àåò, ÷òî ñòðîêà íå íàéäåíà. Âî ìíîãèõ ñëó÷àÿõ âîçâðàùàåòñÿ <strong>– 1</strong>, êîãäà ôóíêöèÿ íå ìîæåò ïîëó÷èòü ðåçóëüòàò.</p>
<p>Àíàëîãè÷íî, ôóíêöèÿ <strong>lastIndexOf</strong> âîçâðàùàåò ïîçèöèþ ïîñëåäíåãî âõîæäåíèÿ îäíîé ñòðîêè â äðóãóþ. <strong>'abcba'.lastIndexOf('a')</strong> âåðíåò <strong>4</strong>, â òî âðåìÿ êàê <strong>'abcba'.indexOf('a')</strong> âåðíåò <strong>0</strong>.</p>
<p>Ïîýòîìó â íàøåì êîäå ïåðâûé îïåðàòîð <strong>if</strong> ïðîâåðÿåò, ÷òî â àäðåñå e-mail èìååòñÿ õîòÿ áû îäèí ñèìâîë <strong>'@'</strong>. Åñëè òàêîãî ñèìâîëà íåò, òî <strong>email.indexOf('@')</strong> âåðíåò <strong>– 1</strong> è îïåðàòîð <strong>if</strong> âåðíåò <strong>false</strong>.</p>
<p>Ñëåäóþùèé îïåðàòîð ñîåäèíÿåò <strong>indexOf</strong> è <strong>lastIndexOf</strong>. Åñëè â àäðåñå e-mail èìååòñÿ áîëåå îäíîãî ñèìâîëà <strong>@</strong>, òî äâå ýòè ôóíêöèè âåðíóò ðàçëè÷íûå çíà÷åíèÿ, êàê â ïðèâåäåííîì âûøå ïðèìåðå ñ <strong>'abcba'</strong>. Åñëè èìååòñÿ òîëüêî îäèí ñèìâîë <strong>@</strong>, òî ýòè ôóíêöèè âåðíóò îäíî è òî æå çíà÷åíèå. Ïîýòîìó ìû ïðîâåðÿåì ýòè çíà÷åíèÿ íà íåðàâåíñòâî.</p>
<p>Òðåòèé îïåðàòîð ïî ñóòè èäåíòè÷åí ïåðâîìó, òîëüêî îí ïðîâåðÿåò <strong>'.'</strong>, à íå <strong>'@'</strong>.</p>
<p>Íàêîíåö, ÷åòâåðòûé îïåðàòîð <strong>if</strong> ïðîâåðÿåò, ÷òî â àäðåñå e-mail èìååòñÿ êàê ìèíèìóì îäíà òî÷êà ïîñëå ñèìâîëà <strong>@</strong>.</p>
<p>Íåäîñòàòîê ýòîãî ìåòîäà ñîñòîèò â òîì, ÷òî ïðîñòàÿ ñòðîêà "<strong>@.</strong>" ïðîéäåò ïðîâåðêó. Äîëæíî áûòü î÷åâèäíî, ÷òî îíà íå ÿâëÿåòñÿ äîïóñòèìûì àäðåñîì e-mail. Ñóùåñòâóåò äðóãîé ìåòîä äëÿ ïðîâåðêè àäðåñà e-mail è äëÿ ïðîâåðêè ìíîæåñòâà äðóãèõ âåùåé. Ýòî äåëàåòñÿ ñ ïîìîùüþ òàê íàçûâàåìûõ "ðåãóëÿðíûõ âûðàæåíèé". Õîòÿ ðåãóëÿðíûå âûðàæåíèÿ çäåñü ðàññìàòðèâàòüñÿ íå áóäóò, íèæå ïðèâåäåí ïðèìåð ïðîâåðêè àäðåñà e-mail, êîòîðûé îñòàåòñÿ ÷èòàòåëþ äëÿ àíàëèçà â êà÷åñòâå óïðàæíåíèÿ.</p>
<empty-line/>
<p><code>function validateForm(){</code></p>
<p><code>var email = document.forms.tutform.elements.email.value;</code></p>
<p><code>if(!(/^[a-zA-Z][\w\.-]*[a-zA-Z0-9]@[a-zA-Z0-9][\w\.-]*[a-zA-Z0-9]\.</code></p>
<p><code>[a-zA-Z][a-zA-Z\.]*[a-zA-Z]$/.test(email))){</code></p>
<p><code>alert('Ïîæàëóéñòà, ââåäèòå äîïóñòèìûé àäðåñ e-mail');</code></p>
<p><code>return false;</code></p>
<p><code>}</code></p>
<p><code>return true;</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Êàê ìîæíî âèäåòü, èñïîëüçîâàíèå ðåãóëÿðíîãî âûðàæåíèÿ ïðèâîäèò ê áîëåå êîðîòêîìó (è áîëåå íàäåæíîìó) êîäó ïðîâåðêè, íî îí ÿâëÿåòñÿ è ñóùåñòâåííî áîëåå ñëîæíûì!</p>
<empty-line/>
<p>Ñ ïîìîùüþ ïðèìåðîâ ýòîé ëåêöèè òåïåðü ìîæíî ñîçäàòü îäíó ôóíêöèþ äëÿ ïðîâåðêè âñåé ôîðìû:</p>
<empty-line/>
<p><code>function tut7(){</code></p>
<p><code>var form_object = document.forms.tutform;</code></p>
<p><code>var radios = document.forms.tutform.elements.color;</code></p>
<p><code>var email = document.forms.tutform.elements.email.value;</code></p>
<p><code>if(form_object.elements.firstname.value == "){</code></p>
<p><code>alert('Âû äîëæíû ââåñòè ñâîå èìÿ!');</code></p>
<p><code>return false();</code></p>
<p><code>} else if(form_object.elements.lastname.value == "){</code></p>
<p><code>alert('Âû äîëæíû ââåñòè ñâîþ ôàìèëèþ!');</code></p>
<p><code>return false();</code></p>
<p><code>} else if(email.indexOf('@')&lt;0){</code></p>
<p><code>alert('Â àäðåñå e-mail äîëæåí áûòü ñèìâîë @');</code></p>
<p><code>return false();</code></p>
<p><code>} else if(email.indexOf('@') != email.lastIndexOf('@')){</code></p>
<p><code>alert('Â àäðåñå e-mail íå ìîæåò áûòü áîëåå îäíîãî ñèìâîëà @');</code></p>
<p><code>return false();</code></p>
<p><code>} else if(email.indexOf('.')&lt;0){</code></p>
<p><code>alert('Â àäðåñå e-mail äîëæíà áûòü êàê ìèíèìóì îäíà òî÷êà');</code></p>
<p><code>return false();</code></p>
<p><code>} else if(email.lastIndexOf('.')&lt;email.indexOf('@')){</code></p>
<p><code>alert('Â àäðåñå e-mail äîëæíà áûòü êàê ìèíèìóì îäíà òî÷êà ïîñëå ñèìâîëà @');</code></p>
<p><code>return false();</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>for(var i=0; i&lt;radios.length; i++){</code></p>
<p><code>if(radios[i].checked) return true();</code></p>
<p><code>}</code></p>
<p><code>alert('Íåîáõîäèìî âûáðàòü öâåò!');</code></p>
<empty-line/>
<p><code>return false;</code></p>
<p><code>}</code></p>
<empty-line/>
</section>
<section>
<title>
<p><emphasis>Ëåêöèÿ 4.</emphasis> Ôóíêöèè è êîíöåïöèÿ îáúåêòîâ</p>
</title>
<p><emphasis>Â ýòîé ëåêöèè áóäóò ïîëíîñòüþ ðàññìîòðåíû ôóíêöèè è ïðåäñòàâëåíà êîíöåïöèÿ îáúåêòîâ â <strong>JavaScript</strong>.</emphasis></p>
<p>Â ïðåäûäóùåé ëåêöèè ìû ðàññìîòðåëè îñíîâû ðàáîòû ñ ïîëÿìè ôîðì è íåìíîãî ïîçíàêîìèëèñü ñ ôóíêöèÿìè. Åñëè êàêèå-òî èç ýòèõ ïîíÿòèé âûçûâàþò çàòðóäíåíèÿ, òî æåëàòåëüíî åùå ðàç ïðî÷èòàòü ïîñëåäíþþ ëåêöèþ.</p>
<p>Êàê ìû óæå çíàåì, ôóíêöèè â <strong>JavaScript</strong> èñïîëüçóþòñÿ äëÿ ìíîãîêðàòíîãî âûïîëíåíèÿ îäíîé è òîé æå çàäà÷è. Äî ñèõ ïîð ôóíêöèè âñåãäà âûçûâàëèñü âðó÷íóþ ñ ïîìîùüþ ñêîáîê: <strong>myFunction()</strong>. ×òî, åñëè ïîòðåáóåòñÿ âûçâàòü ôóíêöèþ, êîãäà ïîëüçîâàòåëü âûïîëíÿåò îïðåäåëåííóþ çàäà÷ó? Â <strong>JavaScript</strong> ìîæíî ñîåäèíèòü ôóíêöèþ ïðàêòè÷åñêè ñ ëþáûì ñîáûòèåì, êîòîðîå ìîæåò ïîðîæäàòü ïîëüçîâàòåëü. Äàâàéòå ïîñìîòðèì ýòî â äåéñòâèè è íàïèøåì ôóíêöèþ, êîòîðàÿ ïîäñ÷èòûâàåò, ñêîëüêî ðàç ïîëüçîâàòåëü ùåëêíóë íà ñòðàíèöå.</p>
<empty-line/>
<p><code>&lt;script type="text/javascript"&gt;</code></p>
<p><code>var clickCount = 0;</code></p>
<p><code>function documentClick(){</code></p>
<p><code>document.getElementById('clicked').value = ++clickCount;</code></p>
<p><code>}</code></p>
<p><code>document.onclick = documentClick;</code></p>
<p><code>&lt;/script&gt;</code></p>
<p><code>Âû ùåëêíóëè íà ýòîé ñòðàíèöå &lt;input id="clicked" size="3" onfocus="this.blur();" value="0"&gt; ðàç.</code></p>
<p><code>Âû ùåëêíóëè íà ýòîé ñòðàíèöå ðàç.</code></p>
<empty-line/>
<p>Â ïðåäûäóùåé ëåêöèè îïåðàòîð <strong>++</strong> áûë ïðèìåíåí òîëüêî ïîñëå ïåðåìåííîé, êàê â ñëó÷àå <strong>clickCount++</strong>. Îäíàêî â äàííîì ïðèìåðå îïåðàòîð <strong>++</strong> èñïîëüçóåòñÿ ïåðåä ïåðåìåííîé. Â ïåðâîì ïðèìåðå <strong>clickCount++</strong>, åäèíèöà äîáàâëÿåòñÿ ê ïåðåìåííîé <strong>clickCount</strong> ïîñëå ÷òåíèÿ åå çíà÷åíèÿ. Â ñëó÷àå <strong>++clickCount</strong> åäèíèöà äîáàâëÿåòñÿ ê ïåðåìåííîé <strong>clickCount</strong> ïåðåä ÷òåíèåì åå çíà÷åíèÿ. Òàê êàê â ýòîì ïðèìåðå ïåðåìåííîé <strong>clickCount</strong> â íà÷àëå ïðèñâàèâàåòñÿ çíà÷åíèå <strong>0</strong>, òî åäèíèöó ê íåé íåîáõîäèìî äîáàâëÿòü äî çàäàíèÿ çíà÷åíèÿ ïîëÿ ââîäà, ïîýòîìó èñïîëüçîâàíà çàïèñü <strong>++clickCount</strong>.</p>
<p>Ïðåäûäóùèé ïðèìåð ìîæåò ïîêàçàòüñÿ äîñòàòî÷íî çíàêîìûì. Òàê æå, êàê è ðàíüøå, îïðåäåëÿåòñÿ ïåðåìåííàÿ è ôóíêöèÿ. Èçìåíåíèå ñîñòîèò â òîì, ÷òî âìåñòî âûçîâà ôóíêöèè <strong>documentClick()</strong> êîä ñîäåðæèò óêàçàíèå, ÷òî ôóíêöèÿ äîëæíà âûïîëíÿòüñÿ âñÿêèé ðàç, êîãäà ïîëüçîâàòåëü ùåëêàåò íà äîêóìåíòå. <strong>document.onclick</strong> ñâÿçûâàåò ôóíêöèþ ñ ñîáûòèåì äîêóìåíòà <strong>onclick</strong> ("ïðè ùåë÷êå").</p>
<p>Ñóùåñòâóåò ìíîæåñòâî ñîáûòèé ïîäîáíûõ <strong>onclick</strong>. Ìû ïîçíàêîìèìñÿ ñ íåêîòîðûìè èç íèõ, íî íàèáîëåå ðàñïðîñòðàíåííûìè ÿâëÿþòñÿ: <strong>onclick</strong>, <strong>onload</strong>, <strong>onblur</strong>, <strong>onfocus</strong>, <strong>onchange</strong>, <strong>onmouseover</strong>, <strong>onmouseout</strong> è <strong>onmousemove</strong>. Ôóíêöèþ ìîæíî ñâÿçàòü ñ ñîáûòèÿìè ëþáîãî îáúåêòà, òàêîãî, êàê èçîáðàæåíèå èëè ïîëå ââîäà, à íå òîëüêî äîêóìåíòà. Íàïðèìåð, ñîáûòèÿ <strong>onmouseover</strong> è <strong>onmouseout</strong> èñïîëüçóþòñÿ îáû÷íî ñ èçîáðàæåíèÿìè äëÿ ñîçäàíèÿ ýôôåêòà èçìåíåíèÿ.</p>
<p>Ìîæíî òàêæå çàìåòèòü, ÷òî ññûëêà íà ïîëå ââîäà äåëàåòñÿ äðóãèì îáðàçîì. Ðàíåå ãîâîðèëîñü, ÷òî äëÿ óêàçàíèÿ ïîëÿ íåîáõîäèìî èñïîëüçîâàòü <strong>document.forms.èìÿÔîðìû.elements.èìÿÏîëÿÂâîäà</strong>. Õîòÿ ýòîò ñïîñîá ïðåêðàñíî ðàáîòàåò, ýòî íå âñåãäà íåîáõîäèìî. Â äàííîì ïðèìåðå ïîëå ââîäà äåéñòâóåò ïðîñòî êàê ñ÷åò÷èê. Îíî íå íàõîäèòñÿ âíóòðè ôîðìû, è íàì ýòî è íå íóæíî. Ïîýòîìó ìû çàäàåì äëÿ ïîëÿ íåêîòîðûé <strong>ID</strong> (èäåíòèôèêàòîð): <strong>id="clicked"</strong>. <strong>ID</strong> ìîæíî èñïîëüçîâàòü äëÿ ññûëêè íà ëþáîé îáúåêò íà ñòðàíèöå. <strong>ID</strong> äîëæåí áûòü óíèêàëüíûì íà ñòðàíèöå, ïîýòîìó åñëè èìååòñÿ <strong>5</strong> ïîëåé ââîäà ñ <strong>ID</strong>, òî âñå <strong>ID</strong> äîëæíû áûòü ðàçëè÷íû, äàæå åñëè îíè òîëüêî èìåþò âèä <strong>"input1"--&gt;"input5"</strong>.</p>
<p>Ïîñêîëüêó ýòî ïîëå ââîäà èñïîëüçóåòñÿ êàê ñ÷åò÷èê, òî íåæåëàòåëüíî, ÷òîáû ïîëüçîâàòåëè ùåëêàëè íà íåì è èçìåíÿëè åãî çíà÷åíèå. Çäåñü íà ïîìîùü ïðèõîäèò äðóãîå ñâÿçûâàíèå, <strong>onfocus</strong>, êîòîðîå ñðàáàòûâàåò, êîãäà êóðñîð ïåðåìåùàåòñÿ íà îáúåêò. Ïîýòîìó ïðè ùåë÷êå íà ïîëå ââîäà èëè ïðè ïåðåìåùåíèè íà ïîëå ââîäà ñ ïîìîùüþ êëàâèøè <strong>Tab</strong> âûçûâàåòñÿ <strong>onfocus</strong>.</p>
<p>Ñîáûòèå <strong>onfocus</strong> èìååò î÷åíü êîðîòêèé êîä, íî îí òàêæå î÷åíü âàæåí. Â íåì ïîÿâëÿåòñÿ êëþ÷åâîå ñëîâî <strong>this</strong>, êîòîðîå âàæíî ïîíèìàòü â <strong>JavaScript</strong>. Êëþ÷åâîå ñëîâî <strong>this</strong> óêàçûâàåò íà òîò îáúåêò, íà êîòîðîì âûïîëíÿåòñÿ êîä. Â äàííîì ïðèìåðå <strong>this</strong> óêàçûâàåò íà ïîëå ââîäà. Âûðàæåíèå <strong>this.blur()</strong> "ðàçìûâàåò" ïîëå ââîäà, äðóãèìè ñëîâàìè, çàñòàâëÿåò åãî òåðÿòü ôîêóñ ââîäà. Òàê êàê ýòî ïðîèñõîäèò, êàê òîëüêî ïîëüçîâàòåëü àêòèâèçèðóåò ïîëå ââîäà, òî ýòî äåëàåò "íåâîçìîæíûì" èçìåíåíèå äàííûõ.</p>
<p>Åñëè óêàçàòåëü <strong>this</strong> èñïîëüçóåòñÿ â ôóíêöèè, òî îí óêàçûâàåò íà ñàìó ôóíêöèþ. Åñëè <strong>this</strong> èñïîëüçóåòñÿ â êîäå <strong>JavaScript</strong> âíå ôóíêöèè, òî îí óêàçûâàåò íà îáúåêò îêíà. Íàèáîëåå ÷àñòî <strong>this</strong> èñïîëüçóåòñÿ äëÿ èçìåíåíèÿ ñâîéñòâà òåêóùåãî îáúåêòà, êàê â ïðèìåðå âûøå, èëè äëÿ ïåðåäà÷è òåêóùåãî îáúåêòà ôóíêöèè.</p>
<p>Äàâàéòå ïîñìîòðèì íà äðóãîé ïðèìåð:</p>
<empty-line/>
<p><code>&lt;script type="text/javascript"&gt;</code></p>
<p><code>function showValue(obj){</code></p>
<p><code>alert('You Clicked On' + obj.value);</code></p>
<p><code>}</code></p>
<p><code>&lt;/script&gt;</code></p>
<empty-line/>
<p><code>&lt;input type="radio" name="fruit" onclick="showValue(this);" value="ßáëîêî" &gt; ßáëîêî</code></p>
<p><code>&lt;input type="radio" name="fruit" onclick="showValue(this);" value="Àïåëüñèí" &gt; Àïåëüñèí</code></p>
<p><code>&lt;input type="radio" name="fruit" onclick="showValue(this);" value="Ãðóøà" &gt; Ãðóøà</code></p>
<p><code>&lt;input type="radio" name="fruit" onclick="showValue(this);" value="Áàíàí"&gt; Áàíàí</code></p>
<empty-line/>
<p><code>ßáëîêî Àïåëüñèí Ãðóøà Áàíàí</code></p>
<empty-line/>
<p>Ìîæíî âèäåòü, ÷òî ñîáûòèå <strong>onclick</strong> äëÿ êàæäîé èç ýòèõ ðàäèî-êíîïîê îäèíàêîâî. Îäíàêî, åñëè ùåëêíóòü íà êàæäîé èç íèõ, òî áóäóò ïîëó÷åíû ðàçíûå ñîîáùåíèÿ. Ýòî ñâÿçàíî ñ èñïîëüçîâàíèåì <strong>this</strong>. Òàê êàê <strong>this</strong> óêàçûâàåò íà êàæäóþ îòäåëüíóþ ðàäèî-êíîïêó, òî êàæäàÿ ðàäèî-êíîïêà ïåðåäàåòñÿ â ôóíêöèþ <strong>showValue</strong> ïî îòäåëüíîñòè.</p>
<p>Âåðíåìñÿ ê ôóíêöèÿì è ðàññìîòðèì ïåðåäà÷ó ôóíêöèè àðãóìåíòîâ. Â ïðåäûäóùåì ïðèìåðå <strong>obj</strong> ÿâëÿåòñÿ àðãóìåíòîì. Ïðåäïîëàãàåòñÿ, ÷òî <strong>obj</strong> ñîäåðæèò óêàçàòåëü íà ïîëå ââîäà, íà êîòîðîì áûë ïðîèçâåäåí ùåë÷îê. Â ôóíêöèþ ìîæíî ïåðåäàâàòü ëþáîå êîëè÷åñòâî àðãóìåíòîâ. Åñëè ïîòðåáóåòñÿ <strong>10</strong> àðãóìåíòîâ, òî ôóíêöèÿ áóäåò âûãëÿäåòü ñëåäóþùèì îáðàçîì:</p>
<empty-line/>
<p><code>function myFunction(arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10){</code></p>
<p><code>// çäåñü ðàñïîëàãàåòñÿ êîä</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Âî ìíîãèõ ñëó÷àÿõ ìîæåò ïîíàäîáèòüñÿ ôóíêöèÿ, êîòîðîé òðåáóåòñÿ îïðåäåëåííîå êîëè÷åñòâî àðãóìåíòîâ, íî íå âñåãäà òðåáóþòñÿ âñå. Â <strong>JavaScript</strong> íå íóæíî ïåðåäàâàòü âñå <strong>10</strong> àðãóìåíòîâ â ôóíêöèþ, êîòîðàÿ îáúÿâëåíà ñ <strong>10</strong> àðãóìåíòàìè. Åñëè ïåðåäàòü òîëüêî ïåðâûå <strong>3</strong>, òî ôóíêöèÿ áóäåò èìåòü òîëüêî <strong>3</strong> îïðåäåëåííûõ àðãóìåíòà. Ýòî íåîáõîäèìî ó÷èòûâàòü ïðè íàïèñàíèè ôóíêöèé. Íàïðèìåð, ìîæíî íàïèñàòü ôóíêöèþ, êîòîðîé âñåãäà òðåáóþòñÿ <strong>3</strong> ïåðâûõ àðãóìåíòà, íî ñëåäóþùèå <strong>7</strong> ÿâëÿþòñÿ íåîáÿçàòåëüíûìè:</p>
<empty-line/>
<p><code>function myFunction(arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10){</code></p>
<p><code>// êîä ñ arg1</code></p>
<p><code>// êîä ñ arg2</code></p>
<p><code>// êîä ñ arg3</code></p>
<p><code>if(arg4){</code></p>
<p><code>// êîä ñ arg4</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>if(arg5 &amp;&amp; arg6 &amp;&amp; arg7){</code></p>
<p><code>// êîä ñ arg5, arg6 è arg7</code></p>
<p><code>if(arg8){</code></p>
<p><code>// êîä ñ arg8</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>if(arg9 || arg10){</code></p>
<p><code>// êîä ñ arg9 èëè arg10</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Ìîæíî âèäåòü, ÷òî â êîäå âûïîëíÿåòñÿ ïðîñòàÿ ïðîâåðêà <strong>if(arg)</strong>. Åñëè àðãóìåíò íå ïåðåäàåòñÿ â ôóíêöèþ, òî ïðè ïîïûòêå èñïîëüçîâàòü ýòîò àðãóìåíò áóäåò ïîëó÷åíî çíà÷åíèå <strong>undefined</strong>. Ïðè èñïîëüçîâàíèè <strong>undefined</strong> â êà÷åñòâå ëîãè÷åñêîãî (áóëåâîãî) çíà÷åíèÿ (<strong>true / false</strong>), êàê â îïåðàòîðàõ <strong>if</strong>, îíî âîñïðèíèìàåòñÿ êàê <strong>false</strong>.</p>
<p>Ïîýòîìó, åñëè <strong>arg4</strong> íå áûë ïåðåäàí â ïðèâåäåííîì âûøå ïðèìåðå, òî îí ÿâëÿåòñÿ <strong>undefined</strong> è òåëî îïåðàòîðà <strong>if</strong> íå âûïîëíÿåòñÿ.</p>
<p>Êàê áûòü, êîãäà òðóäíî îïðåäåëèòü, ñêîëüêî ïîòðåáóåòñÿ àðãóìåíòîâ? Ìîæíî èìåòü ôóíêöèþ, êîòîðàÿ ïîëó÷àåò îò <strong>1</strong> äî <strong>n</strong> àðãóìåíòîâ è âûïîëíÿåò ñ êàæäûì èç íèõ îäíó è òó æå çàäà÷ó. Íà ýòîò ñëó÷àé <strong>JavaScript</strong> èìååò â êàæäîé ôóíêöèè îáúåêò <strong>arguments</strong>. Îáúåêò <strong>arguments</strong> ñîäåðæèò âñå àðãóìåíòû ôóíêöèè:</p>
<empty-line/>
<p><code>function myFunction(){</code></p>
<p><code>for(var i=0; i&lt;arguments.length; i++){</code></p>
<p><code>alert(arguments[i].value);</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Ýòîò êîä ñîîáùèò çíà÷åíèå âñåõ ïåðåäàííûõ åìó îáúåêòîâ. Åñëè ïåðåäàòü <strong>100</strong> îáúåêòîâ, òî áóäåò ïîëó÷åíî <strong>100</strong> ñîîáùåíèé. Áîëåå ïîëåçíîé ôóíêöèåé áûëî áû, âîçìîæíî, ñêðûòèå/âûâîä âñåõ ïåðåäàííûõ ôóíêöèè îáúåêòîâ.</p>
<p>Îäèí èç íàèáîëåå èíòåðåñíûõ àñïåêòîâ <strong>JavaScript</strong> – èäåÿ î òîì, ÷òî ôóíêöèè ÿâëÿþòñÿ îáúåêòàìè è ìîãóò ïåðåäàâàòüñÿ êàê ïîëå ââîäà, èçîáðàæåíèå èëè ÷òî-òî åùå, ÷òî ìîæåò áûòü. Ïîñìîòðèòå, íàïðèìåð, ñëåäóþùèé êîä:</p>
<empty-line/>
<p><code>&lt;script type="text/javascript"&gt;</code></p>
<p><code>function multiply(){</code></p>
<p><code>var out=1;</code></p>
<p><code>for(var i=0; i&lt;arguments.length; i++){</code></p>
<p><code>out *= arguments[i];</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>return out;</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function add(){</code></p>
<p><code>var out=0;</code></p>
<p><code>for(var i=0; i&lt;arguments.length; i++){</code></p>
<p><code>out += arguments[i];</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>return out;</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function doAction(action){</code></p>
<p><code>alert(action(1, 2, 3, 4, 5));</code></p>
<p><code>}</code></p>
<p><code>&lt;/script&gt;</code></p>
<empty-line/>
<p><code>&lt;button onclick="doAction(multiply)"&gt;Test Multiply&lt;/button&gt;</code></p>
<p><code>&lt;button onclick="doAction(add)" &gt;Test Add&lt;/button&gt;</code></p>
<empty-line/>
<p><code>Test Multiply Test Add</code></p>
<empty-line/>
<p>Â ýòîì íåáîëüøîì ôðàãìåíòå êîäà ïðîèñõîäèò î÷åíü ìíîãîå. Âíà÷àëå ïðîñòî îïðåäåëÿþò äâå ôóíêöèè: <strong>multiply</strong> è <strong>add</strong>. Ôóíêöèÿ <strong>multiply</strong> ïðîñòî ïåðåìíîæàåò âñå ïåðåäàííûå åé ÷èñëà. Àíàëîãè÷íî, ôóíêöèÿ <strong>add</strong> ñêëàäûâàåò âñå ïåðåäàííûå åé ÷èñëà. Òîíêîñòè íà÷èíàþòñÿ ïðè èñïîëüçîâàíèè äåéñòâèé <strong>onclick</strong> äâóõ ñîçäàííûõ êíîïîê. Ìîæíî âèäåòü, ÷òî ïðè ùåë÷êå íà ëþáîé èç äâóõ êíîïîê â ôóíêöèþ <strong>doAction</strong> ïåðåäàåòñÿ îáúåêò. Ðàíåå ìû âñåãäà ïåðåäàâàëè ïåðåìåííûå èëè îáúåêòû <strong>HTML</strong> (òàêèå, êàê ïîëÿ ââîäà â ïðåäûäóùåì ïðèìåðå). Â ýòîì ïðèìåðå ïåðåäàþòñÿ ôóíêöèè. Ôóíêöèè ìîæíî ïåðåäàâàòü òàêèì æå ñïîñîáîì, êàê è ëþáîé äðóãîé îáúåêò, è êîãäà îíè ïåðåäàþòñÿ, èõ ìîæíî âûçûâàòü òàêèì æå ñïîñîáîì, êàê è ëþáóþ äðóãóþ ôóíêöèþ. Èçìåíÿåòñÿ òîëüêî åå èìÿ.</p>
<p>Òàêèì îáðàçîì ôóíêöèÿ <strong>doAction</strong> ïîëó÷àåò äðóãóþ ôóíêöèþ â êà÷åñòâå àðãóìåíòà! Åñëè ïåðåäàåòñÿ ôóíêöèÿ <strong>multiply</strong>, òî ôóíêöèÿ <strong>doAction</strong> ïåðåäàåò åé çíà÷åíèÿ îò <strong>1</strong> äî <strong>5</strong>, è ìû ïîëó÷àåì â ðåçóëüòàòå <strong>120</strong>. Åñëè â <strong>doAction</strong> ïåðåäàåòñÿ ôóíêöèÿ <strong>add</strong>, òî åé òàêæå ïåðåäàþòñÿ çíà÷åíèÿ îò <strong>1</strong> äî <strong>5</strong>, è â ðåçóëüòàòå ìû ïîëó÷àåì çíà÷åíèå <strong>15</strong>.</p>
<p>Ýòî â äåéñòâèòåëüíîñòè îäíî èç íàèáîëåå ìîùíûõ ñâîéñòâ <strong>JavaScript</strong>, è îíî áóäåò áîëåå ïîäðîáíî ðàññìîòðåíî â ñëåäóþùèõ ëåêöèÿõ. Ïîêà äîñòàòî÷íî ïîíÿòü îáùèé ïðèíöèï.</p>
<p>Äðóãèì âàæíûì ñâîéñòâîì ôóíêöèé ÿâëÿåòñÿ âîçìîæíîñòü âëîæåíèÿ èõ äðóã â äðóãà. <strong>JavaScript</strong> íå ïîääåðæèâàåò èñòèííûé îáúåêòíî-îðèåíòèðîâàííûé ïîäõîä ê ïðîåêòèðîâàíèþ, íî ýòî ñâîéñòâî îáåñïå÷èâàåò î÷åíü ïîõîæèå âîçìîæíîñòè.</p>
<p>Êðîìå âëîæåíèÿ ôóíêöèé, âàæíî îòìåòèòü, ÷òî èìååòñÿ íåñêîëüêî ðàçëè÷íûõ ñïîñîáîâ îáúÿâëåíèÿ ôóíêöèé:</p>
<empty-line/>
<p><code>function myFunction(){</code></p>
<p><code>function nestedFunction1(arg1, arg2, arg3){</code></p>
<p><code>alert(arg1+arg2+arg3);</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>var nestedFunction2 = function(arg1, arg2, arg3){</code></p>
<p><code>alert(arg1+arg2+arg3);</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>var nestedFunction3 = new Function('arg1, arg2, arg3', 'alert(arg1+arg2+arg3);');</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Â ýòîì ïðèìåðå ôóíêöèè <strong>nestedFunction1</strong>, <strong>nestedFunction2</strong> è <strong>nestedFunction3</strong> ÿâëÿþòñÿ îäèíàêîâûìè ïî ñâîèì âîçìîæíîñòÿì. Åäèíñòâåííîå ðàçëè÷èå ñîñòîèò â òîì, êàê îíè îïðåäåëÿþòñÿ. <strong>nestedFunction1</strong> îáúÿâëåíà, êàê ýòî äåëàëîñü ðàíüøå. Ñèíòàêñèñ äëÿ <strong>nestedFunction2</strong> íåìíîãî îòëè÷àåòñÿ. Ìû çàäàåì äëÿ ôóíêöèè ïåðåìåííóþ <strong>this.nestedFunction2</strong>. Ñèíòàêñèñ ýòîãî îáúÿâëåíèÿ áóäåò ñëåäóþùèé <strong>èìÿÏåðåìåííîé= function(àðãóìåíòû){</strong>. Àíàëîãè÷íî äëÿ ôóíêöèè <strong>nestedFunction3</strong> çàäàåòñÿ ïåðåìåííàÿ äëÿ íîâîé ôóíêöèè. Îäíàêî ýòî îáúÿâëåíèå ñóùåñòâåííî îòëè÷àåòñÿ, òàê êàê ìû îïðåäåëÿåì ôóíêöèþ ñ ïîìîùüþ ñòðîê. Òðåòèé âàðèàíò èñïîëüçóåòñÿ ðåäêî, íî ÿâëÿåòñÿ î÷åíü ïîëåçíûì, êîãäà èñïîëüçóåòñÿ. Îí ïîçâîëÿåò ñîçäàòü ñòðîêó, ñîäåðæàùóþ êîä âûïîëíÿåìîé ôóíêöèè, à çàòåì îïðåäåëèòü ôóíêöèþ ñ ïîìîùüþ ýòîé ñòðîêè.</p>
<p>Â ñëåäóþùåé ëåêöèè áóäóò ðàññìîòðåíû ìàññèâû.</p>
</section>
<section>
<title>
<p><emphasis>Ëåêöèÿ 5.</emphasis> Ñòðîêè, ÷èñëà è ìàññèâû</p>
</title>
<p><emphasis>Âíóòðåííÿÿ ðàáîòà ïðèñóùèõ JavaScript îáúåêòîâ: ñòðîê, ÷èñåë è ìàññèâîâ.</emphasis></p>
<p>Äî ñèõ ïîð ìû ðàññìàòðèâàëè ÿçûêîâûå êîíñòðóêöèè <strong>JavaScript</strong>: îïåðàòîðû <strong>if</strong>, öèêëû, ôóíêöèè è ò.ä. Â ýòîé ëåêöèè áóäåò ðàññìîòðåíà âíóòðåííÿÿ ðàáîòà íåêîòîðûõ ïðèñóùèõ <strong>JavaScript</strong> îáúåêòîâ: ñòðîê, ÷èñåë è ìàññèâîâ.</p>
<p>Â <strong>JavaScript</strong> ñòðîêà ÿâëÿåòñÿ ëþáûì ôðàãìåíòîì òåêñòà. Êàê è ìíîãèå äðóãèå îáúåêòû â <strong>JavaScript</strong>, ñòðîêè ìîæíî îïðåäåëÿòü íåñêîëüêèìè ðàçëè÷íûìè ñïîñîáàìè:</p>
<empty-line/>
<p><code>var myString = 'Hello, World!';</code></p>
<p><code>var myString = new String('Hello, World!');</code></p>
<empty-line/>
<p>Ïåðâûé ìåòîä èñïîëüçóåòñÿ íàèáîëåå ÷àñòî. Âòîðîé ìåòîä ïðèìåíÿåòñÿ ðåäêî è òîëüêî äëÿ ãàðàíòèè, ÷òî ïîëó÷àåìûé îáúåêò ÿâëÿåòñÿ ñòðîêîé. Íàïðèìåð:</p>
<empty-line/>
<p><code>var n = 5;</code></p>
<p><code>var s = new String(n*20);</code></p>
<empty-line/>
<p>Â ýòîì ïðèìåðå s áóäåò ñòðîêîé "<strong>100</strong>". Åñëè ïðîñòî çàäàòü <strong>s</strong> êàê <strong>n*20</strong>, òî <strong>s</strong> áóäåò ñîäåðæàòü ÷èñëî <strong>100</strong>. Îäíàêî ïîñêîëüêó <strong>JavaScript</strong> ÿâëÿåòñÿ ñëàáî òèïèçèðîâàííûì ÿçûêîì, òî ýòè ðàçëè÷èÿ íå áóäóò ñóùåñòâåííî âëèÿòü íà òî, ÷òî âû äåëàåòå.</p>
<p>Ñòðîêîâûå îáúåêòû (<strong>var n = new String('Hello World')</strong>) òåõíè÷åñêè ÿâëÿþòñÿ â <strong>Internet Explorer</strong> áîëåå ìåäëåííûìè ïðè íåêîòîðûõ îïåðàöèÿõ, ÷åì ñòðîêîâûå ëèòåðàëû (<strong>var n = 'Hello World'</strong>). Îäíàêî ýòî ïîâåäåíèå ñîâåðøåííî ïðîòèâîïîëîæíî â äðóãèõ áðàóçåðàõ. Â ëþáîì áðàóçåðå ðàçëè÷èå ðåäêî áûâàåò íàñòîëüêî çàìåòíî, ÷òîáû îá ýòîì áåñïîêîèòüñÿ.</p>
<p>Åäèíñòâåííîå âàæíîå ðàçëè÷èå ñîñòîèò â òîì, ÷òî <strong>eval()</strong> íå ðàáîòàåò ñî ñòðîêîâûìè îáúåêòàìè.</p>
<p>×òî, åñëè â ñòðîêå èìååòñÿ àïîñòðîô? Ñëåäóþùèé êîä ðàáîòàòü íå áóäåò:</p>
<empty-line/>
<p><code>var n = 'The dog took it's bone outside';</code></p>
<empty-line/>
<p>Ëåãêî âèäåòü, ÷òî àïîñòðîô â "<strong>it's</strong>" çàêàí÷èâàåò ñòðîêó. Ïîýòîìó ìû ïîëó÷àåì ñòðîêó "<strong>The dog took it</strong>", çà êîòîðîé ñëåäóåò "<strong>s bone outside'</strong>". Ýòî ïðîäîëæåíèå ñàìî ïî ñåáå íå ÿâëÿåòñÿ äîïóñòèìûì êîäîì <strong>JavaScript</strong> (èëè ïðàâèëüíûì ãðàììàòè÷åñêè, åñëè íà òî ïîøëî), ïîýòîìó áóäåò ïîëó÷åíà îøèáêà.</p>
<p>Çäåñü ìîæíî ñäåëàòü äâå âåùè. Òàê êàê ñòðîêà îïðåäåëÿåòñÿ ñ ïîìîùüþ îäèíî÷íûõ èëè äâîéíûõ êàâû÷åê, òî ìîæíî çàäàòü ñòðîêó ñ ïîìîùüþ äâîéíûõ êàâû÷åê. Äðóãàÿ âîçìîæíîñòü ñîñòîèò â ýêðàíèðîâàíèè àïîñòðîôà. ×òîáû ýêðàíèðîâàòü ñèìâîë, íåîáõîäèìî ïðîñòî ïîäñòàâèòü ïåðåä íèì ñèìâîë <strong>\</strong>. Ñèìâîë <strong>\</strong> â ýòîì êîíòåêñòå ñîîáùàåò <strong>JavaScript</strong>, ÷òî ñëåäóþùèé ñèìâîë íåîáõîäèìî âîñïðèíèìàòü â òî÷íîñòè òàê, êàê îí åñòü, â íîìèíàëüíîì çíà÷åíèè, à íå êàê ñïåöèàëüíûé ñèìâîë.</p>
<empty-line/>
<p><code>var n = "The dog took it's bone outside";</code></p>
<p><code>var n = 'The dog took it\'s bone outside';</code></p>
<empty-line/>
<p>Åñëè â ñòðîêå äîëæåí ïðèñóòñòâîâàòü ñèìâîë <strong>\</strong>, òî îí ýêðàíèðóåòñÿ òàêèì æå îáðàçîì: <strong>'\\'</strong>.</p>
<p>Â ïðåäûäóùåé ëåêöèè ìû âñòðå÷àëèñü ñ ôóíêöèÿìè <strong>indexOf</strong> è <strong>lastIndexOf</strong>. Íàïîìíèì, ÷òî îíè äåëàþò. Ôóíêöèÿ <strong>indexOf</strong> âîçâðàùàåò ÷èñëî, îïðåäåëÿþùåå ïåðâóþ ïîçèöèþ îäíîé ñòðîêè â äðóãîé. Åñëè ðàçûñêèâàåìàÿ ñòðîêà íå ñóùåñòâóåò, òî <strong>indexOf</strong> âîçâðàùàåò <strong>– 1</strong>. Ôóíêöèÿ <strong>lastIndexOf</strong> èäåíòè÷íà <strong>indexOf</strong>, íî âîçâðàùàåò íå ïåðâóþ ïîçèöèþ âõîæäåíèÿ ñòðîêè, à ïîñëåäíþþ.</p>
<p>Òîò ôàêò, ÷òî ôóíêöèè <strong>indexOf</strong> è <strong>lastIndexOf</strong> âîçâðàùàþò <strong>– 1</strong>, åñëè ñòðîêà íå ñóùåñòâóåò, ÿâëÿåòñÿ î÷åíü ïîëåçíûì è ïîçâîëÿåò èñïîëüçîâàòü ýòè ôóíêöèè äëÿ äîñòàòî÷íî ðàñïðîñòðàíåííîé çàäà÷è – ïðîâåðêè òîãî, ÷òî îäíà ñòðîêà ñóùåñòâóåò âíóòðè äðóãîé.</p>
<p>Ñóùåñòâóåò íåñêîëüêî äðóãèõ ïîëåçíûõ ôóíêöèé äëÿ ðàáîòû ñî ñòðîêàìè, êîòîðûå ìû ïåðå÷èñëèì è êðàòêî ïîÿñíèì.</p>
<p><strong>[x] charAt()</strong> ñîîáùàåò, êàêîé ñèìâîë íàõîäèòñÿ â îïðåäåëåííîé ïîçèöèè ñòðîêè. Ïîýòîìó <strong>'Test'.charAt(1) = 'e'</strong>.</p>
<p><strong>[x] length</strong> ñîîáùàåò äëèíó ñòðîêè . <strong>'Test'.length = 4</strong>.</p>
<p><strong>[x] substring()</strong> âûäàåò ñòðîêó ìåæäó äâóìÿ èíäåêñàìè. <strong>'Test'.substring(1, 2) = 'e'</strong>.</p>
<p><strong>[x] substr()</strong> àíàëîãè÷íà <strong>substring()</strong>, òîëüêî âòîðîå ÷èñëî ÿâëÿåòñÿ íå èíäåêñîì, à äëèíîé âîçâðàùàåìîé ñòðîêè. Åñëè ýòî ÷èñëî óêàçûâàåò íà ïîçèöèþ çà ïðåäåëàìè ñòðîêè, òî <strong>substr()</strong> âåðíåò ñóùåñòâóþùóþ ÷àñòü ñòðîêè. <strong>'Test'.substr(1, 2) = 'es'</strong>;</p>
<p><strong>[x] toLowerCase()</strong> è <strong>toUpperCase()</strong> äåëàþò òî, ÷òî îáîçíà÷àþò: ïðåîáðàçóþò ñòðîêó â íèæíèé èëè âåðõíèé ðåãèñòð ñèìâîëîâ ñîîòâåòñòâåííî. <strong>'Test'.toUpperCase() = 'TEST'</strong>;</p>
<p>Ïðèìåðû âñåõ ïðèâåäåííûõ âûøå ôóíêöèé:</p>
<empty-line/>
<p><code>alert('This is a Test'.indexOf('T')); // 0</code></p>
<p><code>alert('This is a Test'.lastIndexOf('T')); // 10</code></p>
<p><code>alert('This is a Test'.charAt(5)); // i</code></p>
<p><code>alert('This is a Test'.length); // 14</code></p>
<p><code>alert('This is a Test'.substring(5, 9)); // is a</code></p>
<p><code>alert('This is a Test'.substr(5, 9)); // is a Test</code></p>
<p><code>alert('This is a Test'.toUpperCase()); // THIS IS A TEST</code></p>
<p><code>alert('This is a Test'.toLowerCase()); // this is a test</code></p>
<empty-line/>
<p>Ïîñëåäíåé ñòðîêîâîé ôóíêöèåé, êîòîðàÿ áóäåò ðàññìîòðåíà, ÿâëÿåòñÿ <strong>eval()</strong>. <strong>eval()</strong> ïîëó÷àåò ñòðîêó è âûïîëíÿåò ñòðîêó, êàê åñëè áû ýòî áûë êîä <strong>JavaScript</strong>.</p>
<empty-line/>
<p><code>eval("alert('Hello, World!')");</code></p>
<empty-line/>
<p>Â ýòîì ïðèìåðå áóäåò âûâåäåíî ñîîáùåíèå <strong>"Hello, World!"</strong>, êàê åñëè áû ôóíêöèÿ <strong>alert</strong> áûëà íàïèñàíà îáû÷íûì îáðàçîì. Ýòî ìîæåò áûòü î÷åíü ïîëåçíî, òàê êàê ïîçâîëÿåò ñîçäàòü ñîäåðæàùóþ êîä ñòðîêó, à çàòåì åå âûïîëíèòü.</p>
<p>Ðàáîòà ñ ÷èñëàìè â <strong>JavaScript</strong> ïðîèñõîäèò äîñòàòî÷íî ïðîñòî. Â ëåêöèÿõ 1 è 2 áûëî ïîêàçàíî, êàê âûïîëíÿþòñÿ áàçîâûå àðèôìåòè÷åñêèå îïåðàöèè, îïåðàòîðû <strong>++</strong> , <strong>– -</strong>, à òàêæå <strong>*=</strong>, <strong>+=</strong>, <strong>/=</strong> è <strong>– =</strong>. Ìû óçíàëè, ÷òî <strong>NaN</strong> îçíà÷àåò "Íå ÷èñëî" è ÷òî äåëàåò ôóíêöèÿ <strong>isNaN()</strong>. Îñòàëîñü ðàññìîòðåòü åùå òîëüêî íåñêîëüêî âåùåé.</p>
<p>Îáúåêò <strong>Math</strong> â <strong>JavaScript</strong> ñîäåðæèò ôóíêöèè, ïîçâîëÿþùèå ñäåëàòü ïî÷òè âñå, ÷òî ìîæíî ñäåëàòü ñ ÷èñëàìè ïîìèìî îáû÷íîé àðèôìåòèêè. <strong>Math.PI</strong>, íàïðèìåð, ñîäåðæèò ïðîñòî ÷èñëî <strong>3.141592653589793</strong>. Â íåì ñîäåðæàòñÿ òðèãîíîìåòðè÷åñêèå ôóíêöèè (<strong>sin</strong>, <strong>cos</strong>, <strong>tan</strong>, è ò.ä.), ôóíêöèè äëÿ îêðóãëåíèÿ ÷èñåë (<strong>Math.floor</strong> âîçâðàùàåò ÷èñëî, îêðóãëåííîå ñ íåäîñòàòêîì, <strong>Math.ceil</strong> âîçâðàùàåò ÷èñëî, îêðóãëåííîå ñ èçáûòêîì, à <strong>Math.round</strong> îêðóãëÿåò ÷èñëî "íîðìàëüíî") è ìíîãèå äðóãèå. Ñóùåñòâóåò î÷åíü ìíîãî ôóíêöèé, îáúÿñíÿòü êîòîðûå çäåñü íå èìååò ñìûñëà. Èõ âñåãäà ìîæíî íàéòè â ïîäõîäÿùåì ñïðàâî÷íèêå. (Íàïðèìåð, <a l:href="http://www.devguru.com/technologies/javascript/10734.asp">http://www.devguru.com/technologies/javascript/10734.asp</a>)</p>
<p>Äâóìÿ íàèáîëåå ðàñïðîñòðàíåííûìè çàäà÷àìè, ñâÿçàííûìè ñ ÷èñëàìè, ÿâëÿþòñÿ ïðåîáðàçîâàíèå ÷èñëà â ñòðîêó è ñòðîêè â ÷èñëî. Êàê óæå ãîâîðèëîñü, <strong>JavaScript</strong> ÿâëÿåòñÿ ñëàáî òèïèçèðîâàííûì ÿçûêîì, à ýòî îçíà÷àåò, ÷òî òèïû äàííûõ íå èìåþò áîëüøîãî çíà÷åíèÿ, íî ñóùåñòâóþò íåêîòîðûå ñëó÷àè, êîãäà íàäî áûòü óâåðåííûì, ÷òî èìååòñÿ ÷èñëî èëè ñòðîêà. Åñëè íàäî ñëîæèòü, íàïðèìåð, <strong>5</strong> è ÷èñëî, êîòîðîå ââîäèò ïîëüçîâàòåëü, òî íàäî áûòü óâåðåííûì, ÷òî ââåäåíî ÷èñëî, à íå ñëîâî "<strong>Ïðèâåò</strong>".</p>
<empty-line/>
<p><code>var n = parseInt("3.14"); // 3</code></p>
<p><code>var n = parseFloat("3.14") // 3.14</code></p>
<empty-line/>
<p>Ôóíêöèÿ <strong>parseInt</strong> âîçâðàùàåò öåëîå çíà÷åíèå ñâîåãî àðãóìåíòà. Àðãóìåíòû "<strong>3.14</strong>", "<strong>3</strong>", "<strong>3.00001</strong>" è "<strong>3.9999</strong>" ïðåâðàòÿòñÿ â çíà÷åíèå <strong>3</strong>. Ôóíêöèÿ <strong>parseFloat</strong>, ñ äðóãîé ñòîðîíû, âîçâðàùàåò òàêæå ëþáîå äåñÿòè÷íîå çíà÷åíèå. Îáå ýòè ôóíêöèè ïûòàþòñÿ "î÷èñòèòü" äàííûå ïåðåä âîçâðàùåíèåì ÷èñëà. Íàïðèìåð, <strong>parseInt</strong>("3a") âåðíåò çíà÷åíèå <strong>3</strong>.</p>
<p>Ñóùåñòâóåò òàêæå íåñêîëüêî ìåòîäîâ, êîòîðûå ìîæíî èñïîëüçîâàòü, êîãäà íàäî ïðåîáðàçîâàòü ÷èñëî â ñòðîêó:</p>
<empty-line/>
<p><code>var n = 5;</code></p>
<empty-line/>
<p><code>var m = n.toString();</code></p>
<p><code>var m = n+'';</code></p>
<p><code>var m = new String(n);</code></p>
<empty-line/>
<p>Êàê ãîâîðèëîñü ðàíåå, ïîñëåäíèé ìåòîä ìîæåò áûòü íåìíîãî íåïðèâû÷íûì, ïîýòîìó ïðåäïîëàãàåòñÿ, ÷òî ïîëüçîâàòåëü áóäåò äåðæàòüñÿ îò íåãî â ñòîðîíå, åñëè òîëüêî íå ïîíàäîáèòñÿ èñïîëüçîâàòü îáúåêò <strong>String</strong> äëÿ ñïåöèàëüíûõ öåëåé. Ïðåäïî÷òèòåëüíûì ìåòîäîì ÿâëÿåòñÿ <strong>n.toString()</strong>, íî íåîáõîäèìî îòìåòèòü, ÷òî ÷àñòî èñïîëüçóåòñÿ âòîðîé ìåòîä. Íàïðèìåð, åñëè èìååòñÿ óâåäîìëåíèå <strong>alert('Èìååòñÿ' + apples + 'ÿáëîê')</strong>, òî ÷èñëî <strong>apples</strong> àâòîìàòè÷åñêè ïðåîáðàçóåòñÿ â ñòðîêó.</p>
<p>Åñëè íåîáõîäèìî âûïîëíèòü ñòðîêîâóþ îïåðàöèþ ñ ïåðåìåííîé, òî íåîáõîäèìî áûòü óâåðåííûì, ÷òî èìååòñÿ ñòðîêà. Åñëè, íàïðèìåð, èìååòñÿ çàïèñü ãîäà èç 4 öèôð è åå íàäî ïðåîáðàçîâàòü â 2 öèôðû:</p>
<empty-line/>
<p><code>var year = 2000;</code></p>
<empty-line/>
<p><code>var sYear = year.toString();</code></p>
<p><code>var year2 = sYear.substr(sYear.length-2);</code></p>
<empty-line/>
<p>Ìîæíî áûëî áû òàêæå ëåãêî âû÷åñòü <strong>2000</strong> èç ýòîé äàòû, íî ÷òî, åñëè äàòîé ÿâëÿåòñÿ <strong>1995</strong>? èëè <strong>1800</strong>? èëè <strong>2700</strong> èëè ïðîñòî <strong>5</strong>? Â ðåçóëüòàòå ìîãëè áû ïîëó÷èòüñÿ ñîâåðøåííî íåïðàâèëüíûå äàòû, åñëè âû÷åñòü <strong>2000</strong> èç êàæäîé òàêîé äàòû. Èñïîëüçóåìûé ìåòîä âñåãäà äàñò ïðàâèëüíûå äâå öèôðû ãîäà.</p>
<p>Ìàññèâ ÿâëÿåòñÿ ïî ñóòè ñïèñêîì ýëåìåíòîâ. Êàæäûé ýëåìåíò ìàññèâà ìîæåò áûòü ÷åì óãîäíî, íî îáû÷íî îíè ñâÿçàíû äðóã ñ äðóãîì. Åñëè, íàïðèìåð, íåîáõîäèìî îòñëåäèòü <strong>30</strong> ñòóäåíòîâ êëàññà, òî ìîæíî ñîçäàòü ìàññèâ ñòóäåíòîâ:</p>
<empty-line/>
<p><code>var students = new Array();</code></p>
<p><code>students[0] = 'Sam';</code></p>
<p><code>students[1] = 'Joe';</code></p>
<p><code>students[2] = 'Sue';</code></p>
<p><code>students[3] = 'Beth';</code></p>
<empty-line/>
<p>Êàê ìîæíî âèäåòü, îïðåäåëèòü ìàññèâ î÷åíü ïðîñòî, òàê æå, êàê è ïðèñâîèòü çíà÷åíèÿ åãî ýëåìåíòàì. Îäíàêî ïðèìåð âûøå èìååò ñëèøêîì ìíîãî êîäà äëÿ îòíîñèòåëüíî íåáîëüøîãî ðåçóëüòàòà. Íåò íè÷åãî óäèâèòåëüíîãî â òîì, ÷òî ñóùåñòâóåò íåñêîëüêî ìåòîäîâ äëÿ ñîçäàíèÿ ìàññèâà. Çíà÷èòåëüíî áîëåå êîìïàêòíûì áóäåò ñëåäóþùèé ïðèìåð:</p>
<empty-line/>
<p><code>var students = ['Sam', 'Joe', 'Sue', 'Beth'];</code></p>
<empty-line/>
<p>Ýòî êîä ñîçäàåò òî÷íî òàêîé æå ìàññèâ, ÷òî è ïðåäûäóùèé ïðèìåð, íî, êàê ìîæíî âèäåòü, îí çíà÷èòåëüíî áîëåå êîìïàêòíûé è íè÷óòü íå ñëîæíåå äëÿ ïîíèìàíèÿ. Ñêîáêè (<strong>[</strong> è <strong>]</strong>) â ýòîì ïðèìåðå ñîîáùàþò êîäó, ÷òî áóäåò ñîçäàí ìàññèâ. Ïðîñòàÿ çàïèñü <strong>var students = [];</strong> ÿâëÿåòñÿ òåì æå ñàìûì, ÷òî è çàïèñü <strong>var students = new Array();</strong>. Ïðàâäà, íåêîòîðûå ëþäè ñ÷èòàþò, ÷òî èñïîëüçîâàíèå ñëîâà <strong>Array</strong> áîëåå íàãëÿäíî, ÷åì çàïèñü <strong>[]</strong>, ïîýòîìó ìîæíî èñïîëüçîâàòü ëþáîé ìåòîä çàïèñè.</p>
<p>×òî ìîæíî òåïåðü ñäåëàòü ñ ýòèì ìàññèâîì ñòóäåíòîâ? ×òîáû îáðàòèòüñÿ ê ëþáîìó ýëåìåíòó ìàññèâà, íåîáõîäèìî çíàòü åãî èíäåêñ. Â ïåðâîì ïðèìåðå ìîæíî âèäåòü, ÷òî â ñêîáêàõ íàõîäÿòñÿ ÷èñëà <strong>(0-3)</strong>. Ýòî èíäåêñû. Åñëè òðåáóåòñÿ óçíàòü èìÿ òðåòüåãî ñòóäåíòà, òî íàäî áóäåò íàïèñàòü <strong>alert(students[2]);</strong>. Ïî÷åìó <strong>2</strong>, à íå <strong>3</strong>? Ìàññèâû â <strong>JavaScript</strong> íà÷èíàþò èíäåêñàöèþ ñ <strong>0</strong>, à íå ñ <strong>1</strong>. Ïîýòîìó ïåðâûì ýëåìåíòîì â íàøåì ìàññèâå áóäåò <strong>students[0]</strong>, âòîðûì – <strong>students[1]</strong>, ñîòûì – <strong>students[99]</strong>, è ò.ä. Äëÿ ýòîãî íå ñóùåñòâóåò íèêàêîé ðåàëüíîé ïðè÷èíû, ïðîñòî òàê óñòðîåí <strong>JavaScript</strong> è ìíîãèå äðóãèå ÿçûêè ïðîãðàììèðîâàíèÿ. Íåêîòîðûå äðóãèå ÿçûêè èñïîëüçóþò â êà÷åñòâå ïåðâîãî èíäåêñà <strong>1</strong>.</p>
<p>Íàèáîëåå ðàñïðîñòðàíåííîé çàäà÷åé ïðè ðàáîòå ñ ìàññèâàìè, ïîìèìî èçìåíåíèÿ åãî äàííûõ, ÿâëÿåòñÿ ïðîâåðêà åãî äëèíû, îáû÷íî äëÿ òîãî, ÷òîáû ìîæíî áûëî ïåðåáðàòü âåñü ìàññèâ è âûïîëíèòü íåêîòîðóþ çàäà÷ó ñ êàæäûì ýëåìåíòîì.</p>
<empty-line/>
<p><code>var students = ['Sam', 'Joe', 'Sue', 'Beth'];</code></p>
<p><code>var suffixes = ['1st', '2nd', '3rd', '4th'];</code></p>
<empty-line/>
<p><code>for(var i=0; i&lt;students.length; i++){</code></p>
<p><code>alert(suffixes[i]+' ñòóäåíò -- '+students[i]);</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Âàæíûé ìîìåíò, êîòîðûé íåîáõîäèìî çíàòü î ìàññèâàõ, ñîñòîèò â òîì, ÷òî êàæäûé ýëåìåíò ìàññèâà ìîæåò ñîäåðæàòü ëþáîé ïðîèçâîëüíûé îáúåêò. Â ýòèõ ïðèìåðàõ êàæäûé ýëåìåíò ìàññèâà ÿâëÿåòñÿ ñòðîêîé, íî îíè ìîãóò áûòü òàêæå ÷èñëàìè, îáúåêòàìè, ôóíêöèÿìè, äàæå äðóãèìè ìàññèâàìè. Ýëåêòðîííàÿ òàáëèöà (òàêàÿ, êàê <strong>Excel</strong>) ÿâëÿåòñÿ õîðîøèì ïðèìåðîì ìàññèâà, ñîäåðæàùåãî äðóãèå ìàññèâû. Ïðåæäå âñåãî èìååòñÿ ìàññèâ ñòîëáöîâ. Êàæäûé ñòîëáåö áóäåò â ñâîþ î÷åðåäü ñîäåðæàòü â ñåáå ìàññèâ ñòðîê. Ýòîò ìàññèâ ñîçäàåòñÿ òî÷íî òàêèì æå îáðàçîì, êàê è ìàññèâ <strong>students</strong>:</p>
<empty-line/>
<p><code>var spreadsheet = [</code></p>
<p><code>['A1', 'B1', 'C1', 'D1'],</code></p>
<p><code>['A2', 'B2', 'C2', 'D2'],</code></p>
<p><code>['A3', 'B3', 'C3', 'D3'],</code></p>
<p><code>['A4', 'B4', 'C4', 'D4']</code></p>
<p><code>];</code></p>
<empty-line/>
<p>Ïåðåíîñû ñòðîê â <strong>JavaScript</strong> îáû÷íî íå èìåþò çíà÷åíèÿ. Â ýòîì ïðèìåðå ïåðåíîñû ñòðîê èñïîëüçóþòñÿ äëÿ ïðèäàíèÿ êîäó áîëüøåé íàãëÿäíîñòè è íå âëèÿþò íà êîä íèêàêèì îáðàçîì.</p>
<p>Ìîæíî âèäåòü, ÷òî çäåñü èìååòñÿ <strong>5</strong> ìàññèâîâ. ×åòûðå âíóòðåííèõ ìàññèâà (èëè âëîæåííûõ ìàññèâà) ñîäåðæàòñÿ â îäíîì áîëüøîì ìàññèâå, <strong>spreadsheet</strong>. Åñëè ïîòðåáóåòñÿ óçíàòü çíà÷åíèå íà ïåðåñå÷åíèè âòîðîãî ñòîëáöà è òðåòüåé ñòðîêè, òî ìîæíî íàïèñàòü:</p>
<empty-line/>
<p><code>var col2 = spreadsheet[1];</code></p>
<p><code>alert(col2[2]);</code></p>
<empty-line/>
<p><code>// èëè</code></p>
<empty-line/>
<p><code>alert(spreadsheet[1][2]);</code></p>
<empty-line/>
<p>Îáà ôðàãìåíòà êîäà äåëàþò îäíî è òî æå, âûâîäÿò çíà÷åíèå "<strong>C2</strong>".</p>
<p>Ñóùåñòâóåò íåñêîëüêî ðàñïðîñòðàíåííûõ îïåðàöèé, êîòîðûå âûïîëíÿþòñÿ ñ ìàññèâàìè. Ïåðâîé ÿâëÿåòñÿ äîáàâëåíèå ýëåìåíòà â êîíåö ìàññèâà. Âåðíåìñÿ ê ìàññèâó <strong>students</strong>, êîòîðûé ñîäåðæèò â äàííûé ìîìåíò <strong>4</strong> ýëåìåíòà. ×òîáû äîáàâèòü íîâûé ýëåìåíò, íàäî ïðîñòî çàäàòü çíà÷åíèå äëÿ 5-ãî ýëåìåíòà:</p>
<empty-line/>
<p><code>var students = ['Sam', 'Joe', 'Sue', 'Beth'];</code></p>
<empty-line/>
<p><code>students[4] = 'Mike';</code></p>
<p><code>students[students.length] = 'Sarah';</code></p>
<p><code>students.push('Steve');</code></p>
<empty-line/>
<p><code>// òåïåðü ìàññèâ ñîäåðæèò 7 ýëåìåíòîâ: ['Sam', 'Joe', 'Sue', 'Beth', 'Mike', 'Sarah', 'Steve']</code></p>
<empty-line/>
<p>Çäåñü òàêæå ñóùåñòâóåò íåñêîëüêî ñïîñîáîâ äëÿ âûïîëíåíèÿ ýòîé çàäà÷è. Ïåðâûé ìåòîä, <strong>students[4]</strong>, èñïîëüçóåòñÿ ðåäêî, òàê êàê îáû÷íî íåèçâåñòíî çàðàíåå â òî÷íîñòè, ñêîëüêî áóäåò ýëåìåíòîâ. Ïîýòîìó ïðèìåíÿåòñÿ îäèí èç äâóõ îñòàâøèõñÿ ìåòîäîâ. <strong>push</strong> ÿâëÿåòñÿ ôóíêöèåé, êîòîðàÿ ïðîñòî äîáàâëÿåò òî, ÷òî ïîëó÷àåò, â êîíåö ìàññèâà, êàê è ïðåäûäóùèé ìåòîä, èñïîëüçóþùèé ñâîéñòâî <strong>.length</strong>.</p>
<p>Íå òàê ÷àñòî, íî èíîãäà íåîáõîäèìî òàêæå óäàëèòü îáúåêò èç ìàññèâà. Â ýòîì ñëó÷àå çàäåéñòâóåòñÿ ôóíêöèÿ <strong>splice</strong>, êîòîðàÿ ïîçâîëÿåò äîáàâèòü èëè óäàëèòü ëþáîå êîëè÷åñòâî ýëåìåíòîâ ìàññèâà, íî â äàííûé ìîìåíò ìû ñîáèðàåìñÿ èñïîëüçîâàòü åå äëÿ óäàëåíèÿ îäíîãî ñòóäåíòà, <strong>Mike</strong>, êîòîðûé ïåðååõàë â äðóãîé ãîðîä:</p>
<empty-line/>
<p><code>var students = ['Sam', 'Joe', 'Sue', 'Beth', 'Mike', 'Sarah', 'Steve'];</code></p>
<p><code>students.splice(4, 1);</code></p>
<empty-line/>
<p><strong>Splice</strong> â ýòîì ïðèìåðå ïîëó÷àåò äâà àðãóìåíòà: íà÷àëüíûé èíäåêñ è ÷èñëî ýëåìåíòîâ äëÿ óäàëåíèÿ. Òàê êàê <strong>Mike</strong> ÿâëÿåòñÿ ïÿòûì ñòóäåíòîì, òî åãî èíäåêñ áóäåò <strong>4</strong>. Áóäåò óäàëåí òîëüêî <strong>1</strong> ñòóäåíò, ïîýòîìó çäåñü èñïîëüçóåòñÿ <strong>1</strong>. Â ðåçóëüòàòå èìååì ìàññèâ ñ óäàëåííûì <strong>Mike</strong>:</p>
<empty-line/>
<p><code>['Sam', 'Joe', 'Sue', 'Beth', 'Sarah', 'Steve'];</code></p>
<empty-line/>
<p>×àùå âñåãî òî÷íî íåèçâåñòíî, ãäå â ìàññèâå íàõîäèòñÿ ýëåìåíò. Ê ñîæàëåíèþ, åäèíñòâåííûì ñïîñîáîì âûÿñíèòü ýòî ÿâëÿåòñÿ ïåðåáîð âñåõ ýëåìåíòîâ ìàññèâà. Ìîæíî íàïèñàòü íåáîëüøîé ïðîñòîé ñöåíàðèé, êîòîðûé ïîçâîëèò ëåãêî äîáàâëÿòü èëè óäàëÿòü ñòóäåíòîâ:</p>
<empty-line/>
<p><code>var students = ['Sam', 'Joe', 'Sue', 'Beth'];</code></p>
<empty-line/>
<p><code>function addStudent(name){</code></p>
<p><code>students.push(name);</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function removeStudent(name){</code></p>
<p><code>for(var i=0; i&lt;students.length; i++){</code></p>
<p><code>if(students[i].toLowerCase() == toLowerCase(name)){</code></p>
<p><code>students.splice(i, 1);</code></p>
<p><code>break;</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>Èìÿ ñòóäåíòà:</code></p>
<empty-line/>
<p><code>Äîáàâèòü ýòîãî ñòóäåíòà</code></p>
<p><code>Óäàëèòü ýòîãî ñòóäåíòà</code></p>
<empty-line/>
<p><code>Ñòóäåíòû:</code></p>
<empty-line/>
<p>Åäèíñòâåííûì íîâûì ìîìåíòîì çäåñü ÿâëÿåòñÿ ñëîâî <strong>break</strong>. <strong>break</strong> îñòàíàâëèâàåò âûïîëíåíèå êîäà ëþáîãî öèêëà, â êîòîðîì íàõîäèòñÿ: öèêëà <strong>for</strong>, öèêëà <strong>do</strong> èëè <strong>switch</strong>. Ïîýòîìó â äàííîì ñëó÷àå, êîãäà óäàëÿåìûé ñòóäåíò íàéäåí, ìû ïðåðûâàåì öèêë <strong>for</strong>, òàê êàê âûïîëíèëè ñâîþ çàäà÷ó.</p>
<p>×àñòî áûâàåò íåîáõîäèìî ïðåîáðàçîâàòü ìàññèâ â ñòðîêó èëè ñòðîêó â ìàññèâ. Èìååòñÿ äâå ôóíêöèè, êîòîðûå ìîãóò ëåãêî ýòî ñäåëàòü: <strong>join</strong> è <strong>split</strong>. Ôóíêöèÿ <strong>join</strong> ïîëó÷àåò ìàññèâ è ïðåîáðàçóåò åãî â ñòðîêó ñ ïîìîùüþ ðàçäåëèòåëÿ, çàäàííîãî â <strong>join</strong>. Ôóíêöèÿ <strong>split</strong> äåéñòâóåò â îáðàòíîì íàïðàâëåíèè è äåëàåò ìàññèâ èç ñòðîêè, îïðåäåëÿÿ íîâûé ýëåìåíò c ïîìîùüþ ðàçäåëèòåëÿ, çàäàííîãî â <strong>split</strong>:</p>
<empty-line/>
<p><code>var myString = 'apples are good for your health';</code></p>
<p><code>var myArray = myString.split('a');</code></p>
<p><code>// ñòðîêà myString ðàçáèâàåòñÿ íà ýëåìåíòû íà êàæäîì íàéäåííîì ñèìâîëå 'a'.</code></p>
<p><code>alert(myArray.join(', '));</code></p>
<p><code>// ïðåîáðàçóåì myArray ñíîâà â ñòðîêó ñ ïîìîùüþ çàïÿòîé,</code></p>
<p><code>// òàê ÷òî ìîæíî âèäåòü êàæäûé ýëåìåíò</code></p>
<p><code>alert(myArray.join('a'));</code></p>
<p><code>// òåïåðü ïðåîáðàçóåì myArray ñíîâà â ñòðîêó ñ ïîìîùüþ ñèìâîëà 'a',</code></p>
<p><code>// òàê ÷òî ñíîâà ïîëó÷àåòñÿ èñõîäíàÿ ñòðîêà</code></p>
<empty-line/>
<p>Åùå äâå ïîëåçíûå ôóíêöèè äëÿ ðàáîòû ñ ìàññèâàìè – <strong>pop</strong> è <strong>shift</strong>. Ôóíêöèÿ <strong>pop</strong> óäàëÿåò ïîñëåäíèé ýëåìåíò èç ìàññèâà è âîçâðàùàåò åãî. Ôóíêöèÿ <strong>shift</strong> óäàëÿåò ïåðâûé ýëåìåíò èç ìàññèâà è âîçâðàùàåò åãî.</p>
<empty-line/>
<p><code>var students = ['Sam', 'Joe', 'Sue', 'Beth'];</code></p>
<empty-line/>
<p><code>while(students.length&gt;0){</code></p>
<p><code>alert(students.pop());</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Ê ñîæàëåíèþ, ïðè ýòîì ìàññèâ áûë óíè÷òîæåí: îí òåïåðü ïóñò. Èíîãäà èìåííî ýòî è íàäî ñäåëàòü. Åñëè òðåáóåòñÿ ïðîñòî î÷èñòèòü ìàññèâ, òî ïðîùå âñåãî çàäàòü åãî äëèíó (<strong>length</strong>) ðàâíîé <strong>0</strong>:</p>
<empty-line/>
<p><code>students.length = 0</code></p>
<empty-line/>
<p>Òåïåðü ìàññèâ ïóñò. Äàæå åñëè ñíîâà çàäàòü äëèíó ìàññèâà áîëüøå <strong>0</strong>, âñå äàííûå â ìàññèâå óæå áóäóò óíè÷òîæåíû.</p>
<p>Âñå èñïîëüçîâàííûå äî ñèõ ïîð ìàññèâû íàçûâàþòñÿ "èíäåêñíûìè ìàññèâàìè", òàê êàê êàæäûé ýëåìåíò ìàññèâà èìååò èíäåêñ, êîòîðûé íåîáõîäèìî èñïîëüçîâàòü äëÿ äîñòóïà ê ýëåìåíòó. Ñóùåñòâóþò òàêæå "àññîöèàòèâíûå ìàññèâû", â êîòîðûõ êàæäûé ýëåìåíò ìàññèâà àññîöèèðîâàí ñ èìåíåì â ïðîòèâîïîëîæíîñòü èíäåêñó:</p>
<empty-line/>
<p><code>var grades = [];</code></p>
<p><code>grades['Sam'] = 90;</code></p>
<p><code>grades['Joe'] = 85;</code></p>
<p><code>grades['Sue'] = 94;</code></p>
<p><code>grades['Beth'] = 82;</code></p>
<empty-line/>
<p>Àññîöèàòèâíûå ìàññèâû äåéñòâóþò íåìíîãî èíà÷å, ÷åì èíäåêñíûå. Ïðåæäå âñåãî, äëèíà ìàññèâà â ýòîì ïðèìåðå áóäåò ðàâíà <strong>0</strong>. Êàê æå óçíàòü, êàêèå ýëåìåíòû íàõîäÿòñÿ â ìàññèâå? Åäèíñòâåííûé ñïîñîá ñäåëàòü ýòî – èñïîëüçîâàòü öèêë "<strong>for-in</strong> ":</p>
<empty-line/>
<p><code>for(student in grades){</code></p>
<p><code>alert("Îöåíêà" + student + "áóäåò:" + grades[student]);</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Ñèíòàêñèñ öèêëà <strong>for-in</strong> ñëåäóþùèé: "<strong>for(item in object){</strong>". Öèêë ïðîéäåò ÷åðåç âñå ýëåìåíòû â îáúåêòå, è ýëåìåíò áóäåò èìåíåì ýëåìåíòà. Â äàííîì ñëó÷àå ýëåìåíòîì ÿâëÿåòñÿ "<strong>Sam</strong>", çàòåì "<strong>Joe</strong>", "<strong>Sue</strong>" è "<strong>Beth</strong>".</p>
<p>Ïîñëåäíåå çàìå÷àíèå î ìàññèâàõ ñîñòîèò â òîì, ÷òî â äåéñòâèòåëüíîñòè ìîæíî îáúåäèíÿòü àññîöèàòèâíûå è èíäåêñíûå ìàññèâû, õîòÿ ýòî îáû÷íî íå ðåêîìåíäóåòñÿ, òàê êàê ìîæåò âûçûâàòü íåêîòîðûå ïðîáëåìû. Ïðè ïðàâèëüíîì èñïîëüçîâàíèè, îäíàêî, ìîæíî ñ óñïåõîì ýòî ïðèìåíÿòü.</p>
<empty-line/>
<p><code>var students = ['Sam', 'Joe', 'Sue', 'Beth'];</code></p>
<empty-line/>
<p><code>students['Sam'] = 90;</code></p>
<p><code>students['Joe'] = 85;</code></p>
<p><code>students['Sue'] = 94;</code></p>
<p><code>students['Beth'] = 82;</code></p>
<empty-line/>
<p><code>alert('Âñåãî èìååòñÿ '+(students.length)+' ñòóäåíòîâ: '+students.join(', '));</code></p>
<p><code>for(var i=0; i&lt;students.length; i++){</code></p>
<p><code>alert("Îöåíêà" +students[i]+"áóäåò: "+students[students[i]]);</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Õîòÿ ýòî ìîæåò ïîêàçàòüñÿ íåìíîãî ñëîæíûì, çäåñü íåò íè÷åãî òàêîãî, î ÷åì íå ãîâîðèëîñü â ýòîé ëåêöèè.</p>
<p>Òåïåðü ÷èòàòåëü äîëæåí äîñòàòî÷íî õîðîøî ïîíèìàòü îñíîâíûå òèïû äàííûõ <strong>JavaScript</strong>: ñòðîêè, ÷èñëà è ìàññèâû. Â ñëåäóþùåé ëåêöèè áóäåò ðàññìîòðåíà Îáúåêòíàÿ ìîäåëü äîêóìåíòà, èëè <strong>DOM</strong> (Document Object Model).</p>
</section>
<section>
<title>
<p><emphasis>Ëåêöèÿ 6.</emphasis> Îáúåêòíàÿ ìîäåëü äîêóìåíòà</p>
</title>
<p><emphasis>Îáúåêòíàÿ ìîäåëü äîêóìåíòà èëè êîðîòêî DOM (Document Object Model). Ôóíêöèè document.forms, document.getElementById, document.createElement è íåêîòîðûå äðóãèå, êîòîðûå âñòðîåíû â îáúåêò document.</emphasis></p>
<p>Ýòà ëåêöèÿ ïîñâÿùåíà Îáúåêòíîé ìîäåëè äîêóìåíòà, èëè êîðîòêî <strong>DOM</strong> (Document Object Model). <strong>DOM</strong> ÿâëÿåòñÿ ïðîñòî ñïåöèàëüíûì òåðìèíîì äëÿ "âñåãî íà Web-ñòðàíèöå". Îáúåêòíàÿ ìîäåëü âêëþ÷àåò êàæäóþ òàáëèöó, èçîáðàæåíèå, ññûëêó, ïîëå ôîðìû è ò.ä. íà Web-ñòðàíèöå. <strong>JavaScript</strong> ïîçâîëÿåò ìàíèïóëèðîâàòü ñ ëþáûì ýëåìåíòîì íà ñòðàíèöå â ðåàëüíîì âðåìåíè. Ìîæíî ñêðûâàòü èëè ïîëíîñòüþ óäàëÿòü ëþáîé ýëåìåíò, äîáàâëÿòü ýëåìåíòû, êîïèðîâàòü èõ, èçìåíÿòü òàêèå ñâîéñòâà, êàê öâåò, øèðèíà, âûñîòà, è ò.ä., à ïðè íåêîòîðîì âîîáðàæåíèè ìîæíî äàæå ðåàëèçîâàòü ôóíêöèè ïåðåòàñêèâàíèÿ, àíèìàöèè è ïî÷òè âñå îñòàëüíîå, ÷òî ìîæíî ïðèäóìàòü.</p>
<p>Ïðåæäå âñåãî, íåîáõîäèìî ïîíÿòü, ÷òî ñ òî÷êè çðåíèÿ áðàóçåðà ñòðàíèöà <strong>HTML</strong> ÿâëÿåòñÿ òî÷íî òåì æå, ÷òî è äîêóìåíò <strong>XML</strong>. Åñëè ÷èòàòåëü èìååò îïûò ðàáîòû ñ <strong>XML</strong>, òî ñìîæåò ïîíÿòü îáðàáîòêó <strong>DOM</strong> äîñòàòî÷íî ëåãêî. Íî â ëþáîì ñëó÷àå ýòî â äåéñòâèòåëüíîñòè íå ñëîæíî. Ñóùåñòâóåò ïðåêðàñíûé ñïðàâî÷íèê ïî àäðåñó (<a l:href="http://www.devguru.com/technologies/xml_dom/index.asp">http://www.devguru.com/technologies/xml_dom/index.asp</a>), êîòîðûé ïîäðîáíî îïèñûâàåò êàæäûé ìåòîä îáðàáîòêè <strong>DOM</strong>, íî ê êîíöó ýòîé ëåêöèè ÷èòàòåëü â îñíîâíîì ïîéìåò, êàê ýòî ðàáîòàåò.</p>
<p>Òå, êòî çíàåò, ÷òî òàêîå äîêóìåíò <strong>XML</strong>, ìîãóò ïðîïóñòèòü ýòîò ðàçäåë. Îñòàëüíûì íåîáõîäèìî åãî ïðî÷èòàòü.</p>
<p>Áóäåì íàäåÿòüñÿ, ÷òî ÷èòàòåëü â êàêîé-òî ñòåïåíè çíàêîì ñ <strong>HTML</strong>. Ýòî òî, èç ÷åãî ñîñòîèò (ïî÷òè) êàæäàÿ Web-ñòðàíèöà. Êàæäîå èçîáðàæåíèå, ññûëêà, òàáëèöà, ïîëå ôîðìû è ò.ä. èìåþò ñâîé ñîáñòâåííûé òåã. Íèæå ïðèâåäåí ïðèìåð ïðîñòîé ñòðàíèöû <strong>HTML</strong>:</p>
<empty-line/>
<p><code>&lt;HTML&gt;</code></p>
<p><code>&lt;BODY&gt;</code></p>
<p><code>&lt;table border="0" cellspacing="2" cellpadding="5"&gt;</code></p>
<p><code>&lt;tr&gt;</code></p>
<p><code>&lt;td colspan="2"&gt;&lt;img src="Greetings.jpg" id="greetingImg" /&gt;&lt;/td&gt;</code></p>
<p><code>&lt;/tr&gt;</code></p>
<p><code>&lt;tr&gt;</code></p>
<p><code>&lt;td&gt;</code></p>
<p><code>Äîáðî ïîæàëîâàòü íà ìîþ ñòðàíèöó HTML!</code></p>
<p><code>&lt;br /&gt;</code></p>
<p><code>&lt;a href="somelink.html" id="myLink" &gt;Ùåëêíèòå çäåñü!&lt;/a&gt;</code></p>
<p><code>&lt;/td&gt;</code></p>
<p><code>&lt;td&gt;&lt;img src="hello.jpg" id="helloImg" /&gt;&lt;/td&gt;</code></p>
<p><code>&lt;/tr&gt;</code></p>
<p><code>&lt;/table&gt;</code></p>
<p><code>&lt;/BODY&gt;</code></p>
<p><code>&lt;/HTML&gt;</code></p>
<empty-line/>
<p>Ýòî ïðîñòî îáû÷íàÿ ñòðàíèöà <strong>HTML</strong>. Âîçìîæíî, âû íå çíàåòå î òîì, ÷òî ýòî òàêæå ïðèìåð äîêóìåíòà <strong>XML</strong>. Çäåñü íàñ èíòåðåñóåò òî, ÷òî êàæäûé ýëåìåíò ÿâëÿåòñÿ ïîòîìêîì è/èëè ïðåäêîì äðóãîãî ýëåìåíòà. Ïåðâîå èçîáðàæåíèå íàõîäèòñÿ âíóòðè òåãà <strong>TD</strong>, êîòîðûé íàõîäèòñÿ âíóòðè òåãîâ <strong>TR</strong>, <strong>TABLE</strong>, <strong>BODY</strong> è <strong>HTML</strong>. Äâèãàÿñü â äðóãîì íàïðàâëåíèè, ìîæíî âèäåòü, ÷òî òåã <strong>BODY</strong> èìååò îäíîãî "ïîòîìêà" – òåã <strong>TABLE</strong>. Ýòîò òåã <strong>TABLE</strong> èìååò â êà÷åñòâå ïîòîìêîâ äâà òåãà <strong>TR</strong> è ò.ä. Ïî ñóòè èìåííî òàê ìû ïåðåìåùàåìñÿ â äîêóìåíòå <strong>XML</strong> èëè <strong>HTML DOM</strong> – äâèãàÿñü îò ïîòîìêà ê ïðåäêó èëè îò ïðåäêà ê ïîòîìêó.</p>
<p>Èçîáðàæåíèå ìîæåò ïîìî÷ü ëó÷øå ïîíÿòü îòíîøåíèÿ ïðåäîê-ïîòîìîê â ýòîì êîäå.</p>
<empty-line/>
<image l:href="#img1.png"/>
<empty-line/>
<subtitle>Áëîê-ñõåìà äîêóìåíòà</subtitle>
<p>Íåîáõîäèìî òàêæå îòìåòèòü àòðèáóòû â íåêîòîðûõ èç ýòèõ òåãîâ. Íàïðèìåð, òåã <strong>TABLE</strong> (<strong>&lt;table border="0" cellspacing="2" cellpadding="5"&gt;</strong>) èìååò <strong>3</strong> çàäàííûõ àòðèáóòà: <strong>border</strong>, <strong>cellspacing</strong> è <strong>cellpadding</strong>. Ïðè èçìåíåíèè <strong>DOM</strong> ÷àñòî áûâàåò íåîáõîäèìî èçìåíèòü ýòè àòðèáóòû. Ìîæíî, íàïðèìåð, èçìåíèòü àòðèáóò <strong>SRC</strong> òåãà <strong>IMG</strong>, ÷òîáû èçìåíèòü âûâîäèìîå èçîáðàæåíèå. Ýòî ÷àñòî äåëàþò, íàïðèìåð, äëÿ ñîçäàíèÿ ýôôåêòà èçìåíåíèÿ èçîáðàæåíèÿ, íà êîòîðîå íàïðàâëåí óêàçàòåëü (<strong>rollover</strong>).</p>
<p>Òåïåðü, èìåÿ îáùåå ïðåäñòàâëåíèå î êîìïîíîâêå ñòðàíèöû, ìîæíî íà÷èíàòü åå ìîäèôèêàöèþ. Íà÷íåì ñ ñîçäàíèÿ ïðîñòîãî ýôôåêòà èçìåíåíèÿ èçîáðàæåíèÿ:</p>
<empty-line/>
<p><code>&lt;img src="button_off.gif"</code></p>
<p><code>onmouseover="this.src='button_over.gif';"</code></p>
<p><code>onmousedown="this.src='button_down.gif';"</code></p>
<p><code>onmouseout ="this.src='button_off.gif';"</code></p>
<p><code>onmouseup ="this.src='button_over.gif';"&gt;</code></p>
<empty-line/>
<p>Â ýòîì êîäå ïðèñóòñòâóþò 4 ñîáûòèÿ èçîáðàæåíèÿ: <strong>onmouseover</strong>, <strong>onmousedown</strong>, <strong>onmouseout</strong> è <strong>onmouseup</strong>. Êàæäîå èç ýòèõ ñîáûòèé èìååò ïðèñîåäèíåííûé ïðîñòîé ôðàãìåíò êîäà <strong>JavaScript</strong>, êîòîðûé èçìåíÿåò àòðèáóò <strong>src</strong> èçîáðàæåíèÿ. Ñîçäàâàÿ òðè ðàçíûõ èçîáðàæåíèÿ, ìîæíî ëåãêî è áûñòðî ñîçäàòü èçîáðàæåíèå ñ òðåìÿ ñìåíÿþùèìè äðóã äðóãà ñîñòîÿíèÿìè.</p>
<p>Îäíîé èç çàäà÷, êîòîðàÿ ñòàíîâèòñÿ âñå áîëåå ðàñïðîñòðàíåííîé â ñîâðåìåííûõ ïðèëîæåíèÿõ <strong>JavaScript</strong>, ÿâëÿåòñÿ âîçìîæíîñòü äîáàâëåíèÿ èëè óäàëåíèÿ ýëåìåíòîâ ñòðàíèöû. Ïðåäïîëîæèì, ÷òî èìååòñÿ ôîðìà, êîòîðàÿ ïîçâîëÿåò ïîñëàòü êîìó-íèáóäü ññûëêó. Îáû÷íî èñïîëüçóåòñÿ îäíî ïîëå ââîäà äëÿ àäðåñà e-mail è âòîðîå – äëÿ èìåíè ïîëó÷àòåëÿ. Åñëè òðåáóåòñÿ ïîñëàòü ññûëêó íåñêîëüêèì àäðåñàòàì, òî ëèáî ïðèäåòñÿ ïîñûëàòü ôîðìó íåñêîëüêî ðàç, ëèáî ìîæíî áûëî áû ðàçìåñòèòü íà ñòðàíèöå áîëåå îäíîãî íàáîðà ïîëåé èìÿ/e-mail. Íî â ýòîì ñëó÷àå ìû âñå åùå îãðàíè÷åíû çàäàííûì ÷èñëîì êîíòàêòîâ. Åñëè èìååòñÿ ïðîñòðàíñòâî äëÿ <strong>5</strong> êîíòàêòîâ è íåîáõîäèìî ïîñëàòü ññûëêó <strong>20</strong> ëþäÿì, òî ôîðìó ïðèäåòñÿ çàïîëíÿòü <strong>4</strong> ðàçà.</p>
<p><strong>JavaScript</strong> ïîçâîëÿåò îáîéòè ýòó ïðîáëåìó, äåëàÿ âîçìîæíûì äèíàìè÷åñêîå äîïîëíåíèå è óäàëåíèå ñîäåðæèìîãî ñòðàíèöû:</p>
<empty-line/>
<p><code>1 var inputs = 0;</code></p>
<p><code>2 function addContact(){</code></p>
<p><code>3 var table = document.getElementById('contacts');</code></p>
<p><code>4</code></p>
<p><code>5 var tr = document.createElement('TR');</code></p>
<p><code>6 var td1 = document.createElement('TD');</code></p>
<p><code>7 var td2 = document.createElement('TD');</code></p>
<p><code>8 var td3 = document.createElement('TD');</code></p>
<p><code>9 var inp1 = document.createElement('INPUT');</code></p>
<p><code>10 var inp2 = document.createElement('INPUT');</code></p>
<p><code>11</code></p>
<p><code>12 if(inputs&gt;0){</code></p>
<p><code>13 var img = document.createElement('IMG');</code></p>
<p><code>14 img.setAttribute('src', 'delete.gif');</code></p>
<p><code>15 img.onclick = function(){</code></p>
<p><code>16 removeContact(tr);</code></p>
<p><code>17 }</code></p>
<p><code>18 td1.appendChild(img);</code></p>
<p><code>19 }</code></p>
<p><code>20</code></p>
<p><code>21 inp1.setAttribute("Name", "Name" +inputs);</code></p>
<p><code>22 inp2.setAttribute("Email", "Email"+inputs);</code></p>
<p><code>23</code></p>
<p><code>24 table.appendChild(tr);</code></p>
<p><code>25 tr.appendChild(td1);</code></p>
<p><code>26 tr.appendChild(td2);</code></p>
<p><code>27 tr.appendChild(td3);</code></p>
<p><code>28 td2.appendChild(inp1);</code></p>
<p><code>29 td3.appendChild(inp2);</code></p>
<p><code>30</code></p>
<p><code>31 inputs++;</code></p>
<p><code>32 }</code></p>
<p><code>33 function removeContact(tr){</code></p>
<p><code>34 tr.parentNode.removeChild(tr);</code></p>
<p><code>35 }</code></p>
<p><code>36 &lt;table&gt;</code></p>
<p><code>37 &lt;tbody id="contacts"&gt;</code></p>
<p><code>38 &lt;tr&gt;</code></p>
<p><code>39 &lt;td colspan="3"&gt;&lt;a href="javascript:addContact();"&gt;Äîáàâüòå êîíòàêò&lt;/a&gt;&lt;/td&gt;</code></p>
<p><code>40 &lt;/tr&gt;</code></p>
<p><code>41 &lt;tr&gt;</code></p>
<p><code>42 &lt;td&gt;&lt;/td&gt;</code></p>
<p><code>43 &lt;td&gt;Name &lt;/td&gt;</code></p>
<p><code>44 &lt;td&gt;Email&lt;/td&gt;</code></p>
<p><code>45 &lt;/tr&gt;</code></p>
<p><code>46 &lt;/tbody&gt;</code></p>
<p><code>47 &lt;/table&gt;</code></p>
<empty-line/>
<p>Äåìîíñòðàöèÿ</p>
<empty-line/>
<p><code>Äîáàâüòå êîíòàêò</code></p>
<empty-line/>
<p><code>Name Email</code></p>
<empty-line/>
<p>Âîçìîæíî âàì íå ïðèõîäèëîñü ðàíåå èñïîëüçîâàòü òåã <strong>TBODY</strong>. Ìíîãèå áðàóçåðû àâòîìàòè÷åñêè äîáàâëÿþò ýòîò òåã â <strong>DOM</strong>, íå ñîîáùàÿ îá ýòîì. Åñëè íåîáõîäèìî èçìåíèòü ñîäåðæèìîå òàáëèöû, òî â äåéñòâèòåëüíîñòè íåîáõîäèìî èçìåíèòü ñîäåðæèìîå <strong>TBODY</strong>. Âî èçáåæàíèå âîçìîæíûõ íåäîðàçóìåíèé ìû ïðîñòî äîáàâèëè òåã <strong>TBODY</strong>, ÷òîáû êàæäûé ìîã áû åãî âèäåòü. Âñå ýòî ìîæåò ïîêàçàòüñÿ äîñòàòî÷íî ñëîæíûì, íî çäåñü î÷åíü ìàëî íîâîãî ìàòåðèàëà.</p>
<p>Ïðåæäå âñåãî çäåñü èìååòñÿ íîâàÿ ôóíêöèÿ: <strong>document.createElement</strong>. Ôóíêöèÿ <strong>createElement</strong> ñîçäàåò çàäàâàåìûé àðãóìåíòîì ýëåìåíò. Ìîæíî âèäåòü, ÷òî â ñòðîêàõ ñöåíàðèÿ ñ 5 ïî 10 ñîçäàåòñÿ íåñêîëüêî ýëåìåíòîâ. Â äåéñòâèòåëüíîñòè ñîçäàåòñÿ íîâàÿ ñòðîêà <strong>TR</strong>, êîòîðàÿ âñòàâëÿåòñÿ â òàáëèöó â ñòðîêàõ 37-46. Â ðåçóëüòàòå íîâàÿ ñòðîêà <strong>TR</strong> áóäåò âûãëÿäåòü ñëåäóþùèì îáðàçîì:</p>
<empty-line/>
<p><code>&lt;tr&gt;</code></p>
<p><code>&lt;td&gt;</code></p>
<p><code>&lt;img src="delete.gif"&gt;</code></p>
<p><code>&lt;/td&gt;</code></p>
<p><code>&lt;td&gt;</code></p>
<p><code>&lt;input name="Name1"&gt;</code></p>
<p><code>&lt;/td&gt;</code></p>
<p><code>&lt;td&gt;</code></p>
<p><code>&lt;input name="Email1"&gt;</code></p>
<p><code>&lt;/td&gt;</code></p>
<p><code>&lt;/tr&gt;</code></p>
<empty-line/>
<p>Äðóãèìè ñëîâàìè, ìû ñîçäàëè 7 ýëåìåíòîâ: 1 <strong>TR</strong>, 3 <strong>TD</strong>, 2 <strong>INPUT</strong> è 1 <strong>IMG</strong>. Òåã <strong>IMG</strong> áóäåò èñïîëüçîâàòüñÿ êàê èçîáðàæåíèå êíîïêè "<strong>Óäàëèòü</strong>". Òàê êàê ïîëüçîâàòåëü äîëæåí âñåãäà âèäåòü ïî êðàéíåé ìåðå 1 ñòðîêó ââîäà, òî ïåðâóþ ñòðîêó óäàëèòü íåâîçìîæíî. Ïîýòîìó â 12 ñòðîêå ñöåíàðèÿ ïðîâåðÿåòñÿ, ÷òî ñîçäàåòñÿ ïåðâàÿ ñòðîêà. Åñëè ñòðîêà íå ïåðâàÿ, òî äîáàâëÿåòñÿ èçîáðàæåíèå.</p>
<p>Ïîñëå ñîçäàíèÿ âñåõ ýòèõ ýëåìåíòîâ îñòàåòñÿ â äåéñòâèòåëüíîñòè ïîìåñòèòü èõ â äîêóìåíò. Êàæäûé ýëåìåíò íà ñòðàíèöå èìååò âñòðîåííóþ ôóíêöèþ <strong>appendChild</strong>, êîòîðóþ ìîæíî èñïîëüçîâàòü äëÿ äîáàâëåíèÿ ê ýòîìó ýëåìåíòó ïîòîìêà. Êîãäà äîáàâëÿåòñÿ ïîòîìîê, òî îí äîáàâëÿåòñÿ êàê ïîñëåäíèé ýëåìåíò, ïîýòîìó åñëè òàáëèöà óæå èìååò â êà÷åñòâå ïîòîìêîâ <strong>10</strong> òåãîâ <strong>TR</strong> è äîáàâëÿåòñÿ åùå îäèí, òî îí áóäåò äîáàâëåí êàê 11-ûé òåã <strong>TR</strong>. Ìû íà÷èíàåì ñ ïîëó÷åíèÿ ññûëêè íà òàáëèöó (ñòðîêà 3). Çàòåì ìû äîáàâëÿåì <strong>TR</strong> ê ýòîé òàáëèöå (ñòðîêà 24) è äîáàâëÿåì çàòåì 3 <strong>TD</strong> (ñòðîêè 25-27). Âòîðîé è òðåòèé <strong>TD</strong> ñîäåðæàò ïîëå ââîäà, ïîýòîìó ìû äîáàâëÿåì ýòè ïîëÿ ââîäà (28-29).</p>
<p>Âîò è âñå! Òåïåðü ó íàñ åñòü íîâûé ýëåìåíò <strong>TR</strong>, è îí íàõîäèòñÿ íà ñòðàíèöå. Îñòàëîñü ïîÿñíèòü åùå ïàðó ìîìåíòîâ. ×òîáû ôîðìà áûëà îáðàáîòàíà ïðàâèëüíî, âñå ïîëÿ ââîäà äîëæíû èìåòü ðàçëè÷íûå èìåíà. Ïîýòîìó ìû çàäàåì èìÿ äâóõ ïîëåé ââîäà íà îñíîâå ñ÷åò÷èêà (21-22), à çàòåì óâåëè÷èâàåì ñ÷åò÷èê (31). Ýòî äåëàåòñÿ ñ ïîìîùüþ åùå îäíîé íîâîé ôóíêöèè <strong>setAttribute</strong>, êîòîðàÿ èìååò äâà ïàðàìåòðà: èìÿ àòðèáóòà è çíà÷åíèå àòðèáóòà. Äëÿ íåå ñóùåñòâóåò äîïîëíèòåëüíàÿ ôóíêöèÿ <strong>getAttribute</strong>, êîòîðàÿ èìååò òîëüêî îäèí àðãóìåíò: èìÿ àòðèáóòà, çíà÷åíèå êîòîðîãî íàäî ïîëó÷èòü.</p>
<empty-line/>
<p><code>element.setAttribute("name", "elementName")</code></p>
<empty-line/>
<p>ïî ñóòè òî æå ñàìîå, ÷òî</p>
<empty-line/>
<p><code>element.name="elementName"</code></p>
<empty-line/>
<p>Îäíàêî çàäàíèå àòðèáóòà íåïîñðåäñòâåííî, êàê â ïðåäûäóùåì ïðèìåðå, ìîæåò èíîãäà âûçûâàòü íåêîòîðûå ïðîáëåìû äëÿ ðàçëè÷íûõ áðàóçåðîâ èëè äëÿ íåêîòîðûõ ñïåöèôè÷åñêèõ àòðèáóòîâ. Ïîýòîìó õîòÿ ëþáîé ìåòîä îáû÷íî áóäåò ðàáîòàòü, ïðåäïî÷òèòåëüíûì ÿâëÿåòñÿ ïåðâûé ìåòîä, èñïîëüçóþùèé <strong>setAttribute</strong>.</p>
<p>Íåîáõîäèìî òàêæå ïîçàáîòèòüñÿ î êíîïêå óäàëåíèÿ. Ìû óæå çíàåì, ÷òî êíîïêà óäàëåíèÿ äëÿ ïåðâîé ñòðîêè ïîëåé íå ñîçäàåòñÿ, íî íåîáõîäèìî çàñòàâèòü åå ðàáîòàòü äëÿ âñåõ îñòàëüíûõ. Ýòî äåëàåòñÿ â ñòðîêàõ êîäà 15-16. Çäåñü ê èçîáðàæåíèþ äîáàâëåíà ôóíêöèÿ <strong>onclick</strong>, êîòîðàÿ âûçûâàåò ôóíêöèþ <strong>removeContact</strong>, ïåðåäàâàÿ ýëåìåíò <strong>TR</strong> â êà÷åñòâå åäèíñòâåííîãî àðãóìåíòà.</p>
<p>Âçãëÿíóâ íà ôóíêöèþ <strong>removeContact</strong>, ìîæíî âèäåòü, ÷òî ñíà÷àëà ïðîèñõîäèò îáðàùåíèå <strong>tr.parentNode</strong> ê ôóíêöèè <strong>parentNode</strong>, êîòîðàÿ ÿâëÿåòñÿ åùå îäíîé ôóíêöèåé äëÿ ðàáîòû ñ <strong>DOM</strong>. Îíà ïðîñòî âîçâðàùàåò ïîðîæäàþùèé ýëåìåíò äëÿ òåêóùåãî ýëåìåíòà. Åñëè ïîñìîòðåòü íà èçîáðàæåííîå ðàíåå äåðåâî äîêóìåíòà, òî âèäíî, ÷òî <strong>parentNode</strong> âåðíåò ýëåìåíò íåïîñðåäñòâåííî íàä ýëåìåíòîì, íà êîòîðîì îí âûçâàí. Ïîýòîìó, åñëè âûçâàòü <strong>parentNode</strong> íà îäèíî÷íîì ýëåìåíòå <strong>A</strong> â ýòîì äåðåâå, òî áóäåò ïîëó÷åíà ññûëêà íà ýëåìåíò <strong>TD</strong> íàä íèì.</p>
<p>Ïîýòîìó <strong>tr.parentNode</strong> âîçâðàùàåò ññûëêó íà ýëåìåíò <strong>TABLE</strong> íàä <strong>TR</strong>. Çàòåì âûçûâàåòñÿ ôóíêöèÿ <strong>removeChild</strong> íà ýòîì ýëåìåíòå <strong>TABLE</strong>, êîòîðàÿ ïðîñòî óäàëÿåò ó ïðåäêà óêàçàííîãî ïîòîìêà.</p>
<p>Âçãëÿíóâ åùå ðàç íà ñòðîêó 34, ìîæíî òåïåðü óâèäåòü, ÷òî îíà ïðîñòî ãîâîðèò: "<strong>Óäàëèòü ýëåìåíò <strong>TR</strong> ó åãî ïðåäêà</strong>" èëè åùå ïðîùå "<strong>Óäàëèòü ýëåìåíò TR</strong>".</p>
<p>Êî âñåì ïîòîìêàì ýëåìåíòà ìîæíî îáðàòèòüñÿ ñ ïîìîùüþ àòðèáóòà <strong>childNodes</strong>, êîòîðûé âîçâðàùàåò ìàññèâ, ñîäåðæàùèé âñå óçëû ïîòîìêè òåêóùåãî ýëåìåíòà. Ìîæíî òàêæå èñïîëüçîâàòü àòðèáóòû <strong>firstChild</strong> è <strong>lastChild</strong> íà ëþáîì ýëåìåíòå, ÷òîáû ïîëó÷èòü ññûëêè íà ïåðâûé èëè íà ïîñëåäíèé ýëåìåíò.</p>
<p>×òîáû óâèäåòü, êàê ýòî ðàáîòàåò, äàâàéòå íàïèøåì ñöåíàðèé äëÿ ðàñêðàñêè ÷åðåäóþùèõñÿ ñòðîê <strong>TR</strong> â òàáëèöå:</p>
<empty-line/>
<p><code>function setColors(tbody, color1, color2){</code></p>
<p><code>var colors = [color1, color2];</code></p>
<p><code>var counter = 0;</code></p>
<p><code>var tr = tbody.firstChild;</code></p>
<empty-line/>
<p><code>while(tr){</code></p>
<p><code>tr.style.backgroundColor = colors[counter++ % 2];</code></p>
<p><code>tr = tr.nextSibling;</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Äåìîíñòðàöèÿ</p>
<empty-line/>
<p><code>Row 1</code></p>
<p><code>Row 2</code></p>
<p><code>Row 3</code></p>
<p><code>Row 4</code></p>
<p><code>Row 5</code></p>
<p><code>Row 6</code></p>
<empty-line/>
<p><code>Color #1: Color #2: Ðàñêðàñüòå òàáëèöó</code></p>
<empty-line/>
<p>Ïðè ðàññìîòðåíèè ýòîãî íåáîëüøîãî ôðàãìåíòà êîäà ìàëî ÷òî íóæíî ïîÿñíÿòü â òîì, êàê ìîæíî ïîëó÷èòü ýòîò èíòåðåñíûé íåáîëüøîé ýôôåêò. Êîä íà÷èíàåòñÿ ñ ïîëó÷åíèÿ ññûëêè íà ïåðâûé ýëåìåíò <strong>TR</strong> â òàáëèöå ñ ïîìîùüþ ìåòîäà <strong>firstChild</strong>. Çàòåì êàæäûé <strong>TR</strong> ðàñêðàøèâàåòñÿ ïî î÷åðåäè äâóìÿ ðàçíûìè öâåòàìè, èñïîëüçóÿ <strong>tr.style</strong>. Öâåò ôîíà çàäàåòñÿ îäíèì èç äâóõ öâåòîâ èç ìàññèâà <strong>colors</strong>. Åñëè <strong>counter</strong> èìååò ÷åòíîå çíà÷åíèå, òî öâåò ôîíà çàäàåòñÿ êàê <strong>color1</strong>. Èíà÷å îí çàäàåòñÿ êàê <strong>color2</strong>. Ýòî ðåàëèçóåòñÿ ñ ïîìîùüþ îïåðàòîðà äåëåíèÿ ïî ìîäóëþ (<strong>%</strong>). Äëÿ òåõ, êòî çàáûë, íàïîìíèì, ÷òî îïåðàöèÿ âû÷èñëÿåò îñòàòîê ïðè äåëåíèè. <strong>5/2 = 2</strong> ñ îñòàòêîì <strong>1</strong>. Ïîýòîìó <strong>5 % 2 (5 ïî ìîäóëþ 2) = 1</strong>.</p>
<p>Çäåñü íå áóäåò îáñóæäàòüñÿ â äàííûé ìîìåíò èçìåíåíèå ñòèëåé, íî äîñòàòî÷íî ñêàçàòü, ÷òî <strong>element.style</strong> ïðåäîñòàâëÿåò äîñòóï êî âñåìó, ÷òî ìîæíî çàäàòü ñ ïîìîùüþ òàáëèöû ñòèëåé. Åñëè íóæíî, íàïðèìåð, çàäàòü ñòèëü ýëåìåíòà, òî ìîæíî ïðî÷èòàòü/çàïèñàòü âåñü ñòèëü ñ ïîìîùüþ <strong>element.style.cssText</strong>.</p>
<p>Ïîñëå çàäàíèÿ öâåòà ôîíà áåðåòñÿ ñëåäóþùèé ýëåìåíò <strong>TR</strong> â òàáëèöå. Ýòî äåëàåòñÿ ñ ïîìîùüþ ôóíêöèè <strong>nextSibling</strong>, êîòîðàÿ âîçâðàùàåò ñëåäóþùèé ýëåìåíò â <strong>DOM</strong>, ñ òåì æå ïðåäêîì, ÷òî è òåêóùèé ýëåìåíò. Åñëè ïîñìîòðåòü íà òåã <strong>TABLE</strong>, òî âñå åãî ïîòîìêè ÿâëÿþòñÿ ýëåìåíòàìè <strong>TR</strong>, ïîýòîìó <strong>nextSibling</strong> áóäåò â öèêëå ïåðåáèðàòü âñå ýëåìåíòû <strong>TR</strong>. Åñëè îòûñêèâàåòñÿ ýëåìåíò <strong>TR</strong> ñ ïîòîìêàìè, ñîñòîÿùèìè èç ýëåìåíòîâ <strong>TD</strong>, òî <strong>nextSibling</strong> áóäåò öèêëè÷åñêè ïåðåáèðàòü âñå ýëåìåíòû <strong>TD</strong>. Êîãäà ýëåìåíòîâ <strong>TR</strong> áîëüøå íå îñòàíåòñÿ, öèêë àâòîìàòè÷åñêè çàêîí÷èòñÿ, òàê êàê <strong>TR</strong> áóäåò íåîïðåäåëåííûì, ÷òî â <strong>JavaScript</strong> îöåíèâàåòñÿ êàê <strong>false</strong>.</p>
<p>Ñ öåëüþ ðàññìîòðåíèÿ îïåðàòîðà <strong>childNodes</strong> è ôóíêöèè <strong>getElementsByTagName</strong> ïåðåïèøåì ïðèâåäåííûé ïðèìåð íåìíîãî ïî-äðóãîìó:</p>
<empty-line/>
<p><code>function setColors(tbody, color1, color2){</code></p>
<p><code>var colors = [color1, color2];</code></p>
<empty-line/>
<p><code>for(var i=0; i&lt;tbody.childNodes.length; i++){</code></p>
<p><code>tbody.childNodes[i].style.backgroundColor = colors[i % 2];</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function setColors(tbody, color1, color2){</code></p>
<p><code>var colors = [color1, color2];</code></p>
<p><code>var trs = tbody.getElementsByTagName('TR');</code></p>
<empty-line/>
<p><code>for(var i=0; i&lt;trs.length; i++){</code></p>
<p><code>trs[i].style.backgroundColor = colors[i % 2];</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Îáå ýòè ôóíêöèè äåëàþò òî æå ñàìîå, ÷òî è ïåðâàÿ ôóíêöèÿ <strong>setColors</strong>, íî íàïèñàíî ýòî íåìíîãî ïî-äðóãîìó. Ïåðâàÿ ôóíêöèÿ èñïîëüçóåò àòðèáóò <strong>childNodes</strong>. Êàê ðàíåå ãîâîðèëîñü, <strong>childNodes</strong> ñîäåðæèò ìàññèâ, ýëåìåíòàìè êîòîðîãî ÿâëÿþòñÿ ïîòîìêè. Ïîýòîìó ìû öèêëè÷åñêè ïåðåáèðàåì <strong>tbody.childNodes</strong> è èçìåíÿåì öâåò êàæäîãî ïîòîìêà, êîòîðûå âñå äîëæíû áûòü ýëåìåíòàìè <strong>TR</strong>.</p>
<p>Äðóãàÿ ôóíêöèÿ èñïîëüçóåò íîâóþ ôóíêöèþ <strong>getElementsByTagName</strong>, êîòîðàÿ âûäàåò ìàññèâ âñåõ ýëåìåíòîâ ñ óêàçàííûì èìåíåì òåãà. Òàê êàê íàì òðåáóþòñÿ âñå ýëåìåíòû <strong>TR</strong>, òî ìû ïðîñòî ïåðåäàåì â ôóíêöèþ <strong>'TR'</strong> è ïîëó÷àåì ñïèñîê âñåõ ýëåìåíòîâ <strong>TR</strong> â òàáëèöå. Ïîñëå ýòîãî êîä ïî÷òè èäåíòè÷åí ïðåäûäóùåé ôóíêöèè.</p>
<p>Ðàáîòà ñ òåêñòîì íåìíîãî îòëè÷àåòñÿ îò ðàáîòû ñ äðóãèìè ýëåìåíòàìè <strong>DOM</strong>. Ïåðâîå: êàæäûé ôðàãìåíò òåêñòà íà ñòðàíèöå ïîìåùåí â íåâèäèìûé óçåë <strong>#TEXT</strong>. Ïîýòîìó ñëåäóþùèé êîä <strong>HTML</strong></p>
<empty-line/>
<p><code>&lt;div id="ourTest"&gt;this is &lt;a href="link.html"&gt;a link&lt;/a&gt; and an image: &lt;img src="img.jpg"&gt;&lt;/div&gt;</code></p>
<empty-line/>
<p>èìååò ÷åòûðå êîðíåâûõ ýëåìåíòà: òåêñòîâûé óçåë ñî çíà÷åíèåì "<strong>this is</strong>", ýëåìåíò <strong>A</strong>, åùå îäèí òåêñòîâûé óçåë ñî çíà÷åíèåì "<strong>and an image:</strong>" è, íàêîíåö, ýëåìåíò <strong>IMG</strong>. Ýëåìåíò <strong>A</strong> èìååò êîíå÷íûé òåêñòîâûé óçåë â êà÷åñòâå ïîòîìêà ñî çíà÷åíèåì "<strong>a link</strong>". Êîãäà íåîáõîäèìî èçìåíèòü òåêñò, òî ïðåæäå âñåãî íåîáõîäèìî ïîëó÷èòü ýòîò "íåâèäèìûé" óçåë. Åñëè ìû õîòèì èçìåíèòü òåêñò "<strong>and an image:</strong>", òî íåîáõîäèìî íàïèñàòü:</p>
<empty-line/>
<p><code>document.getElementById('ourTest').childNodes[2].nodeValue = 'our new text';</code></p>
<empty-line/>
<p><strong>document.getElementById('ourTest')</strong> äàåò íàì òåã <strong>div. childNodes[2]</strong> äàåò óçåë òåêñòà "<strong>and an image:</strong>" è íàêîíåö <strong>nodeValue</strong> èçìåíÿåò çíà÷åíèå ýòîãî óçëà òåêñòà.</p>
<p>×òî, åñëè òðåáóåòñÿ äîáàâèòü ê ýòîìó åùå òåêñò, íî íå â êîíöå, à ïåðåä "<strong>a link</strong>"?</p>
<empty-line/>
<p><code>var newText = document.createTextNode('our new text');</code></p>
<p><code>var ourDiv = document.getElementById('ourTest');</code></p>
<p><code>ourDiv.insertBefore(newText, ourDiv.childNodes[1]);</code></p>
<empty-line/>
<p>Ïåðâàÿ ñòðîêà ïîêàçûâàåò, êàê ñîçäàòü òåêñò ñ ïîìîùüþ <strong>document.createTextNode</strong>. Ýòî àíàëîãè÷íî ôóíêöèè èñïîëüçîâàííîé ðàíåå ôóíêöèè <strong>document.createElement</strong>. Òðåòüÿ ñòðîêà ñîäåðæèò åùå îäíó íîâóþ ôóíêöèþ <strong>insertBefore</strong>, êîòîðàÿ àíàëîãè÷íà <strong>appendChild</strong>, çà èñêëþ÷åíèåì òîãî, ÷òî èìååò äâà àðãóìåíòà: äîáàâëÿåìûé ýëåìåíò è ñóùåñòâóþùèé ýëåìåíò, ïåðåä êîòîðûì íàäî ñäåëàòü âñòàâêó. Òàê êàê ìû õîòèì äîáàâèòü íîâûé òåêñò ïåðåä ýëåìåíòîì <strong>A</strong> è çíàåì, ÷òî ýëåìåíò <strong>A</strong> ÿâëÿåòñÿ âòîðûì ýëåìåíòîì â <strong>div</strong>, òî ìû èñïîëüçóåì <strong>ourDiv.childNodes[1]</strong> â êà÷åñòâå âòîðîãî àðãóìåíòà äëÿ <strong>insertBefore</strong>.</p>
<p>Ïî áîëüøåé ÷àñòè ýòî âñå ìàíèïóëÿöèè ñ <strong>DOM</strong>. Åñëè òðåáóåòñÿ ñîçäàòü, íàïðèìåð, ïîëå ñ èçìåíÿåìûì ðàçìåðîì, òî äëÿ èçìåíåíèÿ øèðèíû è âûñîòû ïîëÿ áóäóò èñïîëüçîâàòüñÿ òå æå ôóíêöèè ìûøè è ôóíêöèè <strong>getAttribute</strong> è <strong>setAttribute</strong>. Î÷åíü ïîõîæèì îáðàçîì, åñëè èçìåíÿòü âåðõíþþ è ëåâóþ ïîçèöèþ ñòèëÿ ýëåìåíòà, òî ìîæíî ïåðåìåùàòü ýëåìåíòû ïî ñòðàíèöå, ëèáî â îòâåò íà ââîä ìûøè (ïåðåòàñêèâàíèå), ëèáî ïî òàéìåðó (àíèìàöèÿ).</p>
<p>Â êà÷åñòâå ïîñëåäíåãî çàìå÷àíèÿ ê ýòîé ëåêöèè: îäíèì èç íàèáîëåå ïîëåçíûõ ñðåäñòâ ïðè ïîïûòêå ïðîòåñòèðîâàòü èëè îòëàäèòü êîä <strong>JavaScript</strong>, êîòîðûé èçìåíÿåò <strong>DOM</strong>, ÿâëÿåòñÿ ñöåíàðèé îáõîäà äåðåâà <strong>DOM</strong>. Ïðîùå ãîâîðÿ – ýòî ñöåíàðèé, êîòîðûé ïîêàçûâàåò êàæäûé ýëåìåíò è êàæäûé àòðèáóò îáúåêòà <strong>DOM</strong>. Îïèñàíèå ýòîãî êîäà âûõîäèò çà ðàìêè ýòîé ëåêöèè, íî îí ìîã áû, íàïðèìåð, ïîêàçûâàòü âñå àòðèáóòû è îáúåêòû-ïîòîìêè ëþáîãî ïîëó÷àåìîãî â êà÷åñòâå àðãóìåíòà îáúåêòà.</p>
<p>Òåïåðü ìîæíî âêëþ÷èòü ñâîå âîîáðàæåíèå è ýêñïåðèìåíòèðîâàòü, òàê êàê ïî÷òè íåò íè÷åãî òàêîãî, ÷åãî íåëüçÿ ñäåëàòü ñî ñòðàíèöåé <strong>HTML</strong>, êîãäà âû çíàåòå, êàê îáðàùàòüñÿ ñ <strong>DOM</strong>. Â ñëåäóþùåé ëåêöèè áóäóò ðàññìîòðåíû îáúåêòû îêíà è äîêóìåíòà.</p>
</section>
<section>
<title>
<p><emphasis>Ëåêöèÿ 7.</emphasis> Îáúåêò äîêóìåíòà è îáúåêò îêíà</p>
</title>
<p><emphasis>Îáúåêò äîêóìåíòà (document) è îáúåêò îêíà (window). Ôóíêöèè setTimeout è setInterval, window.opener, document.body è document.documentElement. Câîéñòâà äîêóìåíòà title, referer è cookies.</emphasis></p>
<p>Â ïðåäûäóùåé ëåêöèè ðàññìàòðèâàëîñü èñïîëüçîâàíèå îáúåêòà äîêóìåíòà. Áûëè ïîêàçàíû ôóíêöèè <strong>document.forms</strong>, <strong>document.getElementById</strong>, <strong>document.createElement</strong> è íåêîòîðûå äðóãèå, êîòîðûå âñòðîåíû â îáúåêò <strong>document</strong>. Â ýòîé ëåêöèè áóäóò ïîäðîáíî ðàññìîòðåíû îáúåêò äîêóìåíòà (<strong>document</strong>) è îáúåêò îêíà (<strong>window</strong>), êîòîðûå îáëàäàþò ìíîãèìè ïîëåçíûìè ôóíêöèÿìè.</p>
<p>Îáúåêò <strong>document</strong> ïðåäñòàâëÿåò ðåàëüíîå ñîäåðæèìîå ñòðàíèöû è ïîýòîìó èìååò ôóíêöèè, êîòîðûå ïîìîãàþò èçìåíèòü ñàìó ñòðàíèöó. Íàïðèìåð, çàïèñü íà ñòðàíèöå ïðîèñõîäèò ñ ïîìîùüþ <strong>document.write</strong>, à îáðàùåíèå ê ôîðìå – ñ ïîìîùüþ <strong>document.forms</strong>.</p>
<p>Êàê óïîìèíàëîñü â øåñòîé ëåêöèè, êàæäûé îáúåêò íà ñòðàíèöå ÿâëÿåòñÿ ïîòîìêîì èëè ïðåäêîì êàêîãî-òî äðóãîãî îáúåêòà. Âñå ýòî ïðåäñòàâëÿåò áîëüøîå äåðåâî. Îáúåêò <strong>window</strong> íàõîäèòñÿ â âåðøèíå ýòîãî äåðåâà, à âñå îñòàëüíîå ñîäåðæèòñÿ â íåì. Îáúåêò <strong>window</strong> óêàçûâàåò íà ðåàëüíîå îêíî áðàóçåðà. Åñëè òðåáóåòñÿ, íàïðèìåð, îòêðûòü íîâîå îêíî èëè èçìåíèòü ðàçìåð òåêóùåãî, òî äëÿ ýòîãî èñïîëüçóþòñÿ ôóíêöèè îáúåêòà <strong>window</strong>.</p>
<p>Îáúåêò <strong>window</strong>, êðîìå òîãî, ÷òî íàõîäèòñÿ â âåðøèíå <strong>DOM</strong>, ÿâëÿåòñÿ òàêæå ãëîáàëüíûì îáúåêòîì. Âî âòîðîé ëåêöèè ìû ãîâîðèëè î òîì, ÷òî ëþáàÿ ïåðåìåííàÿ îáëàäàåò ãëîáàëüíîé èëè ëîêàëüíîé îáëàñòüþ äåéñòâèÿ. Åñëè îíà èìååò ãëîáàëüíóþ îáëàñòü äåéñòâèÿ, òî îíà äîñòóïíà â ëþáîì ìåñòå ñöåíàðèÿ <strong>JavaScript</strong>. Îáëàäàíèå ãëîáàëüíîé îáëàñòüþ äåéñòâèÿ îçíà÷àåò òàêæå, ÷òî ïåðåìåííàÿ ñîåäèíåíà íåïîñðåäñòâåííî ñ îáúåêòîì <strong>window</strong>. Ëþáîé êîä <strong>JavaScript</strong>, êîòîðûé íå íàõîäèòñÿ âíóòðè êàêîé-òî ôóíêöèè, íàõîäèòñÿ â ãëîáàëüíîì îáúåêòå <strong>window</strong>.</p>
<p>Â ñâÿçè ñ ýòèì íå òðåáóåòñÿ ïèñàòü <strong>window</strong> ïðè îáðàùåíèè ê ôóíêöèÿì èëè ïåðåìåííûì îáúåêòà <strong>window</strong>, êàê â ñëó÷àå èñïîëüçîâàíèÿ íåêîòîðûõ äðóãèõ ôóíêöèé, òàêèõ, êàê <strong>document.getElementById. alert()</strong> ÿâëÿåòñÿ ïðèìåðîì ôóíêöèè, êîòîðóþ ìîæíî âûçâàòü ëèáî êàê <strong>window.alert()</strong>, ëèáî ïðîñòî <strong>alert()</strong>.</p>
<p>Ïðåæäå âñåãî îáúåêò <strong>window</strong> ïðåäîñòàâëÿåò äîñòóï ê èíôîðìàöèè îá îêíå:</p>
<empty-line/>
<table>
<tr>
<th>Ñâîéñòâî</th>
<th>Îïèñàíèå</th>
</tr>
<tr>
<td><strong>window.location</strong></td>
<td>âîçâðàùàåò òåêóùèé <strong>URL</strong> îêíà</td>
</tr>
<tr>
<td><strong>window.opener</strong></td>
<td>Åñëè îêíî áûëî îòêðûòî äðóãèì îêíîì (ñ ïîìîùüþ <strong>window.open</strong>), òî âîçâðàùàåòñÿ ññûëêà íà îòêðûâàþùåå îêíî, èíà÷å <strong>null</strong></td>
</tr>
<tr>
<td><strong>MSIE</strong>: <strong>window.screenTop</strong> Äðóãèå: <strong>window.screenY</strong></td>
<td>Âîçâðàùàåò âåðõíþþ ïîçèöèþ îêíà. Îòìåòèì, ÷òî ýòè çíà÷åíèÿ â <strong>MSIE</strong> ñóùåñòâåííî îòëè÷àþòñÿ îò äðóãèõ áðàóçåðîâ. <strong>MSIE</strong> âîçâðàùàåò âåðõíþþ ïîçèöèþ îáëàñòè ñîäåðæèìîãî (íèæå àäðåñíîé ñòðîêè, êíîïîê, è ò.ä.). Äðóãèå áðàóçåðû âîçâðàùàþò âåðõíþþ ïîçèöèþ ðåàëüíîãî îêíà (âûøå êíîïêè çàêðûòèÿ)</td>
</tr>
<tr>
<td><strong>MSIE</strong>: <strong>window.screenLeft</strong> Äðóãèå: <strong>window.screenX</strong></td>
<td>Âîçâðàùàåò ëåâóþ ïîçèöèþ îêíà ñ òàêèìè æå ðàçëè÷èÿìè, êàê è äëÿ <strong>screenTop</strong> è <strong>screenY</strong></td>
</tr>
</table>
<empty-line/>
<p>Ïîëîæåíèå îêíà íà ýêðàíå ïîëüçîâàòåëÿ ðåäêî áûâàåò íåîáõîäèìî, íî äâà äðóãèõ ñâîéñòâà, <strong>location</strong> è <strong>opener</strong>, áóäóò î÷åíü ïîëåçíû. Ñâîéñòâî <strong>window.location</strong> âûïîëíÿåò äâå ôóíêöèè. Åñëè èçìåíèòü åãî ñ ïîìîùüþ <strong>JavaScript</strong>, íàïðèìåð, <strong>window.location='http://www.htmlgoodies.com'</strong>, òî áðàóçåð áóäåò ïåðåíàïðàâëåí íà ýòó ñòðàíèöó. ×òåíèå <strong>window.location</strong> âûäàåò àäðåñ òåêóùåãî äîêóìåíòà. Çà÷åì ýòî íóæíî çíàòü? Îáû÷íî àäðåñ ñòðàíèöû íå íóæåí, íî ìîæåò ïîòðåáîâàòüñÿ ñòðîêà çàïðîñà èëè àíêåð. Âîçüìåì, íàïðèìåð, ñëåäóþùèé <strong>URL</strong>:</p>
<p><a l:href="http://www.somesite.com/page.asp?action=browse&amp;id=5#someAnchor">http://www.somesite.com/page.asp?action=browse&amp;id=5#someAnchor</a>.</p>
<p>Ýòîò <strong>URL</strong> ìîæíî ðàçáèòü íà òðè ÷àñòè:</p>
<empty-line/>
<table>
<tr>
<td><strong>URL</strong>:</td>
<td>http://www.somesite.com/page.asp</td>
</tr>
<tr>
<td>Ñòðîêà çàïðîñà:</td>
<td>action=browse&amp;id=5</td>
</tr>
<tr>
<td>Àíêåð:</td>
<td>someAnchor</td>
</tr>
</table>
<empty-line/>
<p>Òàê êàê <strong>window.location</strong> ñîäåðæèò âñþ ýòó èíôîðìàöèþ, òî ìîæíî íàïèñàòü ôóíêöèþ, êîòîðàÿ áóäåò âîçâðàùàòü ïåðåìåííóþ querystring (ñòðîêó çàïðîñà). Ýòî àíàëîãè÷íî <strong>request.querystring</strong> â <strong>ASP</strong> èëè <strong>$_GET</strong> â <strong>PHP</strong>, åñëè âû çíàêîìû ñ êàêèì-ëèáî èç ýòèõ ÿçûêîâ:</p>
<empty-line/>
<p><code>function queryString(val){</code></p>
<p><code>var q = unescape(location.search.substr(1)).split('&amp;');</code></p>
<empty-line/>
<p><code>for(var i=0; i&lt;q.length; i++){</code></p>
<p><code>var t=q[i].split('=');</code></p>
<p><code>if(t[0].toLowerCase()==val.toLowerCase()) return t[1];</code></p>
<p><code>}</code></p>
<p><code>return '';</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Äëÿ ïðåäûäóùåãî <strong>URL</strong> ôóíêöèÿ <strong>queryString('action')</strong> âåðíåò <strong>'browse'</strong>. Ìû âèäèì çäåñü íîâóþ ôóíêöèþ <strong>window.unescape</strong>. Ôóíêöèÿ <strong>unescape</strong>, à òàêæå åå äîïîëíèòåëüíàÿ ôóíêöèÿ <strong>escape</strong>, èñïîëüçóþòñÿ â ñîåäèíåíèè ñ <strong>window.location</strong>. Ïðè ïåðåäà÷å äàííûõ â ñòðîêå çàïðîñà îíà äîëæíà áûòü ýêðàíèðîâàíà (escaped), ÷òîáû îíà íå âëèÿëà íà ñàìó ñòðîêó çàïðîñà. Åñëè, íàïðèìåð, ñðåäè äàííûõ èìååòñÿ çíàê àìïåðñàíä (<strong>&amp;</strong>), òî íåîáõîäèìî åãî ýêðàíèðîâàòü, ÷òîáû ìîæíî áûëî ðàçëè÷èòü ýòîò çíàê â äàííûõ è òîò <strong>&amp;</strong>, êîòîðûé ðàçäåëÿåò äâà ðàçëè÷íûõ çíà÷åíèÿ. Ôóíêöèÿ <strong>escape</strong> ïîäãîòàâëèâàåò ïîñûëàåìûå äàííûå äëÿ èñïîëüçîâàíèÿ â êà÷åñòâå çíà÷åíèÿ <strong>querystring</strong>, ïîýòîìó îíà èñïîëüçóåòñÿ ïðè çàäàíèè <strong>window.location</strong>. Íàïðèìåð:</p>
<empty-line/>
<p><code>window.location='/page.asp?name='+escape(SomeInputBox.value);</code></p>
<empty-line/>
<p>Ôóíêöèÿ <strong>unescape</strong> äåëàåò îáðàòíîå è ïîçâîëÿåò ïîëó÷èòü "íîðìàëüíûé" òåêñò èç <strong>window.location</strong>.</p>
<p>Âåðíåìñÿ ê ñâîéñòâàì <strong>window</strong>, ãäå èìååòñÿ ñâîéñòâî <strong>opener</strong>. Ýòî ñâîéñòâî èñïîëüçóåòñÿ â ñîåäèíåíèè ñ îáû÷íî èñïîëüçóåìîé ôóíêöèåé <strong>window.open</strong>, êîòîðàÿ ïîçâîëÿåò îòêðûâàòü íîâîå îêíî áðàóçåðà è, äëÿ íåêîòîðûõ ñâîéñòâ óïðàâëÿòü åãî âûâîäîì. Áëîêèðîâùèêè âñïëûâàþùèõ îêîí î÷åíü ÷àñòî áóäóò ïðåïÿòñòâîâàòü îòêðûòèþ îêíà ñ ïîìîùüþ <strong>window.open</strong>, åñëè â ýòîò ïðîöåññ íå âîâëå÷åí ùåë÷îê ìûøüþ. Ïîýòîìó, åñëè â êîäå èìååòñÿ âûçîâ <strong>window.open</strong> è ïðè ýòîì ïîëüçîâàòåëü íå ùåëêàåò íà ññûëêå èëè ÷åì-òî ïîäîáíîì, òî ñêîðåå âñåãî ýòî íå áóäåò ðàáîòàòü.</p>
<p>Ôóíêöèÿ <strong>window.open</strong> ïîëó÷àåò äî <strong>3</strong> àðãóìåíòîâ: <strong>URL</strong> îêíà, êîòîðîå íàäî îòêðûòü, èìÿ îêíà è ñâîéñòâà îêíà.</p>
<empty-line/>
<p><code>var newWindow=window.open('', 'newWindow', 'width=200,height=200');</code></p>
<p><code>newWindow.document.write('Ýòî îêíî áóäåò çàêðûòî ÷åðåç 2 ñåêóíäû');</code></p>
<p><code>setTimeout(function(){ newWindow.close(); }, 2000);</code></p>
<empty-line/>
<p>Òðåòèé àðãóìåíò <strong>window.open</strong> ïîëó÷àåò ñòðîêó àðãóìåíòîâ. Îáû÷íî èñïîëüçóþòñÿ ñëåäóþùèå:</p>
<p><strong>[x] width</strong>, <strong>height</strong> – çàäàþò ðàçìåðû îêíà;</p>
<p><strong>[x] left</strong>, <strong>top</strong> – çàäàþò ïîëîæåíèå îêíà íà ýêðàíå;</p>
<p><strong>[x] location</strong>, <strong>menubar</strong>, <strong>toolbar</strong>, <strong>status</strong>, <strong>titlebar</strong>, <strong>scrollbars</strong> – ýòè ïàðàìåòðû âûâîäÿò/ñêðûâàþò ñâîè ñîîòâåòñòâóþùèå "ïàíåëè" íà îêíå. Çàäàéòå <strong>yes</strong>, ÷òîáû âûâåñòè ñîîòâåòñòâóþùóþ "ïàíåëü";</p>
<p><strong>[x] resizable</strong> – åñëè çàäàí êàê <strong>yes</strong>, òî ðàçìåð îêíà ìîæíî èçìåíÿòü.</p>
<p>Ïîëíîå îïèñàíèå <strong>window.open</strong> ìîæíî óâèäåòü â äîêóìåíòàöèè Mozilla.</p>
<p>Òàê êàê ìû îòêðûâàåì ïóñòîå îêíî, òî ïåðâûé àðãóìåíò áóäåò ïóñòûì. Äëÿ îòêðûòèÿ ñòðàíèöû <strong>'test.html'</strong> âûçîâ âûãëÿäåë áû ñëåäóþùèì îáðàçîì: <strong>window.open ('test.html', 'TestWindow', 'width=200,height=200')</strong>.</p>
<p>Â ýòîì ïðèìåðå äëÿ îáúåêòà <strong>window</strong>, îòêðûâàåìîãî îêíà, çàäàåòñÿ ïåðåìåííàÿ <strong>newWindow</strong>. Â ñâÿçè ñ ýòèì äëÿ âûâîäà ñîäåðæèìîãî â îêíå íåîáõîäèìî èñïîëüçîâàòü <strong>newWindow.document.write</strong>.</p>
<p>Ôóíêöèÿ <strong>window.open</strong> òàêæå èìååò ñâîþ ïðîòèâîïîëîæíîñòü, ôóíêöèþ <strong>window.close</strong>. Îäíàêî ýòà ôóíêöèÿ ìîæåò óñïåøíî âûçûâàòüñÿ òîëüêî íà îêíàõ, ñîçäàííûõ <strong>JavaScript</strong>. Åñëè ïîïðîáîâàòü çàêðûòü îêíî, ñîçäàííîå íå <strong>JavaScript</strong>, òî âîçìîæíû äâà âàðèàíòà: ëèáî ïîÿâèòñÿ ñîîáùåíèå, ãîâîðÿùåå, ÷òî ñöåíàðèé ïûòàåòñÿ çàêðûòü îêíî, ëèáî áðàóçåð ïðîñòî ýòî ïðîèãíîðèðóåò.</p>
<p>Ìîæíî âèäåòü, ÷òî â ýòîì ïðèìåðå èñïîëüçóåòñÿ åùå îäíà íîâàÿ ôóíêöèÿ <strong>setTimeout</strong>. Ôóíêöèè <strong>setTimeout</strong> è <strong>setInterval</strong> ïðèìåíÿþòñÿ äëÿ âûïîëíåíèÿ êîäà ïîñëå óêàçàííîãî èíòåðâàëà âðåìåíè è îáå ïîëó÷àþò äâà àðãóìåíòà: ôóíêöèþ èëè ñòðîêó êîäà è ïåðèîä îæèäàíèÿ â ìñ. <strong>1 ìñ = 1/1000 ñåêóíäû</strong>, ïîýòîìó äëÿ çàäàíèÿ âûïîëíåíèÿ êîäà ÷åðåç <strong>5</strong> ñåêóíä íåîáõîäèìî îïðåäåëèòü â ýòîì ñëó÷àå äëÿ âòîðîãî àðãóìåíòà çíà÷åíèå <strong>5000</strong>.</p>
<p><strong>setTimeout</strong> âûïîëíèò êîä îäèí ðàç ïîñëå çàâåðøåíèÿ çàäàííîãî èíòåðâàëà âðåìåíè. <strong>setInterval</strong> áóäåò ïðîäîëæàòü âûïîëíÿòü êîä ïîñëå çàâåðøåíèÿ êàæäîãî èíòåðâàëà. Ïðè çàäàííîì èíòåðâàëå <strong>5000 setInterval</strong> áóäåò âûïîëíÿòü êîä êàæäûå <strong>5</strong> ñåêóíä.</p>
<p>Ñóùåñòâóþò åùå äâå äðóãèå ôóíêöèè: <strong>clearTimeout</strong> è <strong>clearInterval</strong>, êîòîðûå îòìåíÿþò âûïîëíåíèå, ÷åðåç çàäàííûå èíòåðâàëû. Îäíàêî äëÿ ýòîãî íåîáõîäèìî èìåòü ññûëêó íà âûçîâ <strong>setTimeout</strong> èëè <strong>setInterval</strong>, íàïðèìåð:</p>
<empty-line/>
<p><code>var myTimeout = setTimeout("alert('Hi!');", 500);</code></p>
<p><code>clearTimeout(myTimeout);</code></p>
<empty-line/>
<p>Åñëè íå ñîõðàíèòü ññûëêó â ïåðåìåííîé <strong>myTimeout</strong>, òî íå ñóùåñòâóåò ñïîñîáà îòìåíèòü çàäàííîå âûïîëíåíèå. Äàâàéòå ïîñìîòðèì íà ïðèìåð ýòîãî â äåéñòâèè:</p>
<empty-line/>
<p><code>function createTimeout(text, time){</code></p>
<p><code>setTimeout("alert('"+text+"');", time);</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>var intervals = [];</code></p>
<p><code>function createInterval(text, time){</code></p>
<p><code>// ñîõðàíÿåò èíòåðâàë â ìàññèâå intervals</code></p>
<p><code>intervals.push(setInterval("alert('"+text+"');", time));</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function tut5(){</code></p>
<p><code>if(intervals.length==0) return;</code></p>
<p><code>// óäàëÿåò ïîñëåäíèé èíòåðâàë âûïîëíåíèÿ â ìàññèâå intervals</code></p>
<p><code>clearInterval(intervals.pop());</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>Äåìîíñòðàöèÿ â äåéñòâèè</code></p>
<empty-line/>
<p><code>Òåêñò äëÿ âûâîäà:</code></p>
<empty-line/>
<p><code>Âðåìÿ îæèäàíèÿ(â ìñ):</code></p>
<empty-line/>
<p><code>setTimeout</code></p>
<p><code>setInterval</code></p>
<p><code>clearInterval</code></p>
<empty-line/>
<p>Ñóùåñòâóåò òàêæå ôóíêöèÿ <strong>clearTimeout</strong>, êîòîðàÿ èäåíòè÷íà ïî ñèíòàêñèñó <strong>clearInterval</strong>.</p>
<p>Âàæíî îòìåòèòü, ÷òî âî âðåìÿ îæèäàíèÿ âûïîëíåíèÿ çàäàííîãî êîäà ôóíêöèÿìè <strong>setTimeout</strong> èëè <strong>setInterval</strong> âåñü îñòàëüíîé êîä <strong>JavaScript</strong> ïðîäîëæàåò âûïîëíÿòüñÿ. Êîãäà ôóíêöèÿ <strong>setTimeout</strong> èëè <strong>setInterval</strong> áóäåò ãîòîâà, îíà âûïîëíèò çàäàííûé êîä, íî òîëüêî ïîñëå òîãî, êàê äðóãîé êîä çàêîí÷èò âûïîëíåíèå. Äðóãèìè ñëîâàìè, <strong>setTimeout</strong> è <strong>setInterval</strong> íèêîãäà íå ïðåðûâàþò äëÿ âûïîëíåíèÿ äðóãîé êîä.</p>
<p>Êàê ãîâîðèëîñü ðàíåå, ñâîéñòâî îêíà <strong>'opener'</strong> ìîæíî èñïîëüçîâàòü äëÿ äîñòóïà ê îêíó, êîòîðîå îòêðûëî òåêóùåå îêíî, à òàêæå ê ëþáûì ñâîéñòâàì, ôóíêöèÿì è ò.ä. ýòîãî îêíà. Íàïðèìåð:</p>
<empty-line/>
<p><code>&lt;!--page1.html--&gt;</code></p>
<p><code>&lt;HTML&gt;</code></p>
<p><code>&lt;HEAD&gt;</code></p>
<p><code>&lt;script type="text/javascript"&gt;</code></p>
<p><code>window.open('page2.html', 'TestWindow', 'width=500,height=200,resizable=yes');</code></p>
<p><code>&lt;/script&gt;</code></p>
<p><code>&lt;/HEAD&gt;</code></p>
<p><code>&lt;/HTML&gt;</code></p>
<empty-line/>
<p><code>&lt;!--page2.html--&gt;</code></p>
<p><code>&lt;HTML&gt;</code></p>
<p><code>&lt;HEAD&gt;</code></p>
<p><code>&lt;script type="text/javascript"&gt;</code></p>
<p><code>document.write('URL îêíà ïðåäêà áóäåò : '+window.opener.location);</code></p>
<p><code>&lt;/script&gt;</code></p>
<p><code>&lt;/HEAD&gt;</code></p>
<p><code>&lt;/HTML&gt;</code></p>
<empty-line/>
<p>Îòìåòèì, ÷òî ýòî ðàáîòàåò, òîëüêî åñëè <strong>URL</strong> îòêðûâàåìîãî îêíà íàõîäèòñÿ íà òîì æå ñåðâåðå, ÷òî è òåêóùàÿ ñòðàíèöà. Åñëè íåîáõîäèìî îòêðûòü, íàïðèìåð, îêíî íà <a l:href="http://www.webreference.com/">http://www.webreference.com</a>, òî ìû íå ïîëó÷èì äîñòóï ê ñâîéñòâàì ýòîãî îêíà. Ýòî ïîääåðæèâàåòñÿ âñåìè îñíîâíûìè áðàóçåðàìè ïî ñîîáðàæåíèÿì áåçîïàñíîñòè.</p>
<p>Îäíîé èç íàèáîëåå ÷àñòî èñïîëüçóåìûõ ôóíêöèé â <strong>JavaScript</strong> ÿâëÿåòñÿ <strong>document.write</strong>. Ìîæíî ñêàçàòü, ÷òî <strong>document.write</strong> ïîëó÷àåò ñòðîêó è âûâîäèò åå íà ñòðàíèöå. Çäåñü íåîáõîäèìî òîëüêî ñëåäèòü çà îäíîé âåùüþ. Åñëè ñòðàíèöà ïîëíîñòüþ çàãðóçèëàñü è âûçûâàåòñÿ <strong>document.write</strong>, òî âñÿ ñòðàíèöà áóäåò î÷èùåíà è íà ýêðàíå áóäåò òîëüêî ðåçóëüòàò ðàáîòû <strong>document.write</strong>.</p>
<p>Ìû óæå âèäåëè ðàçëè÷íûå ñâîéñòâà îáúåêòà <strong>document</strong> â äåéñòâèè. Íàïðèìåð, <strong>document.forms</strong> âîçâðàùàåò ìàññèâ âñåõ ôîðì íà ñòðàíèöå. Çäåñü òàêæå ñóùåñòâóåò íåñêîëüêî ñâîéñòâ, ïîäîáíûõ ýòîìó.</p>
<p><strong>[x] document.forms</strong> – ìàññèâ, ñîäåðæàùèé âñå ôîðìû íà òåêóùåé ñòðàíèöå;</p>
<p><strong>[x] document.images</strong> – ìàññèâ, ñîäåðæàùèé âñå èçîáðàæåíèÿ íà òåêóùåé ñòðàíèöå;</p>
<p><strong>[x] document.links</strong> – ìàññèâ, ñîäåðæàùèé âñå ññûëêè íà òåêóùåé ñòðàíèöå;</p>
<p><strong>[x] document.anchors</strong> – ìàññèâ, ñîäåðæàùèé âñå àíêåðû íà òåêóùåé ñòðàíèöå;</p>
<p><strong>[x] document.applets</strong> – ìàññèâ, ñîäåðæàùèé âñå àïïëåòû íà òåêóùåé ñòðàíèöå;</p>
<p><strong>[x] document.styleSheets</strong> – ìàññèâ, ñîäåðæàùèé âñå òàáëèöû ñòèëåé íà òåêóùåé ñòðàíèöå;</p>
<p><strong>[x] window.frames</strong> – ìàññèâ, ñîäåðæàùèé âñå ôðåéìû íà òåêóùåé ñòðàíèöå.</p>
<p>Êàê ìû âèäåëè â ïðåäûäóùåé ëåêöèè, ïî÷òè âñå ýòè ñâîéñòâà ìîæíî ïðîäóáëèðîâàòü ñ ïîìîùüþ <strong>document.getElementsByTagName</strong>. ×òîáû ïîëó÷èòü âñå èçîáðàæåíèÿ íà ñòðàíèöå, ìîæíî âîñïîëüçîâàòüñÿ, íàïðèìåð, <strong>document.getElementsByTagName('IMG');</strong>. Ñóùåñòâóåò òðè ïîäîáíûå ôóíêöèè:</p>
<p><strong>[x] document.getElementById</strong> – âîçâðàùàåò îäèí ýëåìåíò íà îñíîâå åãî <strong>ID</strong>;</p>
<p><strong>[x] document.getElementsByName</strong> – âîçâðàùàåò ìàññèâ ýëåìåíòîâ, îïðåäåëåííûõ ïî èìåíè. Â îòëè÷èå îò <strong>ID</strong> ìíîãèå ýëåìåíòû ìîãóò èìåòü íà ñòðàíèöå îäèíàêîâûå èìåíà;</p>
<p><strong>[x] document.getElementsByTagName</strong> – âîçâðàùàåò ìàññèâ ýëåìåíòîâ, îïðåäåëåííûõ ïî èìåíè òåãà. Èìÿ òåãà ÿâëÿåòñÿ ïðîñòî èìåíåì òåãà <strong>HTML</strong>, ò.å. <strong>'DIV'</strong>, <strong>'IMG'</strong>, <strong>'TABLE'</strong>, <strong>'A '</strong>è ò.ä.</p>
<p>Ñóùåñòâóåò åùå îäíî ñâîéñòâî, <strong>document.all</strong>, êîòîðîå âûäàåò ìàññèâ âñåõ ýëåìåíòîâ íà ñòðàíèöå. Îäíàêî <strong>document.all</strong> ïîääåðæèâàåòñÿ íå âñåìè áðàóçåðàìè, ïîýòîìó ïðåäïîëàãàåòñÿ, ÷òî âìåñòî ýòîãî èñïîëüçóåòñÿ ôóíêöèÿ <strong>document.getElementsByTagName('*')</strong>, êîòîðàÿ òàêæå âåðíåò âñå ýëåìåíòû íà ñòðàíèöå.</p>
<p><strong>document.body</strong> ññûëàåòñÿ íà òåã <strong>&lt;BODY&gt;</strong>, ãäå äîëæåí ïðåäïîëîæèòåëüíî íàõîäèòñÿ âåñü êîíòåíò. Âåñü <strong>DOM</strong> ñàéòà âëîæåí â <strong>document.body</strong>. Êðîìå ýòîãî, íåîáõîäèìî èñïîëüçîâàòü <strong>document.body</strong> äëÿ îïðåäåëåíèÿ, ÷òî äîêóìåíò áûë ïðîêðó÷åí, è äëÿ ïîëó÷åíèÿ ðàçìåðà îêíà. Ê ñîæàëåíèþ, ýòî ÿâëÿåòñÿ îäíîé èç íàèáîëåå ñëîæíûõ âåùåé, ïðèìåíÿåìûõ ñåãîäíÿ â Web-áðàóçåðàõ.</p>
<p>Ñóùåñòâóåò êîíöåïöèÿ, íàçûâàåìàÿ "Òèï äîêóìåíòà", êîòîðàÿ çàäàåò äëÿ Web-áðàóçåðà îïðåäåëåííûé íàáîð ïðàâèë. Èçìåíåíèå òèïà äîêóìåíòà çàñòàâëÿåò íåêîòîðûå ñâîéñòâà ïåðåìåñòèòüñÿ èç <strong>document.body</strong> â <strong>document.documentElement</strong>, íî òîëüêî íåêîòîðûå ñâîéñòâà è òîëüêî äëÿ íåêîòîðûõ áðàóçåðîâ.</p>
<p>Ïðîùå ãîâîðÿ, ýòî ÿâëÿåòñÿ ïîëíûì áåñïîðÿäêîì, ïîýòîìó äâå ñëåäóþùèå ôóíêöèè (áóäåì íàäåÿòüñÿ) âûäàäóò ïîçèöèþ ïðîêðó÷èâàíèÿ è ðàçìåðû îêíà íåçàâèñèìî îò áðàóçåðà.</p>
<empty-line/>
<p><code>function getScrollPos(){</code></p>
<p><code>if (window.pageYOffset){</code></p>
<p><code>return {y:window.pageYOffset, x:window.pageXOffset};</code></p>
<p><code>}</code></p>
<p><code>if(document.documentElement &amp;&amp; document.documentElement.scrollTop){</code></p>
<p><code>return {y:document.documentElement.scrollTop, x:document.documentElement.scrollLeft};</code></p>
<p><code>}</code></p>
<p><code>if(document.body){</code></p>
<p><code>return {y:document.body.scrollTop, x:document.body.scrollLeft};</code></p>
<p><code>}</code></p>
<p><code>return {x:0, y:0};</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function getWindowDims(){</code></p>
<p><code>if (window.innerWidth){</code></p>
<p><code>return {w:window.innerWidth, h:window.innerHeight};</code></p>
<p><code>}</code></p>
<p><code>if (document.documentElement &amp;&amp; document.documentElement.clientWidth){</code></p>
<p><code>return {w:document.documentElement.clientWidth, h:document.documentElement.cliendHeight};</code></p>
<p><code>}</code></p>
<p><code>if (document.body){</code></p>
<p><code>return {w:document.body.clientWidth, h:document.body.clientHeight};</code></p>
<p><code>}</code></p>
<p><code>return {w:0, h:0}</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Òðåìÿ ïîñëåäíèìè ñâîéñòâàìè äîêóìåíòà ÿâëÿþòñÿ <strong>title</strong>, <strong>referer</strong> è <strong>cookies</strong>. <strong>document.title</strong> è <strong>document.referer</strong> äîñòàòî÷íî ïîíÿòíû. <strong>document.title</strong> ñîäåðæèò çàãîëîâîê ñòðàíèöû. Åãî ìîæíî ïðî÷èòàòü è èçìåíèòü ïîñëå ïîëíîé çàãðóçêè äîêóìåíòà. <strong>document.referer</strong> ñîäåðæèò ïðîñòî <strong>URL</strong> ñòðàíèöû, êîòîðàÿ ïðèâåëà ïîëüçîâàòåëÿ íà òåêóùóþ ñòðàíèöó.</p>
<p>Ïîýòîìó, åñëè âû ùåëêíóëè íà ññûëêå, ÷òîáû ïîïàñòü íà ýòó ñòðàíèöó, òî <strong>document.referer</strong> áóäåò ñîäåðæàòü <strong>URL</strong> ñòðàíèöû, íà êîòîðîé íàõîäèòñÿ ññûëêà. Åñëè âû ïðèøëè íà ýòó ñòðàíèöó ñðàçó, çàäàâàÿ åå â ïîëå àäðåñà áðàóçåðà, òî <strong>document.referer</strong> áóäåò íå îïðåäåëåí.</p>
<p>Ïîñëåäíÿÿ òåìà ýòîé ëåêöèè, ïåðåìåííàÿ <strong>cookie</strong>, îòëè÷àåòñÿ îò âñåãî îñòàëüíîãî â <strong>JavaScript</strong>. <strong>cookie</strong> ÿâëÿåòñÿ ñòðîêîé òåêñòà, êîòîðóþ ìîæíî ñîõðàíèòü ñ îäíîé ñòðàíèöû íà äðóãîé, åñëè âû íàõîäèòåñü íà îäíîì è òîì æå ñåðâåðå. Â îòëè÷èå îò äðóãèõ ïåðåìåííûõ â <strong>JavaScript</strong>, <strong>cookie</strong> íå ñòèðàåòñÿ ïðè ïåðåçàãðóçêå ñòðàíèöû. <strong>cookie</strong> ñòèðàþòñÿ òîëüêî ÷åðåç îïðåäåëåííûé ïåðèîä âðåìåíè èëè êîãäà âñå <strong>cookie</strong> óäàëÿþòñÿ â áðàóçåðå.</p>
<p><strong>cookie</strong> ÷èòàþò è çàïèñûâàþò ÷åðåç <strong>document.cookie</strong>. Â îòëè÷èå îò äðóãèõ ñâîéñòâ èçìåíåíèå <strong>document.cookie</strong> â äåéñòâèòåëüíîñòè íå ïåðåçàïèñûâàåò, à äîáàâëÿåò ê <strong>cookie</strong>. Ïîýòîìó, åñëè òðåáóåòñÿ çàäàòü <strong>5 cookie</strong>, òî êàæäîå èç íèõ çàäàåòñÿ ñ ïîìîùüþ <strong>document.cookie="...";</strong>. Ôîðìàò <strong>cookie</strong> èìååò ñâîè îñîáåííîñòè, ïîýòîìó ìû ðàññìîòðèì íåñêîëüêî ôóíêöèé äëÿ âûïîëíåíèÿ ýòîé çàäà÷è:</p>
<empty-line/>
<p><code>function writeCookie(name, value, days){</code></p>
<p><code>if(days){</code></p>
<p><code>(time = new Date()).setTime(new Date().getTime()+days*24*60*60*1000);</code></p>
<p><code>var exp = '; expires='+time.toGMTString();</code></p>
<p><code>}else{</code></p>
<p><code>var exp='';</code></p>
<p><code>}</code></p>
<p><code>document.cookie=name+"="+value+exp+"; path=/";</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function readCookie(name){</code></p>
<p><code>var cookies = document.cookie.split(';');</code></p>
<p><code>for(var i=0; i&lt;cookies.length; i++){</code></p>
<p><code>var cookie=cookies[i].replace(/^\s+/, '');</code></p>
<p><code>if (cookie.indexOf(name+'=')==0) return cookie.substring(name.length+1);</code></p>
<p><code>}</code></p>
<p><code>return null;</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function eraseCookie(name){</code></p>
<p><code>writeCookie(name, "", -1);</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Òðè ýòè ôóíêöèè âûïîëíÿþò çàïèñü, ÷òåíèå è ñòèðàíèå <strong>cookie</strong> íà òåêóùåé ñòðàíèöå. Èõ ìîæíî ïðîòåñòèðîâàòü ñ ïîìîùüþ ñëåäóþùåãî êîäà:</p>
<empty-line/>
<p><code>function addToCounter(){</code></p>
<p><code>var counter = readCookie('myCounter');</code></p>
<p><code>if(counter){</code></p>
<p><code>counter = parseInt(counter);</code></p>
<p><code>} else {</code></p>
<p><code>counter = 0;</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>writeCookie('myCounter', counter+1, 1);</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function showCounter(){</code></p>
<p><code>alert(readCookie('myCounter'));</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Åñëè óâåëè÷èòü ñ÷åò÷èê <strong>cookie</strong> íåñêîëüêî ðàç, îáíîâèòü ñòðàíèöó, à çàòåì ïðîâåðèòü ñ÷åò÷èê, òî ìîæíî óâèäåòü, ÷òî îí îñòàëñÿ òàêèì æå, êàê áûë äî îáíîâëåíèÿ ñòðàíèöû. Ýòè <strong>cookie</strong> áóäóò ñîõðàíÿòñÿ äî òåõ ïîð, ïîêà îíè íå áóäóò óäàëåíû èç áðàóçåðà èëè ïîêà íå ïðîéäåò 24 ÷àñà – <strong>cookie</strong> çàäàíû íà ïåðèîä îäíè ñóòêè.</p>
<p>Ýòî ïî÷òè âñå îá îáúåêòàõ îêíà è äîêóìåíòà. Â ñëåäóþùåé ëåêöèè ðå÷ü ïîéäåò îá îáúåêòíî-îðèåíòèðîâàííîì êîäå.</p>
</section>
<section>
<title>
<p><emphasis>Ëåêöèÿ 8.</emphasis> Îñíîâû îáúåêòíî-îðèåíòèðîâàííîãî ïðîãðàììèðîâàíèÿ</p>
</title>
<p><emphasis>Îñíîâû îáúåêòíî-îðèåíòèðîâàííîãî ïðîãðàììèðîâàíèÿ (ÎÎÏ) â JavaScript. new Object è îáúåêòíûå ëèòåðàëû. Ïðîòîòèïèðîâàíèå. Ïåðåìåííûå Private, Public è Static.</emphasis></p>
<p>Ïî÷òè êàæäûé ñîâðåìåííûé ÿçûê ïðîãðàììèðîâàíèÿ èìååò íåêîòîðûé ìåòîä çàïèñè îáúåêòíî-îðèåíòèðîâàííîãî (ÎÎ) êîäà. Åñëè âû çíàêîìû ñ òàêèìè ÿçûêàìè, êàê <strong>C++</strong>, <strong>Java</strong>, <strong>VB</strong>, <strong>php</strong> èëè ïîäîáíûìè, òî äîëæíû áûòü çíàêîìû è ñî ñòðóêòóðîé <strong>Class</strong> ýòèõ ÿçûêîâ.</p>
<p>Êëàññû â ýòèõ ÿçûêàõ ïîçâîëÿþò áûñòðî ñîçäàâàòü îáúåêòû ñ îäèíàêîâûìè ñâîéñòâàìè è ìåòîäàìè, íå òðåáóÿ ïðè ýòîì çàíîâî îïðåäåëÿòü âñå ýòè ñâîéñòâà è ìåòîäû. Â òåðìèíàõ ñòðóêòóð ìû èìååì êëàññû, à âíóòðè ýòèõ êëàññîâ – ôóíêöèè è ïåðåìåííûå, à âíóòðè êàæäîé èç ýòèõ ôóíêöèé – äîïîëíèòåëüíûå ïåðåìåííûå. Êàæäàÿ ôóíêöèÿ â êëàññå èäåàëüíî ðàáîòàåò ñ ïåðåìåííûìè è äðóãèìè ôóíêöèÿìè, âíóòðåííèìè äëÿ ýòîãî êëàññà.</p>
<p>Ñòðóêòóðà <strong>Class</strong> è îáúåêòû â öåëîì õîðîøî ðàáîòàþò ïîòîìó, ÷òî îíè äåéñòâóþò êàê ðåàëüíûå îáúåêòû. Íàïðèìåð, ìû ìîæåì èìåòü êëàññ <strong>Òåëåâèçîð</strong>. Òàê êàê âñå òåëåâèçîðû â öåëîì ðàáîòàþò îäèíàêîâî, òî íåò íåîáõîäèìîñòè ïåðåîïðåäåëÿòü ìíîæåñòâî àòðèáóòîâ òåëåâèçîðà, ÷òîáû ñäåëàòü åùå îäèí íîâûé. Ýòîò êëàññ áóäåò îïðåäåëÿòü ìåòîäû è ñâîéñòâà òåëåâèçîðà. Ìû áóäåì èìåòü òàêèå ñâîéñòâà, êàê ìàðêà, ðàçìåð ýêðàíà, è ò.ä., è ìåòîäû, òàêèå, êàê âêëþ÷èòü/âûêëþ÷èòü, ñìåíèòü êàíàë, è ò.ä.</p>
<p><strong>JavaScript</strong> ñëåãêà îòëè÷àåòñÿ îò ñòàíäàðòíîé îáúåêòíî-îðèåíòèðîâàííîé ñòðóêòóðû <strong>Class</strong>. Âìåñòî èñïîëüçîâàíèÿ êëàññîâ äëÿ ñîçäàíèÿ îáúåêòîâ, êàæäàÿ ôóíêöèÿ â <strong>JavaScript</strong> ìîæåò ýôôåêòèâíî äåéñòâîâàòü êàê êëàññ. Ìû èñïîëüçóåì êîíöåïöèþ âëîæåííûõ ôóíêöèé, íàçûâàåìóþ ïðîòîòèïèðîâàíèåì (<strong>Prototyping</strong>), äëÿ âûïîëíåíèÿ òàêèõ æå âåùåé, êàê è ÿçûêè ñî ñòðóêòóðàìè <strong>Class</strong>. Åñëè âû çíàêîìû ñ ÎÎ-ÿçûêîì íà îñíîâå êëàññîâ, òî ïðîòîòèïèðîâàíèå ìîæåò ïîêàçàòüñÿ ñíà÷àëà íåïðèâû÷íîé êîíöåïöèåé, íî îíà ïðåäëàãàåò áîëüøèå âîçìîæíîñòè è ÷àñòî ÿâëÿåòñÿ çíà÷èòåëüíî áîëåå ãèáêîé ñ òî÷êè çðåíèÿ ïðîãðàììèðîâàíèÿ, ÷åì äðóãèå ìåòîäû.</p>
<p>Äëÿ íà÷àëà íåîáõîäèìî îáúÿñíèòü, êàê îáúåêòû äåéñòâóþò â <strong>JavaScript</strong>. Îáúåêòû ïîçâîëÿþò îïðåäåëèòü ïåðåìåííóþ è çàäàòü çàòåì äëÿ ýòîé ïåðåìåííîé ëþáîå ÷èñëî ñâîéñòâ. ×òîáû ïîíÿòü ýòî, äàâàéòå ïîñìîòðèì íà ïðîñòîé ïðèìåð:</p>
<empty-line/>
<p><code>var myObj = new Object;</code></p>
<p><code>myObj.a = 5;</code></p>
<p><code>myObj['b'] = 10;</code></p>
<p><code>myObj.c = 20;</code></p>
<p><code>myObj.getTotal = function(){</code></p>
<p><code>alert(this.a+this.b+this.c);</code></p>
<p><code>};</code></p>
<empty-line/>
<p><code>// èëè</code></p>
<empty-line/>
<p><code>var myObj = {a:5, b:10, c:20,</code></p>
<p><code>getTotal:function() { alert(this.a+this.b+this.c); }};</code></p>
<empty-line/>
<p>Îáà ýòè ôðàãìåíòà êîäà ñîçäàþò îäíó è òó æå ïåðåìåííóþ <strong>myObj</strong>. Ïåðâûé ïðèìåð èñïîëüçóåò ñèíòàêñèñ <strong>new Object()</strong>, à çàòåì îïðåäåëÿåò âñå ñâîéñòâà îäíî çà äðóãèì. Âòîðîé ôðàãìåíò êîäà ÿâëÿåòñÿ ñîêðàùåííîé íîòàöèåé, êîòîðàÿ äåëàåò â òî÷íîñòè òî æå ñàìîå. Ìû èìååì òåïåðü ïåðåìåííóþ <strong>myObj</strong>. <strong>myObj</strong> ñîäåðæèò òðè ïåðåìåííûå äëÿ öåëûõ ÷èñåë: <strong>a</strong>, <strong>b</strong> è <strong>c</strong>. Äëÿ äîñòóïà ê ëþáîé èç íèõ ìû ïðîñòî èñïîëüçóåì <strong>myObj.a</strong> èëè <strong>myObj['a']</strong>. Ìîæíî âèäåòü, ÷òî <strong>myObj</strong> èìååò òàêæå â êà÷åñòâå ñâîéñòâà ôóíêöèþ <strong>getTotal</strong>. Ìû îáðàùàåìñÿ ê <strong>getTotal</strong> òàêèì æå îáðàçîì, êàê è ê ñâîéñòâàì <strong>a</strong>, <strong>b</strong> è <strong>c</strong>: <strong>myObj.getTotal()</strong>. Ôóíêöèÿ <strong>getTotal()</strong> îáðàùàåòñÿ ê ïåðåìåííûì â ïåðåìåííîé <strong>myObj</strong> ñ ïîìîùüþ <strong>this</strong>. Ïðè âûïîëíåíèè êîäà âíóòðè ôóíêöèè â îáúåêòå <strong>this</strong> ññûëàåòñÿ íà îáúåêò. Â äàííîì ñëó÷àå <strong>this</strong> ññûëàåòñÿ íà ñàì îáúåêò <strong>myObj</strong>.</p>
<p>Êàê ìîæíî âèäåòü, îáúåêòû â <strong>JavaScript</strong> ÿâëÿþòñÿ ÷ðåçâû÷àéíî ïîëåçíûìè. Ê ñîæàëåíèþ, ÷àñòî ïðèõîäèòñÿ îáúÿâëÿòü ñëèøêîì ìíîãî èíôîðìàöèè êàæäûé ðàç, êîãäà ìû õîòèì ñîçäàòü îáúåêò. Íàïðèìåð, äàâàéòå ñîçäàäèì îáúåêò <strong>Animal</strong>:</p>
<empty-line/>
<p><code>var myAnimal = {</code></p>
<p><code>name: 'felix',</code></p>
<p><code>species: 'cat',</code></p>
<p><code>talk: function(){ alert('Meow!'); },</code></p>
<p><code>callOver: function(){ alert(this.name+' ignores you'); },</code></p>
<p><code>pet: function(){ alert('Purr!'); }</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Ìû èìååì ïåðåìåííóþ <strong>myAnimal</strong>, êîòîðàÿ ïðåäñòàâëÿåò êîòà (<strong>cat</strong>) ñ èìåíåì <strong>Ôåëèêñ</strong> (<strong>felix</strong>). Îäíàêî, åñëè ïîòðåáóåòñÿ ñîçäàòü äðóãîãî êîòà, íàì ïîíàäîáèòüñÿ ââåñòè âñå ýòî ñíîâà. Çäåñü íà ïîìîùü ïðèõîäèò îáúåêòíî-îðèåíòèðîâàííûé ïîäõîä. Âìåñòî ïåðåïå÷àòêè âñÿêèé ðàç âñåãî îáúåêòà ìîæíî îïðåäåëèòü ôóíêöèþ, êîòîðàÿ ñîçäàåò äëÿ íàñ àíàëîãè÷íûé îáúåêò:</p>
<empty-line/>
<p><code>function Cat(name){</code></p>
<p><code>this.name = name;</code></p>
<empty-line/>
<p><code>this.species = 'Cat';</code></p>
<p><code>this.talk = function(){ alert('Meow!'); }</code></p>
<p><code>this.callOver = function(){ alert(this.name+' ignores you'); },</code></p>
<p><code>this.pet = function(){ alert('Purr!'); }</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>var felix = new Cat('Felix');</code></p>
<p><code>var sam = new Cat('Sam');</code></p>
<p><code>var patty = new Cat('Patty');</code></p>
<empty-line/>
<p><code>felix.pet(); // âûâîäèò 'Purr!'</code></p>
<p><code>sam.callOver(); // âûâîäèò 'Sam ignores you'. Ïðîñòî, êàê êîò!</code></p>
<p><code>alert(patty.species); // âûâîäèò 'Cat'</code></p>
<empty-line/>
<p>Â ýòîì ïðèìåðå ñîçäàíà îäíà ôóíêöèÿ <strong>Cat</strong>, à çàòåì ñîçäàþòñÿ òðè íîâûõ êîòà ñ ïîìîùüþ ýòîé ôóíêöèè: <strong>Felix</strong>, <strong>Sam</strong> è <strong>Patty</strong>. Êàæäûé èç ýòèõ êîòîâ èìååò îäèíàêîâûå ôóíêöèè: <strong>talk</strong>, <strong>callOver</strong> è <strong>pet</strong>, è êàæäàÿ èç íèõ èìååò ñâîéñòâî <strong>species</strong>, çàäàííîå êàê <strong>'cat'</strong>. È ïîäîáíî âñåì êîòàì, îíè â ðàâíîé ñòåïåíè ñâîåíðàâíû.</p>
<p>Îáû÷íî ãîâîðÿò, ÷òî <strong>felix</strong>, <strong>sam</strong> è <strong>patty</strong> ÿâëÿþòñÿ ýêçåìïëÿðàìè îäíîãî îáúåêòà: <strong>Cat</strong>. Êîä ñàìîé ôóíêöèè <strong>Cat</strong> íàçûâàåòñÿ êîíñòðóêòîðîì. Ìû ïåðåäàåì åé ïåðåìåííóþ <strong>name</strong> è èñïîëüçóåì åå äëÿ çàäàíèÿ <strong>this.name</strong>. Ê ñîæàëåíèþ, ïðè îáúÿâëåíèè êàæäîé ôóíêöèè <strong>Cat</strong> â êîíñòðóêòîðå â äåéñòâèòåëüíîñòè ñîçäàåòñÿ íîâàÿ êîïèÿ êàæäîé ôóíêöèè âñÿêèé ðàç ïðè ñîçäàíèè íîâîãî <strong>Cat</strong>. Òàê êàê ôóíêöèè <strong>talk</strong>, <strong>callOver</strong> è <strong>pet</strong> ÿâëÿþòñÿ èäåíòè÷íûìè, òî íàì â äåéñòâèòåëüíîñòè òðåáóåòñÿ òîëüêî îäíà êîïèÿ êàæäîé ôóíêöèè. Çäåñü íà ïîìîùü ïðèõîäèò ïðîòîòèïèðîâàíèå.</p>
<p>Ìîæíî ïåðåïèñàòü ôóíêöèþ <strong>Cat</strong> òàêèì îáðàçîì, ÷òîáû êàæäàÿ ôóíêöèÿ îáúÿâëÿëàñü òîëüêî îäèí ðàç:</p>
<empty-line/>
<p><code>function Cat(name){</code></p>
<p><code>this.name = name;</code></p>
<p><code>}</code></p>
<p><code>Cat.prototype.species = 'Cat';</code></p>
<p><code>Cat.prototype.talk = function(){ alert('Meow!'); };</code></p>
<p><code>Cat.prototype.callOver = function(){ alert(this.name+' ignores you'); };</code></p>
<p><code>Cat.prototype.pet = function(){ alert('Purr!'); };</code></p>
<empty-line/>
<p>Ñèíòàêñèñ ýòîãî ìåòîäà íåìíîãî îòëè÷àåòñÿ îò ïðåäûäóùåãî. Âìåñòî îáúÿâëåíèÿ âñåõ ñâîéñòâ è ìåòîäîâ âíóòðè ôóíêöèè <strong>Cat</strong>, îíè òåïåðü îáúÿâëÿþòñÿ ñ ïîìîùüþ <strong>Cat.prototype</strong>. Ýòî ìîæåò ïîêàçàòüñÿ áîëåå ñëîæíûì, íî ïðåäëàãàåò ìíîãî ïðåèìóùåñòâ. Ïðåäïîëîæèì, íàïðèìåð, ÷òî íàäî äîáàâèòü íîâóþ ôóíêöèþ <strong>sleep</strong> äëÿ êàæäîãî èìåþùåãîñÿ <strong>cat</strong>. Ýòî ìîæíî ñäåëàòü äâóìÿ ñïîñîáàìè. Ïåðâûé: ìîæíî äîáàâèòü ôóíêöèþ <strong>sleep</strong> â <strong>felix</strong>, <strong>sam</strong> è <strong>patty</strong>. Ýòî, îäíàêî, íå òîëüêî òðóäîåìêî, íî òàêæå è íåýôôåêòèâíî. Åñëè áû èìåëîñü <strong>500 cat</strong>, òî ïîòðåáîâàëîñü áû ñíà÷àëà îòñëåäèòü âñåõ ýòèõ <strong>500</strong> êîòîâ, à çàòåì äîáàâèòü ôóíêöèþ êàæäîìó <strong>cat</strong>.</p>
<p>Îäíàêî ñ ïîìîùüþ ïðîòîòèïîâ ìîæíî äîáàâèòü ôóíêöèþ <strong>sleep</strong> âñåì <strong>cat</strong> îäíîâðåìåííî:</p>
<empty-line/>
<p><code>Cat.prototype.sleep = function(){ alert(this.name+' falls asleep'); };</code></p>
<empty-line/>
<p>Ýòîò ñïîñîá íå òîëüêî áûñòðåå, íî ê òîìó æå íàì áîëüøå íå òðåáóåòñÿ îòñëåæèâàòü êàæäîãî <strong>cat</strong>, ÷òîáû äîáàâèòü ôóíêöèþ <strong>sleep</strong>.</p>
<p>Ñóùåñòâóåò áîëåå áûñòðûé ñïîñîá äîáàâëåíèÿ ïðîòîòèïîâ. Ñ ïîìîùüþ îáúåêòíîãî ëèòåðàëà ìîæíî îäíîâðåìåííî çàäàòü ëþáîå êîëè÷åñòâî ïðîòîòèïîâ ñâîéñòâ èëè ìåòîäîâ.</p>
<empty-line/>
<p><code>function Cat(name){</code></p>
<p><code>this.name = name;</code></p>
<p><code>}</code></p>
<p><code>Cat.prototype = {</code></p>
<p><code>species: 'Cat',</code></p>
<p><code>talk: function(){ alert('Meow!'); },</code></p>
<p><code>callOver: function(){ alert(this.name+' ignores you'); },</code></p>
<p><code>pet: function(){ alert('Pet!'); }</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Âàæíî îòìåòèòü, ÷òî ñ ïîìîùüþ ýòîãî ìåòîäà ìîæíî çàäàòü ñâîéñòâà ôóíêöèè òîëüêî îäèí ðàç. Ïîñëå ýòîãî íåîáõîäèìî èñïîëüçîâàòü ïðåäûäóùèé ìåòîä.</p>
<empty-line/>
<p><code>Object.prototype.method = function(){ ... }.</code></p>
<empty-line/>
<p>Åñëè ïîïðîáîâàòü òåïåðü äîáàâèòü â <strong>cat</strong> ìåòîä <strong>sleep</strong> ñ ïîìîùüþ ýòîãî ìåòîäà:</p>
<empty-line/>
<p><code>Cat.prototype = {</code></p>
<p><code>sleep: function(){ alert(this.name+' falls asleep'); }</code></p>
<p><code>}</code></p>
<empty-line/>
<p>òî ïðåäûäóùèå ïðîòîòèïû, <strong>species</strong>, <strong>talk</strong>, <strong>callOver</strong> è <strong>pet</strong>, áóäóò âñå óäàëåíû. Åäèíñòâåííûì èìåþùèìñÿ ïðîòîòèïîì äëÿ <strong>cat</strong> áóäåò <strong>sleep</strong>.</p>
<p>Ïðîòîòèïû ìîæíî òàêæå èñïîëüçîâàòü äëÿ ðàñøèðåíèÿ âñòðîåííûõ îáúåêòîâ <strong>JavaScript</strong>. Ìîæíî ðåàëèçîâàòü, íàïðèìåð, ôóíêöèþ <strong>String.prototype.reverse</strong>, êîòîðàÿ áóäåò âîçâðàùàòü ëþáóþ ñîçäàííóþ ñòðîêó â îáðàòíîì ïîðÿäêå:</p>
<empty-line/>
<p><code>String.prototype.reverse = function(){</code></p>
<p><code>var out = '';</code></p>
<p><code>for(var i=this.length-1; i&gt;=0; i--){</code></p>
<p><code>out+=this.substr(i, 1);</code></p>
<p><code>}</code></p>
<p><code>return out;</code></p>
<p><code>}</code></p>
<p><code>alert('asdf'.reverse());</code></p>
<empty-line/>
<p>Ýòî ìîæåò áûòü î÷åíü ïîëåçíûì èíñòðóìåíòîì ïðè ïðàâèëüíîì èñïîëüçîâàíèè. Ìîæíî ðåàëèçîâàòü <strong>String.prototype.trim()</strong> äëÿ óäàëåíèÿ èç ñòðîêè âñåõ ïðîáåëîâ, <strong>Date.prototype.dayName</strong> – äëÿ ïîëó÷åíèÿ íàçâàíèÿ äíÿ íåäåëè èç îáúåêòà <strong>Date</strong> è ò.ä. Îäíàêî íàñòîÿòåëüíî ðåêîìåíäóåòñÿ âîçäåðæàòüñÿ îò äîáàâëåíèÿ êàêèõ-ëèáî ïðîòîòèïîâ â <strong>Array</strong> èëè <strong>Object</strong>, òàê êàê â ýòîì ñëó÷àå öèêëû <strong>for-in</strong> äëÿ äâóõ ýòèõ òèïîâ äàííûõ áóäóò ðàáîòàòü íåïðàâèëüíî. Ðàññìîòðèì ñëåäóþùèé ïðèìåð:</p>
<empty-line/>
<p><code>var myArray = [1, 2, 3];</code></p>
<p><code>for(n in myArray) alert(n); // âûâîäèò 0, 1 è 2 – èíäåêñû ìàññèâà.</code></p>
<empty-line/>
<p><code>Array.prototype.something = function(){ };</code></p>
<empty-line/>
<p><code>for(n in myArray) alert(n); // âûâîäèò 'something', 0, 1 è 2.</code></p>
<empty-line/>
<p>Êàê ìîæíî âèäåòü, çäåñü âûïîëíåíî ïðîòîòèïèðîâàíèå <strong>Array</strong> è äîáàâëåíà ôóíêöèÿ <strong>something</strong>. Îäíàêî òåïåðü ýòà ôóíêöèÿ <strong>something</strong> âèäíà êàê ýëåìåíò ìàññèâà, ðåçóëüòàò, êîòîðûé îïðåäåëåííî íå îæèäàëñÿ è íå òðåáîâàëñÿ. Òî æå ñàìîå ïðîèñõîäèò ñ îáúåêòàìè è îáúåêòíûìè ëèòåðàëàìè, åñëè âûïîëíèòü ïðîòîòèïèðîâàíèå <strong>Object</strong>. Åñëè ìîæíî áûòü àáñîëþòíî óâåðåííûì, ÷òî öèêë <strong>for-in</strong> íèêîãäà íå áóäåò èñïîëüçîâàòüñÿ è íèêàêîé äðóãîé ðàçðàáîò÷èê íå áóäåò èñïîëüçîâàòü ýòîò êîä <strong>JavaScript</strong>, òî ìîæíî ïðèìåíÿòü ïðîòîòèïèðîâàíèå äëÿ <strong>Array</strong> èëè <strong>Object</strong>, íî íàäî ïîìíèòü î ñâÿçàííûõ ñ ýòèì ïðîáëåìàõ. Îäíàêî ñóùåñòâóþò äðóãèå ìåòîäû äëÿ äîñòèæåíèÿ òåõ æå ðåçóëüòàòîâ. Íàïðèìåð, äëÿ ðàñøèðåíèÿ <strong>Array</strong> ìîæíî çàäåéñòâîâàòü ñëåäóþùèé ìåòîä áåç ïðîòîòèïèðîâàíèÿ:</p>
<empty-line/>
<p><code>Array.find = function(ary, element){</code></p>
<p><code>for(var i=0; i&lt;ary.length; i++){</code></p>
<p><code>if(ary[i] == element){</code></p>
<p><code>return i;</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<p><code>return -1;</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>alert(Array.find(['a', 'b', 'c', 'd', 'e'], 'b')); // âûâîäèò 1</code></p>
<empty-line/>
<p>Êàê ìîæíî âèäåòü, òåïåðü íåîáõîäèìî ïå÷àòàòü <strong>Array.find(ary, e)</strong> âìåñòî <strong>ary.find(e)</strong>, ÷òî ïðèøëîñü áû äåëàòü, åñëè ïðîòîòèïèðîâàòü îáúåêò <strong>Array</strong>, íî ñòîèò íàïå÷àòàòü ýòè íåñêîëüêî äîïîëíèòåëüíûõ ñèìâîëîâ, ÷òîáû èçáåæàòü ïîòåðè ñóùåñòâóþùåé ôóíêöèîíàëüíîñòè <strong>JavaScript</strong>.</p>
<p>Ñïîñîá îïðåäåëåíèÿ ïåðåìåííûõ â îáúåêòå îïðåäåëÿåò, êàêèå ìåòîäû ýòîãî îáúåêòà ìîæíî èñïîëüçîâàòü äëÿ äîñòóïà ê ýòèì ïåðåìåííûì. Â <strong>JavaScript</strong> ïðè ðàáîòå ñ îáúåêòíî-îðèåíòèðîâàííûì êîäîì èñïîëüçóåòñÿ ïÿòü óðîâíåé ìåòîäîâ è ñâîéñòâ.</p>
<p><strong>1</strong> Ñêðûòàÿ (<strong>Private</strong>) – îáúÿâëÿåòñÿ ñ ïîìîùüþ <strong>var variableName</strong> èëè <strong>function functionName</strong> âíóòðè îáúåêòà. Ìîãóò áûòü äîñòóïíû òîëüêî äðóãèì ñêðûòûì èëè ïðèâèëåãèðîâàííûì ôóíêöèÿì.</p>
<p><strong>2</strong> Îòêðûòàÿ (<strong>Public</strong>) – îáúÿâëÿåòñÿ ñ ïîìîùüþ <strong>this.variableName</strong> âíóòðè îáúåêòà. Ìîæåò èçìåíÿòüñÿ ëþáîé ôóíêöèåé èëè ìåòîäîì.</p>
<p><strong>3</strong> Ïðèâèëåãèðîâàííàÿ (<strong>Privileged</strong>) – îáúÿâëÿåòñÿ ñ ïîìîùüþ <strong>this.functionName = function(){ ... }</strong> âíóòðè îáúåêòà. Äîñòóïíà äëÿ ëþáîé ôóíêöèè èëè ìåòîäà è ìîæåò îáðàùàòüñÿ èëè èçìåíÿòü ëþáóþ ñêðûòóþ ïåðåìåííóþ.</p>
<p><strong>4</strong> Ïðîòîòèïèðîâàííàÿ (<strong>Prototype</strong>) – îáúÿâëÿåòñÿ ñ ïîìîùüþ <strong>Class.prototype.variableName</strong> èëè <strong>Class.prototype.functionName</strong>. Îáúÿâëåííûå òàêèì îáðàçîì ôóíêöèè áóäóò èìåòü äîñòóï ê ëþáîé îòêðûòîé èëè ïðîòîòèïèðîâàííîé ôóíêöèè. Ïîïûòêè èçìåíèòü ñîçäàííóþ òàêèì îáðàçîì ïåðåìåííóþ áóäóò âìåñòî ýòîãî ñîçäàâàòü íîâóþ îòêðûòóþ ïåðåìåííóþ íà îáúåêòå, à ïðîòîòèïèðîâàííàÿ ïåðåìåííàÿ áóäåò íåäîñòóïíà.</p>
<p><strong>5</strong> Ñòàòè÷åñêàÿ (<strong>Static</strong>) – îáúÿâëÿåòñÿ ñ ïîìîùüþ <strong>Class.variableName</strong> èëè <strong>Class.functionName</strong>. Ìîæåò èçìåíÿòüñÿ ëþáîé ôóíêöèåé èëè ìåòîäîì. Òàêîé ìåòîä èñïîëüçóåòñÿ ðåäêî.</p>
<p>×òîáû ïîíÿòü ðàçëè÷èÿ ìåæäó óðîâíÿìè, äàâàéòå ðàññìîòðèì ïðèìåð:</p>
<empty-line/>
<p><code>function Cat(name, color){</code></p>
<p><code>/*</code></p>
<p><code>Êîíñòðóêòîð: ïðè ñîçäàíèè îáúåêòà âûïîëíÿåòñÿ ëþáîé íàõîäÿùèéñÿ çäåñü êîä</code></p>
<p><code>*/</code></p>
<p><code>Cat.cats++;</code></p>
<empty-line/>
<p><code>/* Ñêðûòûå ïåðåìåííûå è ôóíêöèè äîñòóïíû òîëüêî ñêðûòûì èëè ïðèâèëåãèðîâàííûì</code></p>
<p><code>ôóíêöèÿì. Îòìåòèì, ÷òî 'name' è 'color', ïåðåäàííûå â Class, óæå ÿâëÿþòñÿ</code></p>
<p><code>ñêðûòûìè ïåðåìåííûìè.</code></p>
<p><code>*/</code></p>
<empty-line/>
<p><code>var age = 0;</code></p>
<p><code>var legs = 4;</code></p>
<p><code>function growOlder(){</code></p>
<p><code>age++;</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>/*</code></p>
<p><code>Îòêðûòûå ïåðåìåííûå äîñòóïíû îòêðûòî èëè ñêðûòî</code></p>
<p><code>*/</code></p>
<empty-line/>
<p><code>this.weight = 1;</code></p>
<p><code>this.length = 5;</code></p>
<empty-line/>
<p><code>/*</code></p>
<p><code>Ïðèâèëåãèðîâàííûå ôóíêöèè äîñòóïíû îòêðûòî èëè ñêðûòî.</code></p>
<p><code>Ìîãóò îáðàùàòüñÿ ê ñêðûòûì ïåðåìåííûì.</code></p>
<empty-line/>
<p><code>Íåâîçìîæíî èçìåíèòü, ìîæíî òîëüêî çàìåíèòü îòêðûòîé âåðñèåé</code></p>
<p><code>*/</code></p>
<empty-line/>
<p><code>this.age = function(){</code></p>
<p><code>if(age==0) this.length+=20;</code></p>
<empty-line/>
<p><code>growOlder();</code></p>
<p><code>this.weight++;</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>/*</code></p>
<p><code>Ïðîòîòèïèðîâàííûå ôóíêöèè äîñòóïíû îòêðûòî</code></p>
<p><code>*/</code></p>
<p><code>Cat.prototype = {</code></p>
<p><code>talk: function(){ alert('Meow!'); },</code></p>
<p><code>callOver: function(){ alert(this.name+' ignores you'); },</code></p>
<p><code>pet: function(){ alert('Pet!'); }</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>/*</code></p>
<p><code>Ïðîòîòèïèðîâàííûå ïåðåìåííûå äîñòóïíû îòêðûòî.</code></p>
<p><code>Íåëüçÿ ïåðåçàïèñàòü, òîëüêî çàìåíèòü îòêðûòîé âåðñèåé</code></p>
<p><code>*/</code></p>
<empty-line/>
<p><code>Cat.prototype.species = 'Cat';</code></p>
<empty-line/>
<p><code>/*</code></p>
<p><code>Ñòàòè÷åñêèå ïåðåìåííûå è ôóíêöèè äîñòóïíû îòêðûòî</code></p>
<p><code>*/</code></p>
<empty-line/>
<p><code>Cat.cats = 0;</code></p>
<empty-line/>
<p>Ìû âèäèì, ÷òî ñóùåñòâóåò íåñêîëüêî óðîâíåé äîñòóïà. Êàê áûëî ñêàçàíî ðàíåå, âñå ñêðûòûå, ïðèâèëåãèðîâàííûå è îòêðûòûå ôóíêöèè è ïåðåìåííûå êîïèðóþòñÿ âñÿêèé ðàç, êîãäà ñîçäàåòñÿ íîâûé ýêçåìïëÿð îáúåêòà. Îáû÷íî ïî÷òè âñå, ÷òî íóæíî ñäåëàòü, ìîæíî ðåàëèçîâàòü ñ ïîìîùüþ ïðîòîòèïèðîâàííûõ è îòêðûòûõ ïåðåìåííûõ. Â ñâÿçè ñ ýòèì îáû÷íî ëó÷øå èçáåãàòü èñïîëüçîâàíèÿ ñêðûòûõ, ïðèâèëåãèðîâàííûõ è ñòàòè÷åñêèõ ïåðåìåííûõ, åñëè ýòî íå òðåáóåòñÿ ñïåöèàëüíî.</p>
</section>
<section>
<title>
<p><emphasis>Ëåêöèÿ 9.</emphasis> Íàñëåäîâàíèå è çàìûêàíèå</p>
</title>
<p><emphasis>Ìåòîä íàñëåäîâàíèÿ. Ïîëåçíûå (è îïàñíûå) ñâîéñòâà çàìûêàíèÿ.</emphasis></p>
<p>Â âîñüìîé ëåêöèè áûëè ðàññìîòðåíû îñíîâû îáúåêòíî-îðèåíòèðîâàííîãî ïðîãðàììèðîâàíèÿ â <strong>JavaScript</strong>. Â äàííîé ëåêöèè ýòà òåìà áóäåò ïðîäîëæåíà ðàññìîòðåíèåì ìåòîäîâ íàñëåäîâàíèÿ, à òàêæå ïîëåçíûõ (è îïàñíûõ) ñâîéñòâ çàìûêàíèÿ.</p>
<p>Â ïðåäûäóùåé ëåêöèè áûëà ñîçäàíà ôóíêöèÿ <strong>'Cat'</strong> :</p>
<empty-line/>
<p><code>function Cat(name){</code></p>
<p><code>this.name = name;</code></p>
<p><code>}</code></p>
<p><code>Cat.prototype = {</code></p>
<p><code>species: 'Cat',</code></p>
<p><code>talk: function(){ alert('Meow!'); },</code></p>
<p><code>callOver: function(){ alert(this.name+' ignores you'); },</code></p>
<p><code>pet: function(){ alert('Pet!'); }</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Òåïåðü ìîæíî ñîçäàòü ëþáîå êîëè÷åñòâî êîòîâ, íî êàê áûòü, åñëè ìû çàõîòèì ñîçäàòü îáúåêò äðóãîãî òèïà, íàïðèìåð, ñîáàêó? Â ýòîì ñëó÷àå ïîíàäîáèòñÿ ñîçäàòü ñîâåðøåííî íîâóþ ôóíêöèþ, ñî ñâîèìè ñîáñòâåííûìè ïðîòîòèïàìè. Åñëè äâà îáúåêòà èñïîëüçóþò îäíè è òå æå ôóíêöèè (íàïðèìåð, ìîæíî áûëî áû äîáàâèòü ôóíêöèè <strong>sleep</strong> (ñïàòü), <strong>eat</strong> (åñòü), è <strong>play</strong> (èãðàòü)), òî â ðåçóëüòàòå ìû áû èìåëè ÷ðåçìåðíîå äóáëèðîâàíèå êîäà. Ðåøåíèåì ÿâëÿåòñÿ êîíöåïöèÿ íàñëåäîâàíèÿ.</p>
<p>Ïî ñóòè íàñëåäîâàíèå ïîçâîëÿåò îïðåäåëèòü îáúåêòû "ïðåäêè" è "ïîòîìêè". Ïîòîìîê íàñëåäóåò âñå ñâîéñòâà ñâîåãî ïðåäêà. Ìîæíî áûëî ñîçäàòü, íàïðèìåð, ôóíêöèþ <strong>Animal</strong>, <strong>Pet</strong> èëè <strong>Mammal</strong>. Îáå ôóíêöèè <strong>Cat</strong> è <strong>Dog</strong> îáëàäàëè áû ìíîãèìè ñâîéñòâàìè ôóíêöèè ïðåäêà <strong>Animal</strong>, è íàì ïðèøëîñü áû ïèñàòü ýòîò êîä îäèí ðàç.</p>
<p>Ïðîáëåìà â òîì, ÷òî <strong>JavaScript</strong> íå èìååò â äåéñòâèòåëüíîñòè âñòðîåííîãî ìåõàíèçìà íàñëåäîâàíèÿ, ïîýòîìó ýòó ôóíêöèîíàëüíîñòü íåîáõîäèìî ñîçäàâàòü ñàìîñòîÿòåëüíî. Äëÿ ýòîãî ñóùåñòâóåò íåñêîëüêî ðàçëè÷íûõ ñïîñîáîâ. Îäèí èç íèõ ñîñòîèò â èñïîëüçîâàíèè ôóíêöèè <strong>call</strong>. Ýòà ôóíêöèÿ ïîçâîëÿåò âûçûâàòü îäíó ôóíêöèþ èç êîíòåêñòà äðóãîé, ò.å. ìû ìîæåì îïðåäåëèòü, êàê äåéñòâóåò êëþ÷åâîå ñëîâî <strong>this</strong>. Ñ ïîìîùüþ <strong>call</strong> ìîæíî íàïèñàòü êëàññ <strong>Animal</strong> (Æèâîòíîå), à çàòåì âûçâàòü åãî èç êëàññà <strong>Cat</strong> èëè <strong>Dog</strong>.</p>
<empty-line/>
<p><code>function Animal(name){</code></p>
<p><code>this.name = name;</code></p>
<empty-line/>
<p><code>this.species = 'Animal';</code></p>
<p><code>this.sleep = function(){ alert(this.name+' ñïèò: Õðððð'); }</code></p>
<p><code>}</code></p>
<p><code>function Cat(name){</code></p>
<p><code>Animal.call(this, name);</code></p>
<empty-line/>
<p><code>this.talk = function(){ alert('Ìÿó!'); }</code></p>
<p><code>}</code></p>
<p><code>function Dog(name){</code></p>
<p><code>Animal.call(this, name);</code></p>
<empty-line/>
<p><code>this.talk = function(){ alert('Ãàâ!'); }</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>var sam = new Cat('Sam');</code></p>
<p><code>var joe = new Dog('Joe');</code></p>
<p><code>sam.sleep(); // Sam ñïèò: Õðððð</code></p>
<p><code>joe.sleep(); // Joe ñïèò: Õðððð</code></p>
<empty-line/>
<p><code>sam.talk(); // Ìÿó!</code></p>
<p><code>joe.talk(); // Ãàâ!</code></p>
<empty-line/>
<p>Õîòÿ ýòî ðàáîòàåò, ìû íåìíîãî îãðàíè÷åíû â ñâîèõ âîçìîæíîñòÿõ. Íàïðèìåð, ïðîòîòèïèðîâàíèå íå äåéñòâóåò ïðè èñïîëüçîâàíèè ýòîãî ìåòîäà: âñå ïðîòîòèïû, çàäàííûå íà <strong>Animal</strong>, íå áóäóò ïåðåíîñèòüñÿ â ôóíêöèè <strong>Cat</strong> èëè <strong>Dog</strong>. Êàê ìû çíàåì èç ïðåäûäóùåé ëåêöèè, îïðåäåëåííûå âíóòðåííå ñ ïîìîùüþ "<strong>this.</strong>" ôóíêöèè ñîçäàþò íîâûé ýêçåìïëÿð âñÿêèé ðàç ïðè ñîçäàíèè íîâîé êîïèè ïðåäêà. Â ýòîì ñëó÷àå âñÿêèé ðàç ïðè ñîçäàíèè ôóíêöèè <strong>Animal</strong>, <strong>Cat</strong> èëè <strong>Dog</strong> ïîÿâëÿåòñÿ íîâàÿ êîïèÿ ôóíêöèé <strong>species</strong> è <strong>sleep</strong>. Êàê ìîæíî äîãàäàòüñÿ, ýòî íå ñàìûé ýôôåêòèâíûé ñïîñîá.</p>
<p>Ëó÷øèì ïîäõîäîì ÿâëÿåòñÿ ïðîòîòèïèðîâàíèå âñåãî ðîäèòåëüñêîãî êëàññà íà êëàññå-ïîòîìêå. Ýòî ïðåäîñòàâëÿåò äîñòóï êî âñåì ñâîéñòâàì è ìåòîäàì êëàññà ïðåäêà:</p>
<empty-line/>
<p><code>function Animal(name){</code></p>
<p><code>this.name = name;</code></p>
<p><code>}</code></p>
<p><code>Animal.prototype = {</code></p>
<p><code>species: 'Animal',</code></p>
<p><code>sleep : function(){ alert(this.name+' ñïèò: Õðððð'); }</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function Cat(name){</code></p>
<p><code>Animal.apply(this, arguments);</code></p>
<p><code>}</code></p>
<p><code>Cat.prototype = new Animal;</code></p>
<p><code>Cat.prototype.species = 'Cat';</code></p>
<p><code>Cat.prototype.talk = function(){ alert('Ìÿó!'); }</code></p>
<empty-line/>
<p><code>function Dog(name){</code></p>
<p><code>Animal.apply(this, arguments);</code></p>
<p><code>}</code></p>
<p><code>Dog.prototype = new Animal;</code></p>
<p><code>Dog.prototype.talk = function(){ alert('Ãàâ!'); }</code></p>
<empty-line/>
<p><code>var sam = new Cat('Sam');</code></p>
<p><code>var joe = new Dog('Joe');</code></p>
<empty-line/>
<p><code>sam.sleep(); // Sam ñïèò : Õðððð</code></p>
<p><code>joe.sleep(); // Joe ñïèò: Õðððð</code></p>
<empty-line/>
<p><code>alert(sam.species); // Cat</code></p>
<p><code>alert(joe.species); // Animal – äëÿ Dog ôóíêöèÿ species íå îïðåäåëåíà</code></p>
<empty-line/>
<p>Ìîæíî ïðîäîëæèòü ýòî äàëüøå è ñîçäàòü îòäåëüíûå ôóíêöèè äëÿ ðàçëè÷íûõ ïîðîä ñîáàê èëè êîøåê è ò.ä.</p>
<p>Çàìûêàíèå (<strong>ñlosure</strong>) ÿâëÿåòñÿ îäíèì èç íàèáîëåå ìîùíûõ ñðåäñòâ <strong>JavaScript</strong>. Åñëè âîñïîëüçîâàòüñÿ ïðîñòûì îáúÿñíåíèåì, òî çàìûêàíèå ñâÿçûâàåò âíóòðåííèå è âíåøíèå ïåðåìåííûå â ôóíêöèè. Ïî÷åìó ýòî òàê âàæíî? Ïîòîìó ÷òî çàìûêàíèå ïîçâîëÿåò ýìóëèðîâàòü ïî÷òè ëþáîå ñâîéñòâî ëþáîãî ÿçûêà ïðîãðàììèðîâàíèÿ, äàæå åñëè îíî íå ñóùåñòâóåò â <strong>JavaScript</strong>. Ýòî çâó÷èò íåìíîãî íåïîíÿòíî, ïîýòîìó ëó÷øå íà÷àòü ñ áîëåå ïðîñòîãî ïðèìåðà:</p>
<empty-line/>
<p><code>function beginAdding(a){</code></p>
<p><code>a *= 5;</code></p>
<p><code>return function finishAdding(b){ alert(a+b); }</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>var add = beginAdding(10);</code></p>
<empty-line/>
<p><code>add(20); // 70</code></p>
<empty-line/>
<p>Ìîæíî âèäåòü, ÷òî â ïðèâåäåííîì êîäå ïåðåìåííîé <strong>'a'</strong> ïðèñâàèâàåòñÿ çíà÷åíèå <strong>10</strong> è ïåðåäàåòñÿ â ôóíêöèþ <strong>beginAdding</strong>, â òî âðåìÿ êàê ïåðåìåííîé <strong>'b'</strong> ïðèñâàèâàåòñÿ çíà÷åíèå <strong>20</strong> è ïåðåäàåòñÿ â ôóíêöèþ <strong>finishAdding</strong>.</p>
<p>À ÷òî ñîäåðæèòñÿ â ïåðåìåííîé <strong>'add'</strong>? Îíà ñîäåðæèò ôóíêöèþ <strong>finishAdding</strong> ñ êîïèåé ñâÿçàííîé ñ íåé âñåé ôóíêöèè <strong>beginAdding</strong>. Êîïèÿ ïåðåìåííîé <strong>'a'</strong> èç <strong>beginAdding</strong> ñîõðàíÿåòñÿ â ïàìÿòè äëÿ äàëüíåéøåãî èñïîëüçîâàíèÿ.</p>
<p>Òåïåðü, èìåÿ ïðåäñòàâëåíèå î çàìûêàíèè, ïðåæäå ÷åì ïðîäîëæàòü, íåîáõîäèìî îáñóäèòü ïðîáëåìó óòå÷êè ïàìÿòè. <strong>Internet Explorer</strong>, â ÷àñòíîñòè, ïîäâåðæåí äîñòàòî÷íî íåïðèÿòíûì óòå÷êàì ïàìÿòè ïðè èñïîëüçîâàíèè çàìûêàíèÿ. ×òîáû ïîíÿòü, ïî÷åìó íåîáõîäèìî çíàòü î ñáîðêå ìóñîðà â <strong>Internet Explorer</strong>, ïîñìîòðèì, êàê â ýòîì áðàóçåðå âûïîëíÿåòñÿ î÷èñòêà ïàìÿòè îò íåíóæíûõ îáúåêòîâ.</p>
<p><strong>Internet Explorer</strong> èìååò äâà îòäåëüíûõ ñáîðùèêà ìóñîðà: îäèí äëÿ <strong>JavaScript</strong> è äðóãîé äëÿ îáúåêòîâ <strong>DOM</strong>. Ïðè âûãðóçêå ñòðàíèöû áðàóçåð ïðîñìàòðèâàåò è óäàëÿåò âåñü êîä <strong>JavaScript</strong> è âñå îáúåêòû <strong>DOM</strong> ñî ñòðàíèöû. Óòå÷êà ïðîèñõîäèò, êîãäà èìåþòñÿ öèêëè÷åñêèå ññûëêè èç îáúåêòà <strong>DOM</strong> â <strong>JavaScript</strong> è ñíîâà íà îáúåêò <strong>DOM</strong> èëè èç <strong>JavaScript--&gt;Dom--&gt;Javascript</strong>. <strong>Internet Explorer</strong> çàïóòûâàåòñÿ è íå óäàëÿåò îáúåêòû ïðè öèêëè÷åñêîé ññûëêå.</p>
<empty-line/>
<p><code>var someInput = document.getElementById('inputbox');</code></p>
<p><code>var someFunction = function(){</code></p>
<p><code>alert(someInput.value);</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>someInput.onclick = someFunction;</code></p>
<empty-line/>
<p>Çäåñü ïðåäñòàâëåí áåñêîíå÷íûé öèêë â òåðìèíàõ çàìûêàíèé. Îáúåêò <strong>DOM someInput</strong> âîâëå÷åí â çàìûêàíèå ñ ôóíêöèåé <strong>someFunction</strong> è íàîáîðîò. Áðàóçåð íå ìîæåò îïðåäåëèòü, ÷òî óäàëèòü â ïåðâóþ î÷åðåäü, ïîýòîìó â ðåçóëüòàòå èìååì óòå÷êó ïàìÿòè.</p>
<p>Çàìûêàíèÿ ñîçäàþò, ÷àñòî äàæå íå îñîçíàâàÿ ýòîãî. Âîçüìåì, íàïðèìåð, ïðîñòóþ ôóíêöèþ:</p>
<empty-line/>
<p><code>function Animal(name){</code></p>
<p><code>this.sleep = function(){ alert(name+' ñïèò: Õðððð'); }</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Ìîæíî íå çàìåòèòü ýòîãî, íî ïåðåìåííàÿ <strong>'name'</strong> â ôóíêöèè <strong>sleep</strong> ïðèõîäèò èç ðîäèòåëüñêîé ôóíêöèè <strong>Animal</strong>. Ýòî ñîçäàåò çàìûêàíèå.</p>
<p>Äàæå îïðåäåëåíèå ïðîñòåéøåé ôóíêöèè ìîæåò ñîçäàâàòü çàìûêàíèå:</p>
<empty-line/>
<p><code>var x = 5;</code></p>
<p><code>var n = function(){</code></p>
<p><code>y=10;</code></p>
<p><code>return y;</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Çäåñü òàêæå ñîçäàåòñÿ çàìûêàíèå, õîòÿ íà ïåðâûé âçãëÿä ýòî íå òàê. Ïî÷åìó? Êîãäà ìû ñîçäàåì ôóíêöèþ, îíà ïîëó÷àåò äîñòóï êî âñåì ïåðåìåííûì â ñâîåé òåêóùåé îáëàñòè äåéñòâèÿ, ïîýòîìó ìû ñîçäàåì íîâóþ ññûëêó íà ïåðåìåííóþ <strong>õ</strong>.</p>
<p>Òåïåðü ìû ïîäîøëè ê ïîíÿòèþ îáëàñòè äåéñòâèÿ. Êàæäàÿ ôóíêöèÿ èìååò ñâîþ îáëàñòü äåéñòâèÿ, â êîòîðîé îíà âûïîëíÿåòñÿ. Âñå îáëàñòè äåéñòâèÿ êîäà ñîõðàíÿþòñÿ âî âíóòðåííåì ñòåêå ïàìÿòè. Êîãäà ñîçäàåòñÿ çàìûêàíèå, îíî ïîëó÷àåò äîñòóï ê îäíîé èç ýòèõ îáëàñòåé äåéñòâèÿ. Åñëè ñîçäàåòñÿ íåñêîëüêî çàìûêàíèé â îäíîé è òîé æå îáëàñòè äåéñòâèÿ, òî êàæäîå çàìûêàíèå áóäåò â äåéñòâèòåëüíîñòè óêàçûâàòü íà îäèíàêîâûå êîïèè êàæäîé ïåðåìåííîé îáëàñòè äåéñòâèÿ. Íàïðèìåð:</p>
<empty-line/>
<p><code>var x = 5;</code></p>
<p><code>var alertX1 = function(){ alert(x); }</code></p>
<empty-line/>
<p><code>x = 10;</code></p>
<p><code>var alertX2 = function(){ alert(x); }</code></p>
<empty-line/>
<p><code>alertX1();</code></p>
<p><code>alertX2();</code></p>
<empty-line/>
<p>Îáå ôóíêöèè â ýòîì ñëó÷àå âûâåäóò <strong>10</strong>. Ïî÷åìó? Ïîòîìó ÷òî îíè îáå óêàçûâàþò íà îäíó è òó æå êîïèþ <strong>õ</strong>.</p>
<empty-line/>
<image l:href="#scope1.png"/>
<empty-line/>
<p>Åñëè èçìåíèòü <strong>x</strong> â ëþáîé òî÷êå, òî îáå ôóíêöèè îòðàçÿò ýòî. Êàê ýòî èñïðàâèòü? Ïðîùå âñåãî èçìåíèòü îáëàñòü äåéñòâèÿ çàìûêàíèÿ:</p>
<empty-line/>
<p><code>function makeClosure(x){</code></p>
<p><code>return function(){ alert(x); }</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>var x = 5;</code></p>
<p><code>var alertX1 = makeClosure(x);</code></p>
<empty-line/>
<p><code>x = 10;</code></p>
<p><code>var alertX2 = makeClosure(x);</code></p>
<empty-line/>
<p><code>alertX1(); // 5</code></p>
<p><code>alertX2(); // 10</code></p>
<empty-line/>
<p>Ýòî ðåøàåò ïðîáëåìó. Åñëè, îäíàêî, ýòîò êîä ñîçäàâàë óòå÷êó ïàìÿòè, òî óòå÷êà áóäåò ñóùåñòâåííî áîëüøå, ÷åì â ïðåäûäóùåì ïðèìåðå; è òàêæå èñïîëüçóåòñÿ áîëüøèé îáúåì ïàìÿòè. Îêàçûâàåòñÿ, ÷òî â äåéñòâèòåëüíîñòè èìååòñÿ òðè ðàçëè÷íûõ îáëàñòè äåéñòâèÿ â ýòîì ïðîñòîì ïðèìåðå:</p>
<empty-line/>
<image l:href="#scope2.png"/>
<empty-line/>
<p>Ìîæíî âèäåòü, ÷òî ïåðåìåííàÿ <strong>õ</strong> êîïèðóåòñÿ â êàæäóþ èç äâóõ îáëàñòåé äåéñòâèÿ. Ýòî ñâÿçàíî ñ òåì, ÷òî <strong>x</strong> ÿâëÿåòñÿ ñòðîêîé èëè ÷èñëîì. JavaScript âñåãäà ïåðåäàåò ñòðîêè è ÷èñëà ïî çíà÷åíèþ – òî åñòü âñåãäà äåëàåòñÿ êîïèÿ ïåðåìåííîé. Ñ îáúåêòàìè âñå ïðîèñõîäèò èíà÷å. Åñëè <strong>õ</strong> ÿâëÿåòñÿ ôóíêöèåé, ìàññèâîì èëè áàçîâûì îáúåêòîì, òî â ýòîì ñëó÷àå ññûëêà â äâóõ íàøèõ ôóíêöèÿõ ïðîèñõîäèò íà îäíó è òó æå êîïèþ <strong>x</strong> è ïîýòîìó â ðåçóëüòàòå âûâîäèìîå ñîîáùåíèå áóäåò îäèíàêîâûì:</p>
<empty-line/>
<p><code>function makeClosure(x){</code></p>
<p><code>return function(){ alert(x.val); }</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>var x = {val:5};</code></p>
<p><code>var alertX1 = makeClosure(x);</code></p>
<empty-line/>
<p><code>x.val = 10;</code></p>
<p><code>var alertX2 = makeClosure(x);</code></p>
<empty-line/>
<p><code>alertX1(); // 10</code></p>
<p><code>alertX2(); // 10</code></p>
<empty-line/>
<p>Îòëè÷èå ñîñòîèò â òîì, ÷òî <strong>x</strong> òåïåðü ÿâëÿåòñÿ îáúåêòîì. Êàæäàÿ èç äîïîëíèòåëüíûõ îáëàñòåé äåéñòâèÿ óêàçûâàåò íà îäíó è òó æå êîïèþ <strong>x</strong>. Ïðè èçìåíåíèè çíà÷åíèÿ <strong>x</strong> îíî èçìåíÿåòñÿ â êàæäîé îáëàñòè äåéñòâèÿ, â êîòîðîé <strong>õ</strong> óïîìèíàåòñÿ.</p>
<p>Êàê èçáåæàòü óòå÷êè ïàìÿòè ïðè èñïîëüçîâàíèè çàìûêàíèé? Íåîáõîäèìî èçáåãàòü èñïîëüçîâàíèÿ öèêëè÷åñêèõ ññûëîê. Íàèáîëåå ðàñïðîñòðàíåííîé ïðè÷èíîé óòå÷êè ïàìÿòè ÿâëÿåòñÿ ïðèñîåäèíåíèå ñîáûòèé, òàêèõ, êàê ñîáûòèå <strong>onclick</strong>, ê îáúåêòàì <strong>DOM</strong>.</p>
<p>×àñòî ñîâåðøåííî íåâèííûé ñ âèäó êîä áóäåò ñîçäàâàòü óòå÷êó è åå áûâàåò êðàéíå ñëîæíî îáíàðóæèòü. Ê ñ÷àñòüþ, ïðîòåñòèðîâàòü íàëè÷èå óòå÷êè ïàìÿòè äîñòàòî÷íî ëåãêî. Åñëè ïðè êàæäîì îáíîâëåíèè ñòðàíèöû èñïîëüçóåìàÿ ïàìÿòü óâåëè÷èâàåòñÿ, òî ïðèëîæåíèå èìååò óòå÷êó. Îòñëåäèòü, ãäå ýòî ïðîèñõîäèò, ñîâåðøåííî äðóãàÿ çàäà÷à, íî ïî êðàéíåé ìåðå òåïåðü èçâåñòíî î íàëè÷èè ïðîáëåìû!</p>
<p>Ñëåäóþùàÿ ëåêöèÿ áóäåò ïîñâÿùåí îñíîâàì ïðèëîæåíèé <strong>AJAX</strong>!</p>
</section>
<section>
<title>
<p><emphasis>Ëåêöèÿ 10.</emphasis> Îñíîâû ïðèëîæåíèé AJAX</p>
</title>
<p><emphasis>Îñíîâû ïðèëîæåíèé AJAX. Ñîçäàíèå îáúåêòà XMLHttp. Âàðèàíòû ïîëó÷åíèÿ äàííûõ: XML, JSON èëè îáû÷íûé òåêñò. Ïðèìåð ñî ñïèñêîì êîíòàêòîâ.</emphasis></p>
<p>Â ïîñëåäíåå âðåìÿ òåðìèí <strong>AJAX</strong> ïîëó÷èë øèðîêîå ðàñïðîñòðàíåíèå. Ïî ñóòè, ýòî íåîáû÷íîå íàçâàíèå òåõíîëîãèè, êîòîðàÿ óæå äàâíî ñóùåñòâóåò. Îäíàêî çà ïîñëåäíèé ãîä <strong>JavaScript</strong> â ñòèëå <strong>AJAX</strong> ñòàë î÷åíü ïîïóëÿðíûì ó ìíîãèõ ðàçðàáîò÷èêîâ, è ìû íà÷èíàåì âèäåòü, êàê ñ åãî ïîìîùüþ ñòàëè ñîçäàâàòü ðàçëè÷íûå èíòåðåñíûå âåùè. <strong>Google Maps</strong> è <strong>GMail</strong> ÿâëÿþòñÿ äâóìÿ íàèáîëåå øèðîêî èçâåñòíûìè ïðèëîæåíèÿìè <strong>AJAX</strong>, íî â ïîñëåäíåå âðåìÿ è äðóãèå êîìïàíèè ïî âñåìó ìèðó íà÷àëè èñïîëüçîâàòü åå íà ñâîèõ ñàéòàõ.</p>
<p><strong>AJAX</strong> îçíà÷àåò "<strong>Asynchronous JavaScript and XML</strong>", ò.å. Àñèíõðîííûé <strong>JavaScript</strong> è <strong>XML</strong>. Â äåéñòâèòåëüíîñòè <strong>AJAX</strong> ñîñòîèò èç <strong>JavaScript</strong>, êàê è ëþáîå äðóãîå ïðèëîæåíèå, è ñîåäèíåíèÿ <strong>XMLHTTP</strong> ñ <strong>Web-ñåðâåðîì</strong>. Âîò è âñå! Îáùàÿ èäåÿ çàêëþ÷àåòñÿ â òîì, ÷òî ìîæíî èçâëåêàòü ñ ñåðâåðà äàííûå ïðîñòî ïî ìåðå íåîáõîäèìîñòè, íå îáíîâëÿÿ âñþ ñòðàíèöó.</p>
<p>Ïðåæäå âñåãî <strong>AJAX</strong> ïî÷òè âñåãäà îïèðàåòñÿ íà ñåðâåðíûé ÿçûê, òàêîé, êàê <strong>PHP</strong> èëè <strong>ASP</strong>. Êîãäà ïîëüçîâàòåëþ íåîáõîäèìî ïîëó÷èòü íîâûå äàííûå, <strong>JavaScript</strong> çàïðàøèâàåò èõ, à ñåðâåð, âåðîÿòíî, çàïðîñèò áàçó äàííûõ è çàòåì âåðíåò äàííûå. Ýòè äàííûå ìîæíî âåðíóòü â ðàçëè÷íîé ôîðìå. Åñëè îíè ñòðóêòóðèðîâàíû, òî ýòî áóäóò îáû÷íî äàííûå <strong>XML</strong> èëè <strong>JSON</strong>. Åñëè ýòî î÷åíü ïðîñòûå äàííûå (òàêèå, êàê ïîëó÷åíèå îïèñàíèÿ êàêîãî-òî îáúåêòà), òî ìîæíî ÷àñòî óâèäåòü ëþäåé, êîòîðûå ïðîñòî çàïèñûâàþò ýòè äàííûå íåïîñðåäñòâåííî â îòâåò <strong>AJAX</strong>.</p>
<p>Ïðè ñîçäàíèè çàïðîñà <strong>AJAX</strong> ïðåæäå âñåãî íåîáõîäèìî ñîçäàòü îáúåêò <strong>XMLHTTP</strong>. <strong>Netscape/Firefox</strong>, <strong>Opera</strong> è äðóãèå áðàóçåðû èìåþò ýòîò îáúåêò âñòðîåííûì. <strong>Internet Explorer</strong> èñïîëüçóåò <strong>ActiveXObject</strong>. Ïîýòîìó ìû ñîçäàäèì îäíó ôóíêöèþ äëÿ ðàáîòû ñî âñåìè ýòèìè áðàóçåðàìè:</p>
<empty-line/>
<p><code>if(typeof(XMLHttpRequest)!='undefined'){</code></p>
<p><code>var getXMLHttpObj = function(){ return new XMLHttpRequest(); }</code></p>
<p><code>} else {</code></p>
<p><code>var getXMLHttpObj = function(){</code></p>
<p><code>var activeXObjects = ['Msxml2.XMLHTTP.6.0', 'Msxml2.XMLHTTP.5.0', 'Msxml2.XMLHTTP.4.0',</code></p>
<p><code>'Msxml2.XMLHTTP.3.0', 'Msxml2.XMLHTTP', 'Microsoft.XMLHTTP'];</code></p>
<p><code>for(var i=0; i&lt;activeXObjects.length; i++){</code></p>
<p><code>try{</code></p>
<p><code>return new ActiveXObject(activeXObjects[i]);</code></p>
<p><code>}catch(err){}</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Ëþáîé áðàóçåð, êîòîðûé ïîääåðæèâàåò îáúåêò <strong>XMLHttpRequest</strong>, áóäåò èñïîëüçîâàòü ýòîò âñòðîåííûé îáúåêò. <strong>Internet Explorer 6</strong> è áîëåå ðàííèå âåðñèè áóäóò èñïîëüçîâàòü îáúåêò <strong>ActiveX XMLHttp</strong> êîìïàíèè <strong>Microsoft</strong>. Ñóùåñòâóåò ìíîãî ðàçëè÷íûõ âåðñèé ýòîãî îáúåêòà, ïîýòîìó ìû ïîïðîáóåì èõ âñå, íà÷èíàÿ ñ ñàìîãî íîâîãî.</p>
<p>Òåïåðü, êîãäà ìû èìååì îáúåêò <strong>XMLHttp</strong>, ìîæíî ðàçìåñòèòü çàïðîñ íà ñåðâåðå:</p>
<empty-line/>
<p><code>var oXml = getXMLHttpObj();</code></p>
<p><code>oXml.open('GET', 'getData.php', true);</code></p>
<p><code>oXml.onreadystatechange = processingFunction;</code></p>
<p><code>oXml.send();</code></p>
<empty-line/>
<p><code>function processingFunction(){</code></p>
<p><code>if(oXml.readyState!=4) return; // çàïðîñ íå âûïîëíåí</code></p>
<empty-line/>
<p><code>// Ðåçóëüòàòû îáðàáàòûâàþòñÿ çäåñü. Ïîäðîáíåå äàëüøå!</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Ïîñëå ñîçäàíèÿ îáúåêòà <strong>XMLHttp</strong> îñòàåòñÿ åùå 4 äîïîëíèòåëüíûõ øàãà. Ñíà÷àëà îïðåäåëÿþòñÿ ïàðàìåòðû ñîåäèíåíèÿ ñ ïîìîùüþ ôóíêöèè <strong>.open</strong>. Ôóíêöèÿ <strong>.open</strong> ïîëó÷àåò <strong>3</strong> àðãóìåíòà: òèï çàïðîñà, <strong>URL</strong> è ôëàã, êîòîðûé ñîîáùàåò îáúåêòó, âûïîëíÿòüñÿ èëè íåò àñèíõðîííî.</p>
<p>Ïåðâûé àðãóìåíò, òèï çàïðîñà, ïî÷òè âñåãäà áóäåò <strong>GET</strong> èëè <strong>POST</strong>. Åñëè èçâëåêàþòñÿ äàííûå, òî ýòî áóäåò îáû÷íî <strong>GET</strong>, à åñëè îòïðàâëÿåòñÿ ôîðìà ñ <strong>AJAX</strong>, òî ýòî ÷àñòî áóäåò <strong>POST</strong>.</p>
<p>Ôëàã àñèíõðîííîñòè íåìíîãî îòëè÷àåòñÿ ïî÷òè îò âñåãî îñòàëüíîãî â <strong>JavaScript</strong>. Åñëè ýòîò ôëàã çàäàí êàê <strong>false</strong>, òî êîä ïðîäîëæàåò âûïîëíÿòüñÿ, êàê è ëþáîé äðóãîé ôðàãìåíò êîäà, òî åñòü îí îæèäàåò, ïîêà îáúåêò <strong>XMLHttp</strong> çàâåðøèò ñâîþ ðàáîòó, ïðåæäå ÷åì äâèãàòüñÿ äàëüøå. Îäíàêî, åñëè ýòîò ôëàã çàäàí êàê <strong>true</strong>, òî êîä ïðîäîëæàåò äåëàòü òî, ÷òî ñëåäóåò â êîäå ïîñëå çàïðîñà. Êîãäà ñîñòîÿíèå çàïðîñà èçìåíÿåòñÿ, âûçûâàåòñÿ ôóíêöèÿ, êîòîðàÿ îïðåäåëåíà â <strong>onreadystatechange</strong>.</p>
<p>Â ÷åì ðàçëè÷èå? Åñëè ôëàã àñèíõðîííîñòè çàäàí êàê <strong>false</strong>, òî áðàóçåð áóäåò ïîëíîñòüþ çàáëîêèðîâàí, ïîêà îáðàáàòûâàåòñÿ çàïðîñ. Åñëè çàïðîøåííûå äàííûå íóæíû â îáÿçàòåëüíîì ïîðÿäêå äëÿ ïðîäîëæåíèÿ ðàáîòû, òî èñïîëüçóéòå ýòî çíà÷åíèå ôëàãà. Åñëè ôëàã çàäàí êàê <strong>true</strong>, òî ïîëüçîâàòåëü ìîæåò ïðîäîëæàòü èñïîëüçîâàòü Web-ñòðàíèöó, íî íè÷åãî íå èçâåñòíî î òîì, êîãäà âåðíåòñÿ îòâåò íà çàïðîñ. Ìîæåò ïîòðåáîâàòüñÿ <strong>1/2</strong> ñåêóíäû èëè <strong>1</strong> ìèíóòà. Âñå çàâèñèò îò íàãðóçêè íà ñåðâåð è ñîåäèíåíèÿ êîíå÷íîãî ïîëüçîâàòåëÿ.</p>
<p>Êîãäà âñå ãîòîâî, ïîñûëàåòñÿ çàïðîñ. Çàòåì ìû îæèäàåì. Åñëè çàïðîñ âûïîëíÿåòñÿ ñèíõðîííî ñ ôóíêöèåé îáðàáîòêè, îïðåäåëåííîé ñ ïîìîùüþ <strong>onreadystatechange</strong>, òî îíà áóäåò âûçûâàòüñÿ íåñêîëüêî ðàç. Íà ñàìîì äåëå îíà âûçûâàåòñÿ âñÿêèé ðàç ïðè èçìåíåíèè ñîñòîÿíèÿ çàïðîñà. Ñóùåñòâóþò ðàçëè÷íûå ñîñòîÿíèÿ, òàêèå, êàê îòïðàâêà è çàãðóçêà äàííûõ, íî íàñ èíòåðåñóåò òîëüêî çàâåðøåíèå çàãðóçêè äàííûõ. Åñëè <strong>readyState == 4</strong>, òî çàïðîñ âûïîëíåí, ïîýòîìó â ëþáîì äðóãîì ñëó÷àå ìû ïðîñòî âûõîäèì èç ôóíêöèè.</p>
<p>Òåïåðü ìû ïîëó÷èëè äàííûå, íî ÷òî ýòî çà äàííûå?</p>
<p>Ñóùåñòâóåò òðè âîçìîæíûõ âàðèàíòà ïîëó÷åíèÿ äàííûõ: <strong>XML</strong>, <strong>JSON</strong> èëè îáû÷íûé òåêñò. Ïðè èçâëå÷åíèè äàííûõ èç áàçû äàííûõ, ñêîðåå âñåãî, áóäåò èñïîëüçîâàòüñÿ <strong>XML</strong> èëè <strong>JSON</strong>. Íè îäèí èç ýòèõ âàðèàíòîâ íå èìååò ÿâíûõ ïðåèìóùåñòâ. <strong>XML</strong> – øèðîêî ðàñïðîñòðàíåííûé ñòàíäàðò, è ïîýòîìó ñóùåñòâóåò ìíîãî ïðèëîæåíèé, êîòîðûå ðàáîòàþò ñ ôàéëàìè <strong>XML</strong>. <strong>JSON</strong> ÿâëÿåòñÿ áîëåå íîâîé èäååé, íî áûñòðî ñòàíîâèòñÿ ïîïóëÿðíûì. Åãî îáû÷íî ëåã÷å ïðî÷èòàòü (äëÿ ÷åëîâåêà), è îí òðåáóåò íåìíîãî ìåíüøóþ ïîëîñó ïðîïóñêàíèÿ äëÿ ïåðåñûëêè.</p>
<p>Ïðåäïîëîæèì, ÷òî ñîçäàåòñÿ ïðèëîæåíèå äëÿ óïðàâëåíèÿ êîíòàêòàìè. Cåðâåð ìîæåò âîçâðàùàòü èíôîðìàöèþ î ëþäÿõ. Îäíè è òå æå äàííûå ìîæíî âûðàçèòü â ôîðìå <strong>XML</strong> èëè <strong>JSON</strong>:</p>
<p><strong>XML:</strong></p>
<empty-line/>
<p><code>&lt;xml&gt;</code></p>
<p><code>&lt;contacts&gt;</code></p>
<p><code>&lt;person firstname="Joe" lastname="Smith" phone="555-1212" /&gt;</code></p>
<p><code>&lt;person firstname="Sam" lastname="Stevens" phone="123-4567" /&gt;</code></p>
<p><code>&lt;/contacts&gt;</code></p>
<p><code>&lt;/xml&gt;</code></p>
<empty-line/>
<p><strong>JSON:</strong></p>
<empty-line/>
<p><code>{contacts:[</code></p>
<p><code>{"firstname":"Joe", "lastname":"Smith", "phone":"555-1212"},</code></p>
<p><code>{"firstname":"Sam", "lastname":"Stevens", "phone":"123-4567"}</code></p>
<p><code>]}</code></p>
<empty-line/>
<p>Ìîæíî âèäåòü, ÷òî íîòàöèÿ XML âûãëÿäèò î÷åíü ïîõîæå íà HTML. Ïî áîëüøåé ÷àñòè ýòî òàê è åñòü. HTML è XML îáà ÿâëÿþòñÿ îñíîâàííûìè íà òåãàõ ÿçûêàìè è ìîãóò äàæå àíàëèçèðîâàòüñÿ îäèíàêîâûì îáðàçîì (ñì. Ëåêöèÿ 6).</p>
<p>Íîòàöèÿ <strong>JSON</strong> âûãëÿäèò î÷åíü ïîõîæå íà ïðîñòîé <strong>JavaScript</strong>. <strong>JSON</strong> îçíà÷àåò <strong>JavaScript Object Notation</strong> è ïîýòîìó äåéñòâèòåëüíî ÿâëÿåòñÿ îáû÷íûì <strong>JavaScript</strong>.</p>
<p>Äàííûå â ëþáîé íîòàöèè ìîæíî ïîñûëàòü ñ Web-ñåðâåðà ïðîñòî êàê îáû÷íûé òåêñò. Íèêàêèå ïðîáåëû, èìåþùèåñÿ â ýòèõ ïðèìåðàõ, íå íóæíû, çà èñêëþ÷åíèåì îäèíî÷íûõ ïðîáåëîâ ìåæäó èìåíàìè àòðèáóòîâ â òåãàõ <strong>person</strong> (â âåðñèè <strong>XML</strong>).</p>
<p>Ôîðìàò <strong>XML</strong> ÿâëÿåòñÿ ñîâîêóïíîñòüþ òåãîâ, î÷åíü ïîõîæèõ íà <strong>HTML</strong>. Ìîæíî èìåòü ëþáîå êîëè÷åñòâî òåãîâ, âëîæåííûõ äðóã â äðóãà, è êàæäûé òåã ìîæåò èìåòü ëþáîå êîëè÷åñòâî àòðèáóòîâ: íàïðèìåð, <strong>firstname</strong>, <strong>lastname</strong> è <strong>phone</strong> â ïðèìåðå âûøå. Îäíàêî èìååòñÿ íåñêîëüêî âåùåé, çà êîòîðûìè íåîáõîäèìî ñëåäèòü.</p>
<p><strong>[x]</strong> Êàæäûé òåã äîëæåí èìåòü çàêðûâàþùèé òåã. Íàïðèìåð, <strong>&lt;contacts&gt;</strong> çàêðûâàåòñÿ ñ ïîìîùüþ ðàñïîëîæåííîãî íèæå <strong>&lt;/contacts&gt;</strong>. Òåãè <strong>person</strong> ÿâëÿþòñÿ çàìêíóòûìè. <strong>/&gt;</strong> â êîíöå äåéñòâóåò ïî ñóòè êàê äîïîëíèòåëüíûé çàêðûâàþùèé òåã. Ìîæíî áûëî òàê æå ëåãêî íàïèñàòü îäèí èç íèõ êàê <strong>&lt;person</strong> ... <strong>&gt;&lt;/person&gt;</strong>.</p>
<p><strong>[x] XML</strong> èìååò îãðàíè÷åííûé íàáîð ñèìâîëîâ, êîòîðûå ìîæíî èñïîëüçîâàòü. Â ÷àñòíîñòè ñëåäóþùèå ñèìâîëû ÿâëÿþòñÿ íåäîïóñòèìûìè â óçëàõ è àòðèáóòàõ è äîëæíû çàìåíÿòüñÿ ñïåöèàëüíûìè êîìáèíàöèÿìè:</p>
<empty-line/>
<table>
<tr>
<td>&amp;</td>
<td>--&gt;</td>
<td>&amp;amp;</td>
</tr>
<tr>
<td>&lt;</td>
<td>--&gt;</td>
<td>&amp;lt;</td>
</tr>
<tr>
<td>&gt;</td>
<td>--&gt;</td>
<td>&amp;gt;</td>
</tr>
<tr>
<td>"</td>
<td>--&gt;</td>
<td>&amp;quot;</td>
</tr>
<tr>
<td>'</td>
<td>--&gt;</td>
<td>&amp;#39;</td>
</tr>
</table>
<empty-line/>
<p><code>Íàïðèìåð, óçåë <strong>&lt;group name="Bill &amp; Paul" /&gt;</strong> ÿâëÿåòñÿ íåäîïóñòèìûì è äîëæåí áûòü çàìåíåí íà <strong>&lt;group name="Bill &amp;amp; Paul" /&gt;</strong>.</code></p>
<p><strong>[x]</strong> Ïðèõîäÿùèå ñ ñåðâåðà äàííûå äîëæíû ïîñûëàòüñÿ ñ <strong>content-type</strong>, çàäàííûì êàê <strong>text/xml</strong>. Åñëè èçâëåêàåòñÿ ôàéë ñ ðàñøèðåíèåì <strong>.xml</strong>, òî ýòî äîëæíî ïðîèñõîäèòü àâòîìàòè÷åñêè. Åñëè äàííûå èçâëåêàþòñÿ èç ñöåíàðèÿ, íåîáõîäèìî çàäàâàòü ýòî âðó÷íóþ.</p>
<p>Äëÿ <strong>PHP</strong> äîáàâüòå ñëåäóþùåå:</p>
<empty-line/>
<p><code>&lt;?php header('Content-type: text/xml'); ?&gt;</code></p>
<empty-line/>
<p>Äëÿ <strong>ASP</strong> äîáàâüòå:</p>
<empty-line/>
<p><code>&lt;% response.contentType = "text/xml" %&gt;</code></p>
<empty-line/>
<p><strong>[x]</strong> Äëÿ âñåõ äðóãèõ ÿçûêîâ äîáàâüòå ýêâèâàëåíòíûé çàãîëîâîê <strong>content-type</strong>.</p>
<p>Åñëè ýòîò çàãîëîâîê íå çàäàí, ñâîéñòâî <strong>responseXML</strong> îáúåêòà <strong>XMLHttp</strong> áóäåò ïóñòûì (ýòî ñâîéñòâî áóäåò îïèñàíî äàëåå).</p>
<p><strong>JSON</strong> èìååò àíàëîãè÷íûé íàáîð ïðàâèë, è âñþ äîêóìåíòàöèþ ïî ñïîñîáàì çàïèñè ìîæíî óâèäåòü íà <a l:href="http://www.json.org/">http://www.json.org/</a>. Îäíàêî óïðîùåííî ìîæíî ñêàçàòü, ÷òî:</p>
<p><strong>[x]</strong> îáúåêòû íà÷èíàþòñÿ è çàêàí÷èâàþòñÿ ñ ïîìîùüþ ñèìâîëîâ <strong>{</strong> è <strong>}</strong> ñîîòâåòñòâåííî;</p>
<p><strong>[x]</strong> ìàññèâû íà÷èíàþòñÿ è çàêàí÷èâàþòñÿ ñ ïîìîùüþ ñèìâîëîâ <strong>[</strong> è <strong>]</strong> ñîîòâåòñòâåííî;</p>
<p><strong>[x]</strong> âñå ñòðîêè çàêëþ÷àþòñÿ â äâîéíûå êàâû÷êè <strong>"</strong>;</p>
<p><strong>[x]</strong> ñèìâîëû <strong>"</strong> â ñòðîêå äîëæíû ýêðàíèðîâàòüñÿ: <strong>\"</strong>.</p>
<p>Ïðîùå ãîâîðÿ, ñòðîêà <strong>JSON</strong> äîëæíà ïðåäñòàâëÿòü äîïóñòèìûé îáúåêò <strong>JavaScript</strong>.</p>
<p>Òåïåðü ïîñìîòðèì íà òî, êàê ìîæíî âûïîëíèòü ñèíòàêñè÷åñêèé ðàçáîð ýòèõ äàííûõ. Â äàííûé ìîìåíò ìû ñîçäàäèì ïðîñòî ñöåíàðèé, êîòîðûé ñîîáùèò, ñêîëüêî èìååòñÿ êîíòàêòîâ, è âûâåäåò î íèõ èíôîðìàöèþ. Íà÷íåì ñ âåðñèè <strong>XML</strong>, âîçâðàùàÿñü ê ïðåäûäóùåìó íåçàêîí÷åííîìó ôðàãìåíòó êîäà:</p>
<empty-line/>
<p><code>function processingFunction(){</code></p>
<p><code>if(oXml.readyState!=4) return; // çàïðîñ íå âûïîëíåí</code></p>
<empty-line/>
<p><code>// Ðåçóëüòàòû îáðàáàòûâàþòñÿ çäåñü. Ïîäðîáíåå äàëüøå!</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Êîãäà ñêðèïò ïîïàäàåò â òåëî ôóíêöèè, çàïðîñ <strong>XMLHttp</strong> áóäåò âûïîëíåí. Îáúåêò <strong>XMLHttp</strong> èìååò äâà ìåòîäà äëÿ âîçâðàòà äàííûõ: <strong>responseXML</strong> è <strong>responseText</strong>. Òàê êàê â äàííûé ìîìåíò ìû ðàáîòàåì ñ ôàéëîì <strong>XML</strong>, òî áóäåì èñïîëüçîâàòü <strong>responseXML</strong>:</p>
<empty-line/>
<p><code>function processingFunction(){</code></p>
<p><code>if(oXml.readyState!=4) return;</code></p>
<empty-line/>
<p><code>var xmlDoc = oXml.responseXML;</code></p>
<p><code>var contacts = xmlDoc.selectNodes('/xml/contacts/person');</code></p>
<empty-line/>
<p><code>alert('There are '+contacts.length+' contacts!');</code></p>
<empty-line/>
<p><code>for(var i=0; i&lt;contacts.length; i++){</code></p>
<p><code>alert('Contact #'+(i+1)+':\n\n'+</code></p>
<p><code>'First Name: '+contacts[i].getAttribute('firstname')+'\n'+</code></p>
<p><code>'Last Name: '+contacts[i].getAttribute('lastname') +'\n'+</code></p>
<p><code>'Phone #: '+contacts[i].getAttribute('phone') +'\n');</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Çäåñü èìååòñÿ <strong>3</strong> ôóíêöèè âûâîäà (<strong>alert</strong>). Îäíà ñîîáùàåò, ÷òî èìååòñÿ äâà êîíòàêòà, à åùå äâå âûâîäÿò êîíòàêòíóþ èíôîðìàöèþ äëÿ êàæäîãî ÷åëîâåêà.</p>
<p>Ïîñìîòðèì íà òîò æå ñöåíàðèé, èñïîëüçóþùèé òåêñò <strong>JSON</strong>:</p>
<empty-line/>
<p><code>function processingFunction(){</code></p>
<p><code>if(oXml.readyState!=4) return;</code></p>
<empty-line/>
<p><code>var json = eval('('+oXml.responseText+')');</code></p>
<empty-line/>
<p><code>alert('There are '+json.contacts.length+' contacts!');</code></p>
<empty-line/>
<p><code>for(var i=0; i&lt;json.contacts.length; i++){</code></p>
<p><code>alert('Contact #'+(i+1)+':\n\n'+</code></p>
<p><code>'First Name: '+json.contacts[i].firstname+'\n'+</code></p>
<p><code>'Last Name: '+json.contacts[i].lastname +'\n'+</code></p>
<p><code>'Phone #: '+json.contacts[i].phone +'\n');</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Êàê ìîæíî âèäåòü, ñòðîêè <strong>JSON</strong> ìîæíî ïðåîáðàçîâàòü â <strong>JavaScript</strong>, èñïîëüçóÿ ïðîñòî âñòðîåííóþ â <strong>JavaScript</strong> êîìàíäó <strong>eval()</strong>. Îäíàêî ýòî ìîæíî äåëàòü, òîëüêî åñëè âû ïîëíîñòüþ äîâåðÿåòå èñòî÷íèêó äàííûõ. Åñëè ýòî íå òàê (åñëè äàííûå ïîñòóïàþò èç íå âïîëíå èçâåñòíîãî èñòî÷íèêà äàííûõ), òî íåîáõîäèìî ïðîïóñòèòü èõ â öåëÿõ áåçîïàñíîñòè ÷åðåç <strong>JSON Parser</strong> (Àíàëèçàòîð <strong>JSON</strong>).</p>
<p>Íàêîíåö ìîæíî âûáðàòü ïîëó÷åíèå äàííûõ â ëþáîì äðóãîì ïðîñòîì òåêñòîâîì ôîðìàòå âìåñòî <strong>XML</strong> èëè <strong>JSON</strong>. Îäíàêî â ýòîì ñëó÷àå íåîáõîäèìî ðåøèòü, êàê âûïîëíèòü ñèíòàêñè÷åñêèé àíàëèç äàííûõ. Åñëè èìååòñÿ òîëüêî îäèí ôðàãìåíò äàííûõ, òàêîé, êàê êîììåíòàðèé, òî ýòî ìîæåò áûòü ïðàêòè÷íûì ðåøåíèåì.</p>
<p>×òî èñïîëüçîâàòü: <strong>XML</strong> èëè <strong>JSON</strong>? Çäåñü íåò áîëüøèõ ðàçëè÷èé. <strong>XML</strong> èìååò áîëåå øèðîêî ðàñïðîñòðàíåííûé ôîðìàò è ïåðåíîñèì ïî÷òè íà ëþáóþ ñèñòåìó. Åñëè ñîçäàâàåìûé ïðîåêò áóäåò ðàáîòàòü ñ âíåøíèìè èñòî÷íèêàìè, òî, âåðîÿòíî, ëó÷øå èñïîëüçîâàòü <strong>XML</strong>. Îäíàêî <strong>JSON</strong> íåìíîãî ëåã÷å äëÿ ïîíèìàíèÿ è â îáùåì îí áûñòðåå äëÿ ðàçðàáîòêè êîäà, ÷åì <strong>XML</strong>. Åñëè ýòà òåõíîëîãèÿ ïðèìåíÿåòñÿ äëÿ ïåðñîíàëüíîãî ïðîåêòà èëè â íà÷àëå íîâîãî ïðîåêòà, êîòîðîìó íå íóæíî âçàèìîäåéñòâîâàòü ñ äðóãèìè ïðèëîæåíèÿì, òî <strong>JSON</strong> îïðåäåëåííî çàñëóæèâàåò ðàññìîòðåíèÿ.</p>
<p>Â äåéñòâèòåëüíîñòè óæå åñòü âñå, ÷òî íóæíî äëÿ ñîçäàíèÿ ïðèëîæåíèé <strong>AJAX</strong>, íî ìû ðàññìîòðèì äîñòàòî÷íî ïðîñòîé ïðèìåð. Ìû ñîáèðàåìñÿ íàïèñàòü íåáîëüøóþ òàáëèöó äàííûõ (<strong>data grid</strong>), êîòîðàÿ èçâëåêàåò äàííûå èç òðåõ ðàçëè÷íûõ ôàéëîâ <strong>JSON</strong>. Äëÿ ïðîñòîòû ýòè ôàéëû óæå áûëè ñãåíåðèðîâàíû. Íà ïðàêòèêå ýòè ôàéëû áóäóò ñêîðåå âñåãî ãåíåðèðîâàòüñÿ îïåðàòèâíî ñ ïîìîùüþ ñåðâåðíîãî ñöåíàðèÿ.</p>
<p><strong>Ôàéë 1</strong></p>
<empty-line/>
<p><code>{contacts:[</code></p>
<p><code>{"firstname":"Steve" ,"lastname":"Smith", "phone":"555-1212"},</code></p>
<p><code>{"firstname":"Joe" ,"lastname":"Stevens", "phone":"555-0193"},</code></p>
<p><code>{"firstname":"Sam" ,"lastname":"Smith", "phone":"555-5120"},</code></p>
<p><code>{"firstname":"Dave" ,"lastname":"Stevens", "phone":"555-0521"},</code></p>
<p><code>{"firstname":"Suzy" ,"lastname":"Smith", "phone":"555-9410"},</code></p>
<p><code>{"firstname":"Jessica" ,"lastname":"Stevens", "phone":"555-8521"},</code></p>
<p><code>{"firstname":"James" ,"lastname":"Smith", "phone":"555-4781"},</code></p>
<p><code>{"firstname":"Jacob" ,"lastname":"Stevens", "phone":"555-9281"},</code></p>
<p><code>{"firstname":"Alex" ,"lastname":"Smith", "phone":"555-7261"},</code></p>
<p><code>{"firstname":"Tam" ,"lastname":"Stevens", "phone":"555-1820"}</code></p>
<p><code>]}</code></p>
<empty-line/>
<p><strong>Ôàéë 2</strong></p>
<empty-line/>
<p><code>{contacts:[</code></p>
<p><code>{"firstname":"Nancy" ,"lastname":"Smith", "phone":"555-9583"},</code></p>
<p><code>{"firstname":"Elane" ,"lastname":"Stevens", "phone":"555-7281"},</code></p>
<p><code>{"firstname":"Shawn" ,"lastname":"Smith", "phone":"555-5782"},</code></p>
<p><code>{"firstname":"Jessie" ,"lastname":"Stevens", "phone":"555-7312"},</code></p>
<p><code>{"firstname":"Matt" ,"lastname":"Smith", "phone":"555-4928"},</code></p>
<p><code>{"firstname":"Jason" ,"lastname":"Stevens", "phone":"555-3917"},</code></p>
<p><code>{"firstname":"Daniel" ,"lastname":"Smith", "phone":"555-8711"},</code></p>
<p><code>{"firstname":"Shannon" ,"lastname":"Stevens", "phone":"555-0912"},</code></p>
<p><code>{"firstname":"Diana" ,"lastname":"Smith", "phone":"555-6172"},</code></p>
<p><code>{"firstname":"Mark" ,"lastname":"Stevens", "phone":"555-8831"}</code></p>
<p><code>]}</code></p>
<empty-line/>
<p><strong>Ôàéë 3</strong></p>
<empty-line/>
<p><code>{contacts:[</code></p>
<p><code>{"firstname":"Laura" ,"lastname":"Stevens", "phone":"555-3915"},</code></p>
<p><code>{"firstname":"Jeff" ,"lastname":"Smith", "phone":"555-8614"},</code></p>
<p><code>{"firstname":"Frank" ,"lastname":"Stevens", "phone":"555-0213"},</code></p>
<p><code>{"firstname":"Elizabeth" ,"lastname":"Smith", "phone":"555-7531"},</code></p>
<p><code>{"firstname":"Jim" ,"lastname":"Stevens", "phone":"555-3951"}</code></p>
<p><code>]}</code></p>
<empty-line/>
<p>Ýòè ôàéëû áóäóò îáåñïå÷èâàòü âñå äàííûå äëÿ íàøåãî ñïèñêà êîíòàêòîâ íà <strong>AJAX</strong>. Ïîñòðîåíèå ñïèñêà êîíòàêòîâ ÿâëÿåòñÿ â äåéñòâèòåëüíîñòè âïîëíå ïðîñòûì: ñîçäàåòñÿ òàáëèöà <strong>TABLE</strong> äëÿ õðàíåíèÿ âñåõ êîíòàêòîâ è ôóíêöèÿ äëÿ î÷èùåíèÿ è ïîâòîðíîãî çàïîëíåíèÿ ýòîé òàáëèöû. Âîò è âñå.</p>
<empty-line/>
<p><code>&lt;table cellspacing="1" cellpadding="3" bgcolor="#000000" style="font-family:tahoma;font-size:10px;"&gt;</code></p>
<p><code>&lt;tbody id="contactListTable"&gt;</code></p>
<p><code>&lt;tr style="background-color:#CCF;"&gt;</code></p>
<p><code>&lt;th&gt;First Name&lt;/th&gt;</code></p>
<p><code>&lt;th&gt;Last Name&lt;/th&gt;</code></p>
<p><code>&lt;th&gt;Phone #&lt;/th&gt;</code></p>
<p><code>&lt;/tr&gt;</code></p>
<p><code>&lt;/tbody&gt;</code></p>
<p><code>&lt;/table&gt;</code></p>
<empty-line/>
<p><code>function loadContactListPage(n){</code></p>
<p><code>var oXML = getXMLHttpObj();</code></p>
<p><code>oXML.open('GET', '/img/10_json_file'+n+'.txt', true);</code></p>
<p><code>oXML.onreadystatechange = function(){ doneLoading(oXML); }</code></p>
<p><code>oXML.send('');</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function doneLoading(oXML){</code></p>
<p><code>if(oXML.readyState!=4) return;</code></p>
<empty-line/>
<p><code>var json = eval('('+oXML.responseText+')');</code></p>
<p><code>var table = document.getElementById('contactListTable');</code></p>
<empty-line/>
<p><code>for(var i=table.childNodes.length-1; i&gt;0; i--){</code></p>
<p><code>table.removeChild(table.childNodes[i]);</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>for(var i=0; i&lt;json.contacts.length; i++){</code></p>
<p><code>var tr = document.createElement('TR');</code></p>
<p><code>var td1 = document.createElement('TD');</code></p>
<p><code>var td2 = document.createElement('TD');</code></p>
<p><code>var td3 = document.createElement('TD');</code></p>
<empty-line/>
<p><code>tr.style.backgroundColor = i%2?'#FFF':'#E6E6E6';</code></p>
<empty-line/>
<p><code>table.appendChild(tr);</code></p>
<empty-line/>
<p><code>tr.appendChild(td1);</code></p>
<p><code>tr.appendChild(td2);</code></p>
<p><code>tr.appendChild(td3);</code></p>
<empty-line/>
<p><code>td1.appendChild(document.createTextNode(json.contacts[i].firstname));</code></p>
<p><code>td2.appendChild(document.createTextNode(json.contacts[i].lastname));</code></p>
<p><code>td3.appendChild(document.createTextNode(json.contacts[i].phone));</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p><strong>Äåìîíñòðàöèîííûé ïðèìåð</strong></p>
<empty-line/>
<p><code>First Name Last Name Phone #</code></p>
<empty-line/>
<p><code>Steve Smith 555-1212</code></p>
<p><code>Joe Stevens 555-0193</code></p>
<p><code>Sam Smith 555-5120</code></p>
<p><code>Dave Stevens 555-0521</code></p>
<p><code>Suzy Smith 555-9410</code></p>
<p><code>Jessica Stevens 555-8521</code></p>
<p><code>James Smith 555-4781</code></p>
<p><code>Jacob Stevens 555-9281</code></p>
<p><code>Alex Smith 555-7261</code></p>
<p><code>Tam Stevens 555-1820</code></p>
<empty-line/>
<p><code>Page 1 | Page 2 | Page 3</code></p>
<empty-line/>
<p>Êàê ìîæíî âèäåòü èç ïðèìåðà âûøå, ýòî âñå äîñòàòî÷íî ïðîñòî. Áîëüøàÿ ÷àñòü êîäà íóæíà â äåéñòâèòåëüíîñòè ïðîñòî äëÿ ñîçäàíèÿ íîâûõ ñòðîê â òàáëèöå.</p>
<p><strong>AJAX</strong> ìîæåò áûòü óäèâèòåëüíî ïîëåçíûì èíñòðóìåíòîì. Åãî ìîæíî èñïîëüçîâàòü äëÿ ïðîâåðêè ôîðì ïåðåä èõ îòïðàâêîé, äëÿ èçâëå÷åíèÿ äàííûõ, êàê â ýòîì ïðèìåðå, èëè äëÿ ÷åãî-òî åùå, ÷òî ìîæíî áóäåò ïðèäóìàòü. Îäíàêî â íîðìàëüíîé ñèòóàöèè îí íå äîëæåí áûòü îñíîâíûì ýëåìåíòîì Web-ñàéòà. Îáû÷íî íàäî áûòü óâåðåííûì, ÷òî ñàéò áóäåò äîñòóïåí, äàæå åñëè <strong>JavaScript</strong> áóäåò îòêëþ÷åí, íî âñåãäà ñóùåñòâóþò íåêîòîðûå èñêëþ÷åíèÿ äëÿ ýòîãî ïðàâèëà.</p>
<p>Ñëåäóþùàÿ ëåêöèÿ áóäåò ïîñâÿùåíà îáðàáîòêå îøèáîê â <strong>JavaScript</strong>.</p>
</section>
<section>
<title>
<p><emphasis>Ëåêöèÿ 11.</emphasis> Îáðàáîòêà îøèáîê â JavaScript</p>
</title>
<p><emphasis>Îáðàáîòêà îøèáîê â JavaScript: Ñèíòàêñè÷åñêèå îøèáêè. Îøèáêè âðåìåíè âûïîëíåíèÿ. Window.onerror. Try/Catch/Finally è Throw. Îáðàáîòêà îøèáîê â AJAX</emphasis></p>
<p>Âû íàïèñàëè ïðèëîæåíèå <strong>JavaScript</strong>, è îíî ðàáîòàåò îòëè÷íî – ïîêà âû íå ïîëó÷èòå ñîîáùåíèå îá îøèáêå. Ýòî íå÷òî íåïðèãëÿäíîå, âûñêàêèâàþùåå íà ýêðàíå, ÷òî-íèáóäü âðîäå <strong>'myObject.fields is null or not an object'</strong>. ×òî ýòî çíà÷èò? Â ýòîì óðîêå ìû ðàññìîòðèì, êàê èçáàâèòüñÿ îò îøèáîê, è ïîêàæåì íåñêîëüêî ðàçëè÷íûõ ìåòîäîâ äëÿ îáùåé îáðàáîòêè îøèáîê.</p>
<p><strong>JavaScript</strong> èìååò äâà îñíîâíûõ óðîâíÿ îáðàáîòêè îøèáîê: ñèíòàêñè÷åñêèå îøèáêè è îøèáêè âðåìåíè âûïîëíåíèÿ. Ñèíòàêñè÷åñêèå îøèáêè âîçíèêàþò äî âûïîëíåíèÿ êîäà JavaScript, îçíà÷àÿ â îñíîâíîì, ÷òî êîä íåâîçìîæíî êîìïèëèðîâàòü. Âîçüìåì, íàïðèìåð, ñëåäóþùèé êîä:</p>
<empty-line/>
<p><code>for(var i=0; i&lt;10; i++)</code></p>
<p><code>// ðàáî÷èé êîä çäåñü</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Îáðàòèòå âíèìàíèå, ÷òî çäåñü ïðîïóùåíà îòêðûâàþùàÿ ñêîáêà <strong>{</strong>. Åñëè ïîïðîáîâàòü âûïîëíèòü ýòîò êîä, òî íåìåäëåííî ïîÿâèòñÿ ñîîáùåíèå îá îøèáêå, äàæå åñëè êîä íàõîäèòñÿ â ôóíêöèè, êîòîðàÿ íå âûïîëíÿåòñÿ ñðàçó. Òàêèå îøèáêè ïî÷òè âñåãäà ëåãêî íàõîäÿòñÿ è èñïðàâëÿþòñÿ. Â ýòîì ñëó÷àå áóäåò ïîëó÷åíî ñîîáùåíèå, ãîâîðÿùåå ÷òî-íèáóäü ïîäîáíîå "<strong>Îæèäàëàñü ')', ñòðîêà 10, ïîçèöèÿ 18</strong>". Åñëè ïåðåéòè ê ñòðîêå <strong>10</strong>, òî òàì îáû÷íî áóäåò íàõîäèòüñÿ äîñòàòî÷íî î÷åâèäíàÿ îøèáêà, òàêàÿ, êàê ïðîïóùåííàÿ <strong>)</strong>, äîïîëíèòåëüíûé çíàê <strong>&lt;</strong>èëè êàêàÿ-òî äðóãàÿ îïå÷àòêà. Ñ òàêèìè îøèáêàìè íè÷åãî íåëüçÿ ñäåëàòü, êðîìå êàê ïðîñòî èñïðàâèòü è äâèãàòüñÿ äàëüøå. Íèæå ïðåäñòàâëåí ñïèñîê íåêîòîðûõ íàèáîëåå ðàñïðîñòðàíåííûõ ñèíòàêñè÷åñêèõ îøèáîê:</p>
<p><strong>[x]</strong> Ïðîïóùåííûå èëè íåïàðíûå ôèãóðíûå, êðóãëûå èëè êâàäðàòíûå ñêîáêè</p>
<p>Êàæäàÿ ôèãóðíàÿ <strong>{</strong>, êðóãëàÿ <strong>(</strong>, èëè êâàäðàòíàÿ <strong>[</strong> ñêîáêà äîëæíà èìåòü ñâîþ çàêðûâàþùóþ ïàðíóþ ñêîáêó. Åñëè èìåþòñÿ âëîæåííûå ñêîáêè, òî âíóòðåííèå äîëæíû áûòü çàêðûòû ïðåæäå, ÷åì âíåøíèå. Íàïðèìåð, íàáîð ñêîáîê <strong>{[}]</strong> ÿâëÿåòñÿ íåäîïóñòèìûì.</p>
<p><code>Óñëîâèÿ îïåðàòîðîâ <strong>if</strong>, <strong>for</strong> è <strong>while</strong> äîëæíû ïîìåùàòüñÿ â êðóãëûå ñêîáêè. Âûðàæíåíèå "<strong>if x=5{</strong>" ÿâëÿåòñÿ íåäîïóñòèìûì, òàê êàê "<strong>x=5</strong>" äîëæíî áûòü çàêëþ÷åíî â êðóãëûå ñêîáêè. Åñëè ñ ýòèì âîçíèêíóò ïðîáëåìû, òî ñóùåñòâóþò ðåäàêòîðû, òàêèå, êàê <strong>EditPlus</strong>, êîòîðûå ìîãóò âûäåëÿòü ñîîòâåòñòâóþùèå ïàðû ñêîáîê, è ò.ä.</code></p>
<p><strong>[x]</strong> Ïðîïóùåííûå èëè íåïàðíûå êàâû÷êè</p>
<p>Ýòî î÷åíü ðàñïðîñòðàíåííàÿ ïðîáëåìà. Ñòðîêè â <strong>JavaScript</strong> íà÷èíàþòñÿ ñèìâîëîì <strong>'</strong>èëè <strong>"</strong> è äîëæíû çàêàí÷èâàòüñÿ òàêèì æå ñèìâîëîì. Åñëè ýòîò ñèìâîë ñóùåñòâóåò â ñòðîêå, òî îí äîëæåí áûòü ýêðàíèðîâàí. Íàïðèìåð, êîä</p>
<empty-line/>
<p><code>var x = 'It's a beautiful day';</code></p>
<empty-line/>
<p>ÿâëÿåòñÿ íåäîïóñòèìûì, ïîòîìó ÷òî <strong>'</strong> â <strong>It's</strong> íå ýêðàíèðîâàíî. Ýòîò êîä äîëæåí âûãëÿäåòü ñëåäóþùèì îáðàçîì:</p>
<empty-line/>
<p><code>var x = 'It\'s a beautiful day';</code></p>
<empty-line/>
<p><code>// èëè</code></p>
<empty-line/>
<p><code>var x = "It's a beautiful day";</code></p>
<empty-line/>
<p>Åùå îäíîé äîñòàòî÷íî ðàñïðîñòðàíåííîé îøèáêîé ÿâëÿåòñÿ çàâåðøåíèå ñòðîêè äðóãèì ñèìâîëîì, ò.å.:</p>
<empty-line/>
<p><code>var x = "It's a beautiful day';</code></p>
<empty-line/>
<p>Ýòà ñòðîêà íà÷èíàåòñÿ ñ ñèìâîëà <strong>"</strong>, ïîýòîìó äîëæíà çàêîí÷èòüñÿ òàêæå ñèìâîëîì <strong>"</strong>.</p>
<p><strong>[x]</strong> Ïðîïóùåííàÿ òî÷êà ñ çàïÿòîé.</p>
<p>Õîòÿ òî÷êè ñ çàïÿòîé îáû÷íî íå íóæíû â <strong>JavaScript</strong>, íî ëó÷øå âñå æå èõ èñïîëüçîâàòü. Íàïðèìåð, åñëè íóæíî ñîêðàòèòü ôàéë <strong>JavaScript</strong>, òî îáû÷íî óäàëÿþò âñå ïåðåíîñû ñòðîê. Âîçüìåì ñëåäóþùèé êîä:</p>
<empty-line/>
<p><code>var x=5</code></p>
<p><code>var y=10</code></p>
<empty-line/>
<p>Åñëè óäàëèòü ïåðåíîñû ñòðîê, òî ïîëó÷èì êîä</p>
<empty-line/>
<p><code>var x=5 var y=10</code></p>
<empty-line/>
<p>êîòîðûé âûçîâåò îøèáêó. Åñëè áû èñïîëüçîâàëèñü òî÷êè ñ çàïÿòîé, òî ïðîáëåìû íå áûëî áû.</p>
<p>Ïåðåéäåì ê îøèáêàì âðåìåíè âûïîëíåíèÿ. Ïîñëå çàïóñêà êîäà íà èñïîëíåíèå íà÷èíàþò ïîÿâëÿòüñÿ îøèáêè âðåìåíè âûïîëíåíèÿ. Ýòè îøèáêè ìîãóò âîçíèêàòü â ñâÿçè ñ ìíîæåñòâîì ïðè÷èí. Êàæäûé èç ñëåäóþùèõ äàëåå áëîêîâ êîäà áóäåò ïîðîæäàòü îøèáêó:</p>
<empty-line/>
<p><code>alert(x); // 'x' íå îïðåäåëåíî</code></p>
<empty-line/>
<p><code>var x;</code></p>
<empty-line/>
<p><code>x[5] = 'test'; // 'x' áóäåò null èëè íå ÿâëÿåòñÿ îáúåêòîì</code></p>
<empty-line/>
<p><code>window.frames = 5; // Íå ðåàëèçîâàíî</code></p>
<empty-line/>
<p><code>var for; // îæèäàåòñÿ èäåíòèôèêàòîð</code></p>
<empty-line/>
<p><code>document.doesNotExist(5);</code></p>
<p><code>// îáúåêò íå ïîääåðæèâàåò ýòî ñâîéñòâî èëè ìåòîä</code></p>
<empty-line/>
<p><code>alert(parseInt('5')); // îæèäàåòñÿ îáúåêò</code></p>
<empty-line/>
<p>Ìíîãèå èç ýòèõ ïðîáëåì âûçûâàþòñÿ áîëåå îáùèìè îøèáêàìè, êîòîðûå ïðèõîäèòñÿ ðàçûñêèâàòü.</p>
<p><strong>[x]</strong> Íåïðàâèëüíîå èñïîëüçîâàíèå ïðîïèñíûõ áóêâ</p>
<p>Âñå âñòðîåííûå ôóíêöèè <strong>JavaScript</strong> èñïîëüçóþò ñïåöèàëüíóþ ôîðìó çàïèñè èìåí ôóíêöèé, ïðåäïîëàãàþùóþ, ÷òî èìÿ ôóíêöèè íà÷èíàåòñÿ ñî ñòðî÷íîé áóêâû, à â íà÷àëå êàæäîãî ñëåäóþùåãî ñëîâà áóäåò èñïîëüçîâàòüñÿ ïðîïèñíàÿ áóêâà: <strong>parseInt</strong>, getElementById, <strong>createElement</strong>, <strong>appendChild</strong>, è ò.ä.</p>
<p>Òàê êàê <strong>JavaScript</strong> ó÷èòûâàåò ðåãèñòð ñèìâîëîâ, òî íåïðàâèëüíûé ââîä èìåíè îäíîé èç ýòèõ ôóíêöèé ÷àñòî áóäåò ïðèâîäèòü ê îøèáêå âî âðåìÿ âûïîëíåíèÿ.</p>
<p><strong>[x]</strong> Ññûëêà íà íåñóùåñòâóþùèé êîä, ôóíêöèè èëè îáúåêòû <strong>DOM</strong> </p>
<p>Ýòà ïðîáëåìà âîçíèêàåò îáû÷íî â îòíîøåíèè îáúåêòîâ <strong>DOM</strong>. Ïðåäïîëîæèì, ÷òî èìååòñÿ êîä, êîòîðûé èçìåíÿåò íåêîòîðûå ýëåìåíòû ôîðìû íà ñòðàíèöå. Åñëè äåëàåòñÿ ïîïûòêà âûïîëíèòü ýòîò êîä äî ïîÿâëåíèÿ ýëåìåíòîâ ôîðìû, íàïðèìåð, åñëè ïîìåñòèòü åãî â òåã <strong>&lt;HEAD&gt;</strong>, òî áóäåò ïîëó÷åíà îøèáêà <strong>JavaScript</strong>.</p>
<p>Îáû÷íî ýòà ïðîáëåìà ëåãêî ðåøàåòñÿ. Ëó÷øèì ðåøåíèåì áóäåò âûïîëíåíèå êîäà ïî ñîáûòèþ <strong>onload</strong>, íàïðèìåð:</p>
<empty-line/>
<p><code>&lt;BODY onload="loadFunction();"&gt;</code></p>
<empty-line/>
<p>èëè, åùå ëó÷øå, ïðèñîåäèíåíèå ñîáûòèÿ ê çàãðóçêå òåëà:</p>
<empty-line/>
<p><code>document.captureEvents(Event.LOAD);</code></p>
<p><code>document.onLoad=loadFunction;</code></p>
<empty-line/>
<empty-line/>
<p><strong>[x]</strong> Èñïîëüçîâàíèå çàðåçåðâèðîâàííîãî ñëîâà</p>
<p>Ñóùåñòâóåò äëèííûé ñïèñîê çàðåçåðâèðîâàííûõ êëþ÷åâûõ ñëîâ <strong>JavaScript</strong>. Åñëè äåëàåòñÿ ïîïûòêà èñïîëüçîâàòü ìíîãèå èç íèõ âíå èõ ñïåöèàëüíîãî êîíòåêñòà, êàê, íàïðèìåð, çàïèñü</p>
<empty-line/>
<p><code>var for = 5;</code></p>
<empty-line/>
<p>òî áóäåò âîçíèêàòü îøèáêà.</p>
<p><strong>[x]</strong> Èñïîëüçîâàíèå ïðîïóùåííîãî ïàðàìåòðà</p>
<p>Ïðè îïðåäåëåíèè ôóíêöèè îáû÷íî èñïîëüçóåòñÿ íåêîòîðîå êîëè÷åñòâî àðãóìåíòîâ. Åñëè íåêîòîðûå èç ýòèõ àðãóìåíòîâ ïðîïóùåíû è äåëàåòñÿ ïîïûòêà èõ èñïîëüçîâàòü, òî âîçíèêíóò îøèáêè.</p>
<p>Áîëüøèíñòâî èç ýòèõ ïðîáëåì ïîïàäàþò â êàòåãîðèþ îïå÷àòîê è ïðîñòî îáû÷íûõ îøèáîê, êîòîðûå ìîæíî èñïðàâèòü, íî íåîáõîäèìî î íèõ çíàòü, ÷òîáû ñëó÷àéíî íå ñäåëàòü.</p>
<p>Îäíàêî ïîñëåäíèé òèï îøèáêè èç ýòîãî ñïèñêà ñ ïðîïóùåííûìè ïàðàìåòðàìè ìîæíî ïðîâåðèòü äîñòàòî÷íî ëåãêî:</p>
<empty-line/>
<p><code>function myFunction(a, b, c){</code></p>
<p><code>if(a){</code></p>
<p><code>// âûïîëíÿåòñÿ ðàáîòà ñ a</code></p>
<p><code>}</code></p>
<p><code>if(b &amp;&amp; c){</code></p>
<p><code>// âûïîëíÿåòñÿ ðàáîòà ñ b è c</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Åñëè ôóíêöèÿ âûçûâàåòñÿ òîëüêî ñ îäíîé ïåðåìåííîé, òî ïðîáëåìû íå âîçíèêàåò. Îäíàêî íàäî ïîìíèòü îá îäíîé âåùè: åñëè âõîäÿùàÿ ïî çíà÷åíèþ ïåðåìåííàÿ ìîæåò áûòü îïðåäåëåíà êàê <strong>false (0</strong> èëè <strong>false</strong>), òî êîä íå áóäåò ðàáîòàòü. Â ñâÿçè ñ ýòèì ëó÷øå ïðîâåðÿòü, ÷òî ïåðåìåííàÿ íå áûëà îïðåäåëåíà:</p>
<empty-line/>
<p><code>function myFunction(a, b, c){</code></p>
<p><code>if(typeof(a)!='undefined'){</code></p>
<p><code>// âûïîëíåíèå êîäà ñ a</code></p>
<p><code>}</code></p>
<p><code>if((typeof(b)!='undefined') &amp;&amp; (typeof(c)!='undefined')){</code></p>
<p><code>// âûïîëíåíèå êîäà ñ b è c</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Â ýòîì ñëó÷àå, äàæå åñëè îäíà èç ïåðåìåííûõ áóäåò ïåðåäàíà êàê <strong>0</strong>, <strong>false</strong> èëè <strong>null</strong>, êîä âñå ðàâíî áóäåò ðàáîòàòü.</p>
<p>Ñåé÷àñ ìû ïåðåéäåì ê èçó÷åíèþ ìåõàíèçìîâ îáðàáîòîê îøèáîê – ñ ïîìîùüþ îïåðàòîðîâ Try/Catch è ôóíêöèè window.onerror.</p>
<p>Îòêðîâåííî ãîâîðÿ, ôóíêöèÿ <strong>window.onerror</strong> èìååò íåáîëüøóþ ïðàêòè÷åñêóþ ïîëüçó. Åå ÷àùå âñåãî èñïîëüçóþò äëÿ ïîëíîãî îòêëþ÷åíèÿ âñåõ ñîîáùåíèé îá îøèáêàõ âî âðåìÿ âûïîëíåíèÿ:</p>
<empty-line/>
<p><code>window.onerror = function(){</code></p>
<p><code>return true;</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Ñ ýòèì êîäîì ñîîáùåíèå îá îøèáêå íèêîãäà íå áóäåò âûâîäèòüñÿ. Îäíàêî â ñâÿçè ñ ýòèì ïðèëîæåíèå ìîæåò íå ðàáîòàòü. Íàïðèìåð, åñëè áû ïåðåìåííàÿ áûëà <strong>null</strong> è ñ íåé áûëà âûïîëíåíà êàêàÿ-òî îïåðàöèÿ, òî â îáû÷íîé ñèòóàöèè äîëæíî ïîÿâèòüñÿ ñîîáùåíèå îá îøèáêå. Ïðè èñïîëüçîâàíèè ýòîãî êîäà ôóíêöèÿ èëè ñöåíàðèé â ñëó÷àå âîçíèêíîâåíèÿ îøèáêè áóäåò ïðîñòî ìîë÷à îñòàíàâëèâàòüñÿ.</p>
<p>Ôóíêöèþ <strong>window.onerror</strong> ìîæíî òàêæå èñïîëüçîâàòü äëÿ âûâîäà ïîëüçîâàòåëÿì íåñêîëüêî áîëåå äðóæåñòâåííûõ ñîîáùåíèé îá îøèáêàõ. Ìîæíî ïðîñòî âûâåñòè, íàïðèìåð, ñîîáùåíèå <strong>'Ïðîèçîøëà îøèáêà, ñâÿæèòåñü, ïîæàëóéñòà, ñ Web-ìàñòåðîì'</strong>, âìåñòî âûâîäà ïîëüçîâàòåëþ âñåõ òåõíè÷åñêèõ äåòàëåé îøèáêè (÷òî áîëüøèíñòâî áðàóçåðîâ äåëàåò ïî óìîë÷àíèþ).</p>
<p>Åùå îäíî èñïîëüçîâàíèå <strong>window.onerror</strong> ñîñòîèò â îòïðàâêå ðàçðàáîò÷èêó ñïèñêà âñåõ îøèáîê, ïðîèçîøåäøèõ íà ñàéòå. Ìîæíî èñïîëüçîâàòü <strong>AJAX</strong> äëÿ îòïðàâêè ñîîáùåíèé îá îøèáêàõ â ôîðìå, ÷òîáû ìîæíî áûëî ïîçæå èõ èñïðàâèòü. Âñå ýòî âîçìîæíî ñäåëàòü íåÿâíî, áåç âçàèìîäåéñòâèÿ ñ ïîëüçîâàòåëåì.</p>
<p>Îïåðàòîðû <strong>Try/Catch</strong> ÿâëÿþòñÿ íåñîìíåííî íàèáîëåå ðàñïðîñòðàíåííûì è îáû÷íî ëó÷øèì ñïîñîáîì ðåàëèçîâàòü îáðàáîòêó îøèáîê â <strong>JavaScript</strong>. Íî íå òîëüêî ýòî – îïåðàòîðû <strong>Try/Catch</strong> ìîãóò èíîãäà áûòü åäèíñòâåííûì ñïîñîáîì ðåàëèçîâàòü íåêîòîðûå çàäà÷è, òàêèå, êàê îáíàðóæåíèå îáúåêòà. Âîçüìåì, íàïðèìåð, ïðîñòóþ ôóíêöèþ äëÿ ñîçäàíèÿ â <strong>Internet Explorer</strong> îáúåêòà <strong>XMLHttp</strong>:</p>
<empty-line/>
<p><code>var activeXObjects = ['Msxml2.XMLHTTP.6.0', 'Msxml2.XMLHTTP.5.0', 'Msxml2.XMLHTTP.4.0',</code></p>
<p><code>'Msxml2.XMLHTTP.3.0', 'Msxml2.XMLHTTP', 'Microsoft.XMLHTTP'];</code></p>
<p><code>for(var i=0; i&lt;activeXObjects.length; i++){</code></p>
<p><code>try{</code></p>
<p><code>return new ActiveXObject(activeXObjects[i]);</code></p>
<p><code>}catch(err){}</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Çàðàíåå íåèçâåñòíî, êàêèå îáúåêòû óñòàíîâèë ïîëüçîâàòåëü, è, ê ñîæàëåíèþ, áðàóçåð íå ïðåäîñòàâëÿåò íèêàêîãî ìåõàíèçìà ýòî îïðåäåëèòü. Ïîýòîìó îñòàåòñÿ ñîçäàâàòü êàæäûé èç 6 âîçìîæíûõ îáúåêòîâ, ïîêà îäèí èç íèõ (áóäåì íàäåÿòüñÿ) íå çàðàáîòàåò.</p>
<p>Îïåðàòîðû <strong>Try/Catch</strong> ìîæíî èñïîëüçîâàòü äëÿ ïåðåõâàòà îøèáîê äâóõ òèïîâ: îøèáîê âðåìåíè âûïîëíåíèÿ è îøèáîê ïîëüçîâàòåëÿ. Îøèáêè âðåìåíè âûïîëíåíèÿ, êàê ãîâîðèëîñü ðàíåå, âîçíèêàþò, êîãäà ó êîìïèëÿòîðà <strong>JavaScript</strong> ñóùåñòâóåò ïðîáëåìà ñ ñîçäàííûì êîäîì. Îøèáêè ïîëüçîâàòåëÿ, ñ äðóãîé ñòîðîíû, áóäóò òåõíè÷åñêè ïðîõîäèòü áåç ïðîáëåì, íî âîçíèêàþò â ñâÿçè ñ êîíòåêñòîì ïðèëîæåíèÿ. Åñëè èìååòñÿ ïîëå, â êîòîðîå ïîëüçîâàòåëü, íàïðèìåð, äîëæåí ââåñòè ñâîé âîçðàñò, è ïîëüçîâàòåëü ââîäèò <strong>– 2</strong>, òî ýòî ïðèâîäèò ê ïîÿâëåíèþ îøèáêè.</p>
<p>Áëîê <strong>Try/Catch</strong> èìååò äîñòàòî÷íî ïðîñòîé ñèíòàêñèñ:</p>
<empty-line/>
<p><code>try{</code></p>
<p><code>// êîä</code></p>
<p><code>}catch(err){</code></p>
<p><code>// êîä îáðàáîòêè îøèáêè</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Åñëè êîä â áëîêå <strong>try</strong> ïðèâîäèò ê îøèáêå, òî ñöåíàðèé íåìåäëåííî ïåðåõîäèò â áëîê <strong>catch</strong>. Îáúåêò îøèáêè <strong>err</strong> â <strong>JavaScript</strong> èìååò ðÿä ïîëåçíûõ ñâîéñòâ – îïèñàíèå, ñîîáùåíèå, èìÿ è íîìåð, êîòîðûå ìîæíî èñïîëüçîâàòü äëÿ âûâîäà èíôîðìàöèè î òîì, ÷òî ïðîèçîøëî:</p>
<empty-line/>
<p><code>try{</code></p>
<p><code>var x;</code></p>
<p><code>x[5] = 5;</code></p>
<p><code>}catch(err){</code></p>
<p><code>alert('An error occured: '+err.description);</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Åñëè â îïåðàòîðå <strong>catch</strong> îêàæåòñÿ îøèáêà, òî <strong>JavaScript</strong> ñìîæåò îáðàòèòüñÿ â äàëüíåéøåì ê åå îïèñàíèþ.</p>
<p>Òàêîé áëîê êîäà <strong>Try/Catch</strong> ìîæíî ïðèìåíÿòü â ëþáîì ìåñòå. Îäíàêî, îáû÷íî, êîä äîëæåí áûòü íàïèñàí òàêèì îáðàçîì, ÷òîáû ýòî íå íóæíî áûëî èñïîëüçîâàòü, – â ÷àñòíîñòè, âåñü ââîä äîëæåí ïðîâåðÿòüñÿ.</p>
<p>Áëîê <strong>Try/Catch</strong> ìîæíî ïðèìåíÿòü òàêæå äëÿ ñîçäàíèÿ ñâîèõ ñîáñòâåííûõ îøèáîê:</p>
<empty-line/>
<p><code>function setAge(x){</code></p>
<p><code>if(typeof(x)=='undefined') throw('Âû äîëæíû ââåñòè âîçðàñò');</code></p>
<p><code>if(typeof(x)!='number') throw('Âîçðàñò äîëæåí áûòü ÷èñëîì');</code></p>
<p><code>if(x&lt;0) throw('Âîçðàñò íå ìîæåò áûòü ìåíüøå 0');</code></p>
<p><code>if(x&gt;120) throw('Âîçðàñò íå ìîæåò áûòü áîëüøå 120');</code></p>
<empty-line/>
<p><code>var myAge = x;</code></p>
<empty-line/>
<p><code>// åùå êîä</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>try{</code></p>
<p><code>setAge(userInput);</code></p>
<p><code>}catch(err){</code></p>
<p><code>alert(err);</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Â ýòîì ñëó÷àå âûïîëíÿåòñÿ ïðîâåðêà òîãî, ÷òî ïîëüçîâàòåëü ââîäèò âîçðàñò. Åñëè îí ââîäèò íåäîïóñòèìûå äàííûå, ñöåíàðèé íåìåäëåííî çàâåðøàåòñÿ, à ïîëüçîâàòåëü ïîëó÷àåò ñîîáùåíèå îá îøèáêå.</p>
<p>Áëîê <strong>try/catch</strong> èìååò åùå îäíó ÷àñòü, îïåðàòîð <strong>finally</strong>:</p>
<empty-line/>
<p><code>try{</code></p>
<p><code>// êîä</code></p>
<p><code>}catch(err){</code></p>
<p><code>// êîä</code></p>
<p><code>}finally{</code></p>
<p><code>// êîä</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Êîä â "çàâåðøàþùåì áëîêå" áóäåò âûïîëíÿòüñÿ íåçàâèñèìî îò òîãî, ÷òî ïðîèñõîäèò ñ îïåðàòîðàìè <strong>Try/Catch</strong>. Â ÷åì æå ðàçíèöà ìåæäó çàâåðøàþùèì áëîêîì è ïðîñòûì ðàçìåùåíèåì êîäà ïîñëå áëîêà <strong>try/catch</strong>? Â áîëüøèíñòâå ñëó÷àåâ íèêàêîé ðàçíèöû íå áóäåò. Îäíàêî, åñëè áëîê <strong>try/catch</strong> íàõîäèòñÿ â ôóíêöèè è ïðîèñõîäèò âûõîä èç ôóíêöèè â áëîêå <strong>try</strong> èëè <strong>catch</strong>, òî âîçíèêíåò ñóùåñòâåííîå ðàçëè÷èå:</p>
<empty-line/>
<p><code>function myFunction(){</code></p>
<p><code>try{</code></p>
<p><code>return someValue;</code></p>
<p><code>}catch(err){</code></p>
<p><code>return defaultValue;</code></p>
<p><code>}finally{</code></p>
<p><code>alert('finally!');</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>alert('End!');</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Â ýòîì ñëó÷àå îáà áëîêà <strong>try</strong> è <strong>catch</strong> âîçâðàùàþò çíà÷åíèå. Ìû ïîëó÷èì ñîîáùåíèå "<strong>finally!</strong>", íî íå ïîëó÷èì ñîîáùåíèå "<strong>End!</strong>", ïîòîìó ÷òî ïðîèçîéäåò âûõîä èç ôóíêöèè äî ñîîáùåíèÿ <strong>alert('End!')</strong>. Òî æå ñàìîå îñòàåòñÿ ñïðàâåäëèâûì äëÿ îïåðàòîðîâ <strong>Try/Catch</strong>, êîòîðûå îñóùåñòâëÿþò âûõîä èç òåëà öèêëà <strong>for</strong> èëè <strong>while</strong>, íàïðèìåð:</p>
<empty-line/>
<p><code>for(var i=0; i&lt;10; i++){</code></p>
<p><code>try{</code></p>
<p><code>if(i==5) continue;</code></p>
<p><code>}catch(err){</code></p>
<p><code>// îáðàáîòêà îøèáêè</code></p>
<p><code>}finally{</code></p>
<p><code>// êîä</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>// åùå êîä</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Çàïðîñû <strong>XMLHttp</strong>, ðàññìîòðåííûå â ïðåäûäóùåé ëåêöèè, ìîãóò èìåòü ñîâåðøåííî äðóãîé òèï îøèáêè: äàííûå ïðîñòî íå ïðîõîäÿò. Ýòî ìîæíî ïðîâåðèòü ÷åðåç ñòàòóñ îáúåêòà <strong>XMLHttp</strong>:</p>
<empty-line/>
<p><code>function processingFunction(){</code></p>
<p><code>if(oXml.readyState!=4) return; // çàïðîñ íå âûïîëíåí</code></p>
<empty-line/>
<p><code>switch(oXml.status){</code></p>
<p><code>case 0: case 200: // çàïðîñ âûïîëíåí</code></p>
<p><code>break;</code></p>
<p><code>case 408: case 504: // çàïðîñ ïðåâûñèë âðåìÿ îæèäàíèÿ</code></p>
<p><code>// êîä</code></p>
<p><code>break;</code></p>
<p><code>default: // îøèáêà çàïðîñà</code></p>
<p><code>// êîä</code></p>
<p><code>return; // âîçìîæíî, âû çàõîòèòå âûéòè</code></p>
<p><code>break;</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>// ïðîäîëæåíèå îáðàáîòêè çàïðîñà</code></p>
<p><code>}</code></p>
<empty-line/>
<p><strong>oXml</strong> â ýòîì ïðèìåðå ÿâëÿåòñÿ îáúåêòîì <strong>XMLHttp</strong>, à ôóíêöèÿ <strong>processingFunction</strong> áûëà ïðèñîåäèíåíà ê ñâîéñòâó <strong>onreadystatechange</strong> ýòîãî îáúåêòà.</p>
<p>Ïðîâåðÿÿ êîä ñòàòóñà, ìû óçíàåì, áûë ëè çàïðîñ îáðàáîòàí óñïåøíî. Êîä <strong>200</strong> ÿâëÿåòñÿ â HTTP ñòàíäàðòíûì êîäîì ñòàòóñà "Âñå ïðîøëî íîðìàëüíî" . Êîä <strong>0</strong> âîçíèêàåò ïðè çàãðóçêå ôàéëîâ èç ëîêàëüíîé ôàéëîâîé ñèñòåìû (åñëè äëÿ ýòîãî åñòü ñîîòâåòñòâóþùèå ïîëíîìî÷èÿ). Ñòàòóñ êîä <strong>0</strong> ÷àñòî âîçíèêàåò ïðè ëîêàëüíîì òåñòèðîâàíèè ïðèëîæåíèÿ.</p>
<p>Êîäû ñòàòóñà <strong>408</strong> è <strong>504</strong> ïðåäñòàâëÿþò ñèòóàöèþ ñ ïðåâûøåíèåì âðåìåíè îæèäàíèÿ. Î÷åíü ÷àñòî ýòî óêàçûâàåò íà ñåòåâûå ïðîáëåìû, è ïðîñòîå ïîâòîðåíèå çàïðîñà ìîæåò ðàçðåøèòü ïðîáëåìó. Îäíàêî îòìåòèì, ÷òî ýòè êîäû ïðåäñòàâëÿþò òàêæå ñëèøêîì äëèòåëüíóþ ðàáîòó ñåðâåðà íàä îòâåòîì. Íàïðèìåð, åñëè ñóùåñòâóåò îøèáêà ñöåíàðèÿ íà ñåðâåðå, êîòîðàÿ ïðèâîäèò ê áåñêîíå÷íîìó öèêëó, òî ìîæåò âîçíèêíóòü êîä îøèáêè <strong>408</strong> èëè <strong>504</strong>. Â ýòîì ñëó÷àå ïîâòîðíàÿ ïîïûòêà áóäåò âðåäîíîñíîé, ïîýòîìó íàäî áûòü îñòîðîæíûì. Ñàìûì áåçîïàñíûì ÿâëÿåòñÿ óâåäîìëåíèå ïîëüçîâàòåëÿ è âûõîä èç ôóíêöèè, íî ýòî íå î÷åíü êîððåêòíî ïî îòíîøåíèþ ê ïîëüçîâàòåëþ.</p>
<p>Âñå äðóãèå êîäû îøèáîê èìåþò ñâîè ñîáñòâåííûå çíà÷åíèÿ, íî â äàííîé ñèòóàöèè ýòî íå âàæíî. Íàñ èíòåðåñóåò òîëüêî òî, ÷òî ìû íå ïîëó÷èëè íóæíûå äàííûå. Ïîýòîìó åñëè êîä ïîïàäàåò â îáëàñòü "<strong>default</strong>", òî ìû èìååì ïðîáëåìó. Íàâåðíî â ýòîé ñèòóàöèè ëó÷øå âñåãî ñîîáùèòü ïîëüçîâàòåëþ î ïðîáëåìå è âûéòè èç ôóíêöèè.</p>
<p>Ýòî ïî÷òè âñå îá îáðàáîòêå îøèáîê â <strong>JavaScript</strong>. Èìååò ñìûñë âêëþ÷àòü â ôóíêöèè îáðàáîòêó îøèáîê, íî, âîçìîæíî, ÷òî ýòî íå òðåáóåòñÿ äëÿ êàæäîé ôóíêöèè èëè êàæäîãî ôðàãìåíòà êîäà. Â áîëüøèíñòâå ñèòóàöèé äîñòàòî÷íî ïðîâåðêè ââîäà ïîëüçîâàòåëåé. Äëÿ ðåàëèçàöèè ïðîâåðêè ïîëüçîâàòåëÿ íàèáîëåå ïîëåçíûì ñðåäñòâîì ÿâëÿåòñÿ èñïîëüçîâàíèå áëîêîâ <strong>Try/Catch/Throw</strong>.</p>
<p>Â ñëåäóþùåé ëåêöèè áóäåò ðàññìîòðåíà ðåêóðñèÿ: </p>
<cite>
<p>"×òîáû ïîíÿòü ðåêóðñèþ, ñíà÷àëà íåîáõîäèìî ïîíÿòü ðåêóðñèþ".</p>
</cite>
<empty-line/>
</section>
<section>
<title>
<p><emphasis>Ëåêöèÿ 12.</emphasis> Ðåêóðñèÿ</p>
</title>
<p><emphasis>Ðåêóðñèÿ. Ñòåê. Ñîçäàíèå ñîáñòâåííîãî ñòåêà. Ïðèìåíåíèå ðåêóðñèè. "×òîáû ïîíÿòü ðåêóðñèþ, ñíà÷àëà íåîáõîäèìî ïîíÿòü ðåêóðñèþ".</emphasis></p>
<p>Äàííîå âûñêàçûâàíèå î÷åíü ÷åòêî âûðàæàåò ñóòü ðåêóðñèè. Ðåêóðñèÿ ÿâëÿåòñÿ áàçîâîé êîíöåïöèåé ïðîãðàììèðîâàíèÿ âîîáùå, à íå òîëüêî <strong>JavaScript</strong>, ïîíèìàíèå êîòîðîé î÷åíü ïîëåçíî. Îíà âêëþ÷àåò âûçîâ ôóíêöèè èç òîé æå ñàìîé ôóíêöèè. Ïî÷åìó ýòî ìîæåò ïîíàäîáèòüñÿ? Ïðåäïîëîæèì, ÷òî èìååòñÿ ìàññèâ ìàññèâîâ. Êàæäûé èç ýòèõ ìàññèâîâ ìîæåò èìåòü â ñåáå ìàññèâû, êîòîðûå ìîãóò èìåòü ìàññèâû, êîòîðûå ìîãóò èìåòü ... ñîáñòâåííî, â ýòîì è ñîñòîèò èäåÿ. Òàêèì îáðàçîì ìû èìååì ìíîæåñòâî ìàññèâîâ â äðóãèõ ìàññèâàõ. Êàê âûïîëíèòü îäíó è òó æå îïåðàöèþ íà âñåõ ýëåìåíòàõ âî âñåõ ýòèõ ìàññèâàõ? Ìîæíî ïîïðîáîâàòü èñïîëüçîâàòü ïðîñòîé öèêë <strong>for</strong>, íî íåèçâåñòíî, ñêîëüêî èìååòñÿ ìàññèâîâ, è íåèçâåñòíî, êàê ãëóáîêî ðàñïðîñòðàíÿåòñÿ âëîæåíèå ìàññèâîâ. Ïîýòîìó îñòàåòñÿ òîëüêî êîíöåïöèÿ ðåêóðñèè.</p>
<p>Â ýòîì ïðèìåðå ìû öèêëè÷åñêè ïåðåáèðàåì âñå ýëåìåíòû ìàññèâà ïåðâîãî óðîâíÿ. Åñëè êàêîé-ëèáî èç ýòèõ ýëåìåíòîâ â ìàññèâå ñàì áóäåò ìàññèâîì, ìû ñíîâà âûçûâàåì ôóíêöèþ, ïåðåäàâàÿ ýòîò ýëåìåíò êàê ïåðâè÷íûé ìàññèâ. Çàòåì ôóíêöèÿ áóäåò ïåðåáèðàòü ýòîò ìàññèâ è ñíîâà âûçûâàòü ñåáÿ, ïîêà íå îñòàíåòñÿ íè îäíîãî ìàññèâà.</p>
<p>Äðóãèì õîðîøèì ïðèìåðîì ðåêóðñèè áóäåò íàïèñàíèå ñèíòàêñè÷åñêîãî àíàëèçàòîðà äîêóìåíòà <strong>XML</strong>. Êàæäûé óçåë äîêóìåíòà <strong>XML</strong> ìîæíî àíàëèçèðîâàòü ñîâåðøåííî îäèíàêîâî, ïîýòîìó ìû ìîæåì ðàçáèòü âñþ çàäà÷ó íà ìíîæåñòâî áîëåå ìåëêèõ îäèíàêîâûõ øàãîâ.</p>
<p>Ñàìûì òðóäíûì â ðåêóðñèè ÿâëÿåòñÿ åå ïîíèìàíèå. Òàêèå êîíöåïöèè, êàê öèêëû, âîñïðèíèìàþòñÿ äîñòàòî÷íî åñòåñòâåííî, â òî âðåìÿ êàê ðåêóðñèÿ òðóäíà äëÿ áîëüøèíñòâà ëþäåé. Ðåêóðñèâíûå ôóíêöèè òàêæå î÷åíü ÷àñòî òðåáóþò áîëüøå ïàìÿòè, ÷åì íåðåêóðñèâíûå ôóíêöèè. Åñëè èìååòñÿ ôóíêöèÿ, êîòîðàÿ âûçûâàåò ñåáÿ íà <strong>20</strong> óðîâíåé âãëóáü, ïîòðåáóåòñÿ êàê ìèíèìóì â <strong>20</strong> ðàç áîëüøå ïàìÿòè.</p>
<p>Ïðîñòûì ïðèìåðîì áóäåò íàïèñàíèå ðåêóðñèâíîé ôóíêöèè ôàêòîðèàëà. Ôàêòîðèàë <strong>N</strong>, çàïèñûâàåìûé êàê <strong>N!</strong>, îïðåäåëÿåòñÿ êàê ïðîèçâåäåíèå âñåõ ÷èñåë îò <strong>N</strong> äî <strong>1</strong>. Ïîýòîìó <strong>5!</strong> áóäåò ðàâåí <strong>5*4*3*2*1 = 120</strong>.</p>
<empty-line/>
<p><code>function factorial(N){</code></p>
<p><code>return N&lt;=1?1:N*factorial(N-1);</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Äåìîíñòðàöèîííûé ïðèìåð. Ôàêòîðèàë</p>
<empty-line/>
<p>Î÷åíü ýëåãàíòíîå ðåøåíèå, íå ïðàâäà ëè? Â ðåçóëüòàòå ìû âûçûâàåì ôóíêöèþ ôàêòîðèàëà <strong>5</strong> ðàç äëÿ <strong>N = 5</strong>. Ìîæíî â äåéñòâèòåëüíîñòè ðàçâåðíóòü âñþ ðåêóðñèâíóþ ôóíêöèþ è ïîëó÷èòü <strong>(5*(4*(3*(2*(1)))))</strong>. Êàæäàÿ ïàðà ñêîáîê ïðåäñòàâëÿåò íîâûé âûçîâ ôóíêöèè ôàêòîðèàëà. Ìîæíî òàêæå âèäåòü, ÷òî åñëè ïîëüçîâàòåëü ââîäèò ÷èñëî <strong>&lt;=1</strong>, òî âñåãäà ïîëó÷èò â êà÷åñòâå ðåçóëüòàòà <strong>1</strong>.</p>
<p>Äàâàéòå ðàññìîòðèì äðóãîé ïðèìåð. Ïðè ðàáîòå ñ ïðîãðàììàìè ðèñîâàíèÿ, òàêèìè, êàê <strong>Photoshop</strong> èëè <strong>MS Paint</strong>, èíîãäà èñïîëüçóåòñÿ èíñòðóìåíò çàëèâêè (<strong>flood fill</strong>). Ýòîò èíñòðóìåíò çàëèâàåò âûáðàííûé öâåò äðóãèì, óêàçàííûì öâåòîì. Ýòî äåëàåòñÿ ðåêóðñèâíî, è àëãîðèòì çàëèâêè äîñòàòî÷íî ïðÿìîëèíååí:</p>
<empty-line/>
<p><code>/*</code></p>
<p><code>ýòî – ïñåâäîêîä, áûñòðî íàïèñàííûé è íå ôóíêöèîíàëüíûé,</code></p>
<p><code>êîòîðûé äîëæåí ïðîñòî äàòü îáùóþ èäåþ î òîì, êàê äåéñòâóåò</code></p>
<p><code>ðåàëüíûé êîä</code></p>
<p><code>*/</code></p>
<empty-line/>
<p><code>function floodFill(x, y){</code></p>
<p><code>if(alreadyFilled(x, y)) return;</code></p>
<p><code>fill(x, y);</code></p>
<empty-line/>
<p><code>floodFill(x, y-1);</code></p>
<p><code>floodFill(x+1, y );</code></p>
<p><code>floodFill(x, y+1);</code></p>
<p><code>floodFill(x-1, y );</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function fill(x, y){</code></p>
<p><code>// ýòà ôóíêöèÿ áóäåò ôàêòè÷åñêè èçìåíÿòü öâåò ïîëÿ</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function alreadyFilled(x, y){</code></p>
<p><code>// ýòà ôóíêöèÿ ïðîâåðÿåò, ÷òî ïîëå óæå áûëî çàêðàøåíî</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Èäåÿ ýòîãî êîäà ñîñòîèò â òîì, ÷òîáû çàêðàñèòü òåêóùèé êâàäðàò èëè ïèêñåëü. Çàòåì îí ïûòàåòñÿ çàêðàñèòü êâàäðàò âûøå, ñïðàâà, íèæå è ñëåâà îò ñåáÿ. Ïðè òàêîì àëãîðèòìå êàæäûé êâàäðàò áóäåò çàêðàøåí äîñòàòî÷íî áûñòðî. Îäíàêî çäåñü âîçíèêàåò íåáîëüøàÿ ïðîáëåìà – ðàçìåð ñòåêà.</p>
<p>Ïðè âûçîâå ôóíêöèè êîïèÿ ìíîæåñòâà ïåðåìåííûõ, êîòîðûå íóæíû åé äëÿ ðàáîòû, ñîõðàíÿåòñÿ â ïàìÿòè. Åñëè ôóíêöèÿ âûçûâàåòñÿ ðåêóðñèâíî, òî äðóãàÿ êîïèÿ âñåõ ýòèõ ïåðåìåííûõ ñîõðàíÿåòñÿ â ïàìÿòè, çàòåì åùå îäíà è ò.ä. Ýòè êîïèè ïåðåìåííûõ ñîõðàíÿþòñÿ â òàê íàçûâàåìîì ñòåêå. Ïåðâàÿ êîïèÿ íàõîäèòñÿ âíèçó, ñëåäóþùàÿ ïîâåðõ íåå, è ò.ä. Ê ñîæàëåíèþ, ñóùåñòâóåò îãðàíè÷åíèå íà ðàçìåð ñòåêà. Â áîëüøèíñòâå áðàóçåðîâ ýòîò ïðåäåë îïðåäåëåí ãäå-òî â ðàéîíå <strong>1000</strong>. Ýòî îçíà÷àåò, ÷òî äëÿ ôóíêöèè çàëèâêè ñåòêà ìîãëà áû ñîäåðæàòü äî <strong>1000</strong> êâàäðàòîâ. Íåêîòîðûå áðàóçåðû èìåþò ìåíüøèé ðàçìåð ñòåêà. Web-áðàóçåð <strong>Safari</strong>, íàïðèìåð, èìååò ìàêñèìàëüíûé ðàçìåð ñòåêà, ðàâíûé ïðèìåðíî <strong>100</strong>, ïîýòîìó äàæå íåáîëüøàÿ ñåòêà <strong>10 õ 10</strong> èñ÷åðïàåò âîçìîæíîñòè áðàóçåðà.</p>
<p>Òàêèì îáðàçîì ìû èìååì îãðàíè÷åíèå â ñàìîì áðàóçåðå, êîòîðîå îïðåäåëÿåò, ÷òî ïðè èñïîëüçîâàíèè ðåêóðñèè ìîæíî óãëóáèòüñÿ òîëüêî íà <strong>1000</strong> óðîâíåé. Ê ñîæàëåíèþ, íàø àëãîðèòì <strong>floodFill</strong> (çàëèâêè) áóäåò â õóäøåì ñëó÷àå óãëóáëÿòüñÿ íà <strong>1000</strong> óðîâíåé íà ñåòêå, ñîäåðæàùåé òîëüêî <strong>1000</strong> ïîëåé. Åñëè èìååòñÿ ÷òî-òî áîëåå ñëîæíîå, òî ñóùåñòâóåò âåðîÿòíîñòü, ÷òî ïðîèçîéäåò ïåðåïîëíåíèå ñòåêà è ïðîñòî îñòàíîâêà âûïîëíåíèÿ êîäà. Î÷åâèäíî, ÷òî ñóùåñòâóþò ñèòóàöèè, êîãäà íåîáõîäèìî çàêðàñèòü îáëàñòü, ñîäåðæàùóþ áîëåå <strong>1000</strong> ïèêñåëåé. ×òî äåëàòü â òàêîì ñëó÷àå? Ïîïðîáóåì èçìåíèòü ïîäõîä.</p>
<p>Ïðåæäå âñåãî ïîïðîáóåì èçìåíèòü àëãîðèòì. Ñóùåñòâóåò ìíîãî ðàçëè÷íûõ àëãîðèòìîâ çàêðàñêè – ìû èñïîëüçîâàëè îäèí èç ñàìûõ ïðîñòûõ. Îí ïðîâåðÿåò âñå íàïðàâëåíèÿ è çàòåì çàêðàøèâàåò êàæäûé ïðîñìîòðåííûé êâàäðàò, åñëè ýòî áóäåò íåîáõîäèìî. Ñ ïîìîùüþ íåáîëüøîãî èçìåíåíèÿ ìîæíî ñóùåñòâåííî óëó÷øèòü ýòîò àëãîðèòì, ñ òî÷êè çðåíèÿ íåîáõîäèìîãî ïðîñòðàíñòâà ñòåêà. Âìåñòî ïðîñìîòðà âëåâî è âïðàâî íà <strong>1</strong> êâàäðàò, ìîæíî ïðîñìàòðèâàòü âëåâî è âïðàâî íà ìàêñèìàëüíî âîçìîæíîå êîëè÷åñòâî ïîçèöèé è çàêðàøèâàòü êàæäûé ïèêñåëü â ýòîì íàïðàâëåíèè. Ýòî íàçûâàåòñÿ àëãîðèòìîì çàêðàøèâàíèÿ ñî ñêàíèðîâàíèåì ïî ëèíèÿì, êîòîðûé îêàçûâàåòñÿ îäíèì èç íàèáîëåå ýôôåêòèâíûõ ñóùåñòâóþùèõ àëãîðèòìîâ çàêðàøèâàíèÿ. Ê ñîæàëåíèþ, îí âñå åùå èìååò ñâîè îãðàíè÷åíèÿ, è äëÿ äîñòàòî÷íî áîëüøîé îáëàñòè çàêðàøèâàíèÿ îí òàêæå ìîæåò ïåðåïîëíÿòü ñòåê.</p>
<p>Åñëè ýòî ïðîèçîéäåò, òî îñòàåòñÿ åäèíñòâåííûé âàðèàíò: íå èñïîëüçîâàòü ðåêóðñèþ. Âìåñòî èñïîëüçîâàíèÿ ñòåêà <strong>JavaScript</strong> ìîæíî ñîçäàòü ñâîé ñîáñòâåííûé ñ ïîìîùüþ ïðîñòîãî ìàññèâà <strong>JavaScript</strong>. Òàê êàê ìàññèâ íå èìååò îãðàíè÷åíèé íà êîëè÷åñòâî ýëåìåíòîâ ìàññèâà, òî ìîæíî ïîëó÷èòü "áåñêîíå÷íî" áîëüøîé ñòåê, êîòîðûì ìû óïðàâëÿåì ñàìîñòîÿòåëüíî.</p>
<p>×òîáû ñîçäàòü ñâîé ñîáñòâåííûé ñòåê, íåîáõîäèìî óäàëèòü ðåêóðñèâíóþ ÷àñòü íàøåé ôóíêöèè. Ìû âñå ðàâíî ñîáèðàåìñÿ ìíîãîêðàòíî âûçûâàòü ôóíêöèþ, íî ñîáèðàåìñÿ âûçûâàòü åå èç äðóãîé ôóíêöèè, à íå èç ñåáÿ ñàìîé.</p>
<empty-line/>
<p><code>var Stack = [];</code></p>
<empty-line/>
<p><code>function floodFill(x, y){</code></p>
<p><code>fillPixel(x, y);</code></p>
<empty-line/>
<p><code>while(Stack.length&gt;0){</code></p>
<p><code>toFill = Stack.pop();</code></p>
<p><code>fillPixel(toFill[0], toFill[1]);</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function fillPixel(x, y){</code></p>
<p><code>if(!alreadyFilled(x, y)) fill(x, y);</code></p>
<empty-line/>
<p><code>if(!alreadyFilled(x, y-1)) Stack.push([x, y-1]);</code></p>
<p><code>if(!alreadyFilled(x+1, y )) Stack.push([x+1, y ]);</code></p>
<p><code>if(!alreadyFilled(x, y+1)) Stack.push([x, y+1]);</code></p>
<p><code>if(!alreadyFilled(x-1, y )) Stack.push([x-1, y ]);</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function fill(x, y){</code></p>
<p><code>// ýòà ôóíêöèÿ áóäåò ôàêòè÷åñêè èçìåíÿòü öâåò ïîëÿ</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function alreadyFilled(x, y){</code></p>
<p><code>// ýòà ôóíêöèÿ ïðîâåðÿåò, ÷òî êâàäðàò åùå íå áûë çàêðàøåí</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Êàê ìîæíî âèäåòü, ïðîöåññ íå íàìíîãî ñëîæíåå, íî òðåáóåò íåìíîãî áîëüøå ìèêðîóïðàâëåíèÿ, ÷åì íàïèñàííûé ðàíåå ðåêóðñèâíûé êîä. Âìåñòî ðåêóðñèâíîãî âûçîâà ôóíêöèè <strong>floodFill</strong> ñîçäàåòñÿ ïåðåìåííàÿ <strong>Stack</strong>, ñîäåðæàùàÿ ñïèñîê êâàäðàòîâ, êîòîðûå íåîáõîäèìî çàêðàñèòü. Çàòåì ôóíêöèÿ <strong>fillPixel</strong> çàïîëíÿåò ýòîò ìàññèâ, à ôóíêöèÿ <strong>floodFill</strong> èçâëåêàåò ïîñëåäíèé ýëåìåíò è çàêðàøèâàåò åãî. Êîãäà âñå áóäåò ñäåëàíî, ðåçóëüòàò áóäåò òàêèì æå, êàê è ó ïåðâîé ôóíêöèè, êîòîðàÿ áûëà íàïèñàíà, ñ îäíèì èñêëþ÷åíèåì: ýòà ôóíêöèÿ íå èìååò íèêàêèõ îãðàíè÷åíèé â îòíîøåíèè âåëè÷èíû ñåòêè.</p>
<p>Îòìåòèì, ÷òî ñóùåñòâóåò î÷åíü íåìíîãî ðåêóðñèâíûõ ôóíêöèé, êîòîðûå áóäóò ðåàëüíî ïåðåïîëíÿòü ñòåê <strong>JavaScript</strong>. Â äåéñòâèòåëüíîñòè ýòî íå ñîâñåì âåðíî. Ïî÷òè ëþáàÿ ðåêóðñèâíàÿ ôóíêöèÿ ìîæåò ïåðåïîëíèòü ñòåê, íî ÷àùå âñåãî äàííûå, êîòîðûå ôóíêöèÿ ïîëó÷àåò îò ïîëüçîâàòåëÿ, äåëàþò ýòî êðàéíå ìàëîâåðîÿòíûì ñîáûòèåì. Êîãäà, íàïðèìåð, âû âñòðåòèòå äîêóìåíò <strong>XML</strong> ñ ãëóáèíîé âëîæåíèÿ óçëîâ, ðàâíîé <strong>1000</strong>? Ïî÷òè íàâåðíÿêà – íèêîãäà.</p>
<p>Òåïåðü, èìåÿ íåêîòîðîå ïðåäñòàâëåíèå î ðåêóðñèè, íàäî ïîïûòàòüñÿ ïîíÿòü, ÷òî ñ íåé ìîæíî äåëàòü, êðîìå çàêðàøèâàíèÿ èçîáðàæåíèé. Îäíèì èç íàèáîëåå ðàñïðîñòðàíåííûõ ðåêóðñèâíûõ àëãîðèòìîâ áóäåò òàê íàçûâàåìûé äâîè÷íûé ïîèñê. Ýòî ìîæíî ïðåäñòàâèòü ñåáå êàê èãðó íà áîëüøå-ìåíüøå. Åñëè êòî-òî ïðåäëàãàåò óãàäàòü ÷èñëî îò <strong>1</strong> äî <strong>100</strong>, òî, ñêîðåå âñåãî, íà÷àòü ëó÷øå ñ <strong>50</strong>. Åñëè ïàðòíåð ñêàæåò, ÷òî áîëüøå, òî ìîæíî ïðåäïîëîæèòü <strong>75</strong> è ò.ä. Ýòî ìîæíî ïðîäîëæàòü, ïîêà ÷èñëî íå áóäåò íàéäåíî.</p>
<p>Êàê îêàçûâàåòñÿ, ýòî îäèí èç ñàìûõ áûñòðûõ ñïîñîáîâ ïîèñêà äàííûõ, êîãäà èçâåñòíî, ÷òî âñå äàííûå óæå îòñîðòèðîâàíû. Åñëè èìååòñÿ ñïèñîê èç <strong>1000000</strong> ïîçèöèé è òðåáóåòñÿ íàéòè îäíó èç íèõ, òî ìîæíî íà÷àòü ñ <strong>500000</strong> è èñïîëüçîâàòü òîò æå ïðîöåññ, ÷òî è â èãðå "áîëüøå-ìåíüøå".</p>
<p>Äëÿ ñîðòèðîâêè ïðèìåíÿþòñÿ ñïåöèàëüíûå àëãîðèòìû. Ìíîãèå àëãîðèòìû ñîðòèðîâêè, âêëþ÷àÿ îäèí èç ñàìûõ áûñòðûõ, <strong>QuickSort</strong>, èñïîëüçóþò ðåêóðñèþ. Àëãîðèòì <strong>QuickSort</strong> ðàçáèâàåò äàííûå íà ôðàãìåíòû, ñîðòèðóåò êàæäûé ôðàãìåíò ïî îòäåëüíîñòè, ðåêóðñèâíî ðàçáèâàåò ôðàãìåíòû íà ìåíüøèå ôðàãìåíòû è ñîðòèðóåò èõ.</p>
<p>Äðóãèì øèðîêî ðàñïðîñòðàíåííûì èñïîëüçîâàíèåì ðåêóðñèè ÿâëÿåòñÿ ïðîâåðêà èëè ñèíòàêñè÷åñêèé àíàëèç íåêîòîðûõ äàííûõ. Ðàíåå â êà÷åñòâå ïðèìåðà óïîìèíàëñÿ ôàéë <strong>XML</strong>, íî ñ ïîìîùüþ ðåêóðñèè ìîæíî ýôôåêòèâíî âûïîëíÿòü ìíîãèå äðóãèå ôîðìû ñèíòàêñè÷åñêîãî àíàëèçà, òàêèå, êàê ïîäñ÷åò êîëè÷åñòâà âõîæäåíèé ñëîâà èëè ôðàçû â ïðåäëîæåíèè èëè êíèãå.</p>
<p>Ðåêóðñèÿ ÿâëÿåòñÿ êðàéíå ïîëåçíîé êîíöåïöèåé. Ðåêóðñèÿ ìîæåò èñïîëüçîâàòüñÿ íå òàê ÷àñòî, íî êîãäà îíà íàõîäèò ïðèìåíåíèå, îíà ñóùåñòâåííî îáëåã÷àåò æèçíü ïðîãðàììèñòà.</p>
</section>
<section>
<title>
<p><emphasis>Äîïîëíåíèå I.</emphasis> Êðàòêîå ðóêîâîäñòâî ïî AJAX</p>
</title>
<p>Òåõíîëîãèÿ AJAX ÿâëÿåòñÿ íå íîâûì ÿçûêîì ïðîãðàììèðîâàíèÿ, à ïðîñòî íîâûì ñïîñîáîì èñïîëüçîâàíèÿ ñóùåñòâóþùèõ ñòàíäàðòîâ.</p>
<p>Ñ ïîìîùüþ AJAX ìîæíî ñîçäàâàòü Web-ïðèëîæåíèÿ, êîòîðûå áóäóò ëó÷øå, áûñòðåå è óäîáíåå äëÿ ïîëüçîâàòåëåé, ÷åì ñóùåñòâóþùèå.</p>
<p>AJAX îñíîâûâàåòñÿ íà JavaScript è çàïðîñàõ HTTP.</p>
<p>AJAX ÿâëÿåòñÿ ñîêðàùåíèåì îò "Asynchronous JavaScript And XML" (Àñèíõðîííûé JavaScript è XML).</p>
<p>AJAX ÿâëÿåòñÿ íå íîâûì ÿçûêîì ïðîãðàììèðîâàíèÿ, à ïðîñòî íîâûì ñïîñîáîì ñîçäàíèÿ Web-ïðèëîæåíèé, êîòîðûå áóäóò ëó÷øå, áûñòðåå, è áîëåå èíòåðàêòèâíûìè.</p>
<p>AJAX èñïîëüçóåò JavaScript äëÿ îòïðàâêè è ïîëó÷åíèÿ äàííûõ ïðè âçàèìîäåéñòâèè Web-áðàóçåðà è Web-ñåðâåðà.</p>
<p>Òåõíîëîãèÿ AJAX äåëàåò Web-ñòðàíèöû áîëåå ãèáêèìè è áûñòðî ðåàãèðóþùèìè, îñóùåñòâëÿÿ îáìåí äàííûìè ñ Web-ñåðâåðîì â ôîíîâîì ðåæèìå, à íå ïåðåçàãðóæàÿ âñþ Web-ñòðàíèöó âñÿêèé ðàç, êîãäà ïîëüçîâàòåëü äåëàåò èçìåíåíèå.</p>
<p>AJAX ÿâëÿåòñÿ òåõíîëîãèåé, êîòîðàÿ âûïîëíÿåòñÿ â áðàóçåðå êëèåíòà. Îíà èñïîëüçóåò àñèíõðîííóþ ïåðåäà÷ó äàííûõ (çàïðîñû HTTP) ìåæäó áðàóçåðîì è Web-ñåðâåðîì, ïîçâîëÿÿ Web-ñòðàíèöàì çàïðàøèâàòü ñ ñåðâåðà íåáîëüøèå îáúåìû äàííûõ âìåñòî öåëûõ ñòðàíèö.</p>
<p>Ýòà òåõíîëîãèÿ ïîçâîëÿåò óìåíüøèòü îáúåì ïðèëîæåíèé Èíòåðíåò, ñäåëàòü èõ áîëåå áûñòðûìè è áîëåå óäîáíûìè äëÿ ïîëüçîâàòåëåé.</p>
<p>AJAX ÿâëÿåòñÿ òåõíîëîãèåé Web-áðàóçåðà, êîòîðàÿ íå çàâèñèò îò ïðîãðàììíîãî îáåñïå÷åíèÿ Web-ñåðâåðà.</p>
<p>AJAX èñïîëüçóåò ñëåäóþùèå îòêðûòûå ñòàíäàðòû:</p>
<p><strong>JavaScript</strong></p>
<p><strong>XML</strong></p>
<p><strong>HTML</strong></p>
<p><strong>CSS</strong></p>
<p>Èñïîëüçóåìûå â AJAX îòêðûòûå ñòàíäàðòû ñòðîãî îïðåäåëåíû è ïîääåðæèâàþòñÿ âñåìè îñíîâíûìè áðàóçåðàìè. Ïðèëîæåíèÿ AJAX íå çàâèñÿò îò èñïîëüçóåìûõ áðàóçåðîâ è ïëàòôîðì.</p>
<p>Web-ïðèëîæåíèÿ èìåþò ìíîæåñòâî ïðåèìóùåñòâ ïðè ñðàâíåíèè ñ òðàäèöèîííûìè ïðèëîæåíèÿìè íàñòîëüíûõ êîìïüþòåðîâ. Îíè èìåþò áîëåå îáøèðíóþ àóäèòîðèþ, èõ ëåã÷å óñòàíàâëèâàòü è ïîääåðæèâàòü, è èõ ëåã÷å ðàçðàáàòûâàòü.</p>
<p>Îäíàêî ïðèëîæåíèÿ Èíòåðíåò íå âñåãäà áûâàþò äîñòàòî÷íî "áîãàòû" ñâîéñòâàìè è óäîáíû äëÿ èñïîëüçîâàíèÿ ïî ñðàâíåíèþ ñ òðàäèöèîííûìè ïðèëîæåíèÿìè.</p>
<p>Ñ ïîìîùüþ AJAX ïðèëîæåíèÿ Èíòåðíåò ìîæíî ñäåëàòü áîãà÷å (ìåíüøå, áûñòðåå, è ëåã÷å â èñïîëüçîâàíèè).</p>
<p>Íåò íè÷åãî íîâîãî, ÷òî òðåáóåò èçó÷åíèÿ.</p>
<p>Òåõíîëîãèÿ AJAX îñíîâûâàåòñÿ íà îòêðûòûõ ñòàíäàðòàõ. Ýòè ñòàíäàðòû èñïîëüçîâàëèñü ìíîæåñòâîì ðàçðàáîò÷èêîâ ìíîãèå ãîäû.</p>
<p>Áîëüøèíñòâî ñóùåñòâóþùèõ Web-ïðèëîæåíèé ìîæíî ëåãêî ïåðåïèñàòü ñ ïîìîùüþ òåõíîëîãèè AJAX âìåñòî òðàäèöèîííûõ ôîðì HTML.</p>
<p>Òðàäèöèîííîå Web-ïðèëîæåíèå ïîñûëàåò ââåäåííûå äàííûå íà Web-ñåðâåð (èñïîëüçóÿ ôîðìó HTML). Ïîñëå îáðàáîòêè äàííûõ Web-ñåðâåð âîçâðàùàåò ïîëüçîâàòåëþ ñîâåðøåííî íîâóþ Web-ñòðàíèöó.</p>
<p>Òàê êàê ñåðâåð âîçâðàùàåò íîâóþ Web-ñòðàíèöó âñÿêèé ðàç, êîãäà ïîëüçîâàòåëü ïîñûëàåò äàííûå íà ñåðâåð, òî òðàäèöèîííîå Web-ïðèëîæåíèå ÷àñòî âûïîëíÿåòñÿ ìåäëåííî è îêàçûâàåòñÿ ìåíåå óäîáíûì äëÿ ïîëüçîâàòåëÿ.</p>
<p>Ñ ïîìîùüþ AJAX Web-ïðèëîæåíèÿ ìîãóò ïîñûëàòü è ïîëó÷àòü äàííûå áåç ïåðåçàãðóçêè âñåé Web-ñòðàíèöû. Ýòî äåëàåòñÿ ñ ïîìîùüþ çàïðîñîâ HTTP, ïîñûëàåìûõ íà ñåðâåð (â ôîíîâîì ðåæèìå), è ìîäèôèêàöèè òîëüêî îòäåëüíûõ ÷àñòåé Web-ñòðàíèöû ñ ïîìîùüþ JavaScript, êîãäà ñåðâåð âîçâðàùàåò äàííûå.</p>
<p>XML èñïîëüçóåòñÿ îáû÷íî â êà÷åñòâå ôîðìàòà äëÿ ïîëó÷åíèÿ äàííûõ ñåðâåðà, õîòÿ ìîæíî èñïîëüçîâàòü ëþáîé ôîðìàò, âêëþ÷àÿ îáû÷íûé òåêñò.</p>
<p>Êàê ýòî äåëàåòñÿ, áóäåò ïîêàçàíî äàëåå â ýòîì êðàòêîì ðóêîâîäñòâå.</p>
<p>Òåõíîëîãèþ AJAX ìîæíî èñïîëüçîâàòü äëÿ ñîçäàíèÿ ïðèëîæåíèé ñ áîëüøèìè èíòåðàêòèâíûìè âîçìîæíîñòÿìè.</p>
<p>Â ñëåäóþùåì ïðèìåðå ïðèëîæåíèÿ AJAX ïîêàçàíî, êàê Web-ñòðàíèöà ìîæåò îïåðàòèâíî îáùàòüñÿ ñ Web-ñåðâåðîì, êîãäà ïîëüçîâàòåëü ââîäèò äàííûå â Web-ôîðìó.</p>
<p>Íà ñòðàíèöå âûâîäèòñÿ ïîëå ââîäà ñ ïðåäëîæåíèåì ââåñòè èìÿ. Êîãäà ïîëüçîâàòåëü íà÷èíàåò ââîäèòü â ýòîì ïîëå èìÿ, íèæå ïîÿâëÿþòñÿ âîçìîæíûå âàðèàíòû èìåí.</p>
<p>Ïóñòü íà Web-ñòðàíèöå èìååòñÿ ôîðìà HTML ñî ñëåäóþùèì êîäîì:</p>
<empty-line/>
<p>&lt;form&gt;</p>
<p><code>Èìÿ:</code></p>
<p><code>&lt;input type="text" id="txt1"</code></p>
<p><code>onkeyup="showHint(this.value)"&gt;</code></p>
<p><code>&lt;/form&gt;</code></p>
<p><code>&lt;p&gt;Ñîâåòóåì: &lt;span id="txtHint"&gt;&lt;/span&gt;&lt;/p&gt;</code></p>
<empty-line/>
<p>Êàê ìîæíî âèäåòü, ýòî ïðîñòàÿ ôîðìà HTML ñ ïîëåì ââîäà ñ èìåíåì "txt1".</p>
<p>Àòðèáóò ñîáûòèÿ ýòîãî ïîëÿ ââîäà îïðåäåëÿåò ôóíêöèþ, êîòîðàÿ áóäåò çàïóñêàòüñÿ ïðè âîçíèêíîâåíèè ñîáûòèÿ onkeyup.</p>
<p>Ïàðàãðàô íèæå ôîðìû ñîäåðæèò òåã <strong>span</strong> ñ èìåíåì "txtHint". Òåã <strong>span</strong> èñïîëüçóåòñÿ â êà÷åñòâå ïîëÿ äëÿ ïîäñòàíîâêè äàííûõ, ïîëó÷àåìûõ ñ Web-ñåðâåðà.</p>
<p>Êîãäà ïîëüçîâàòåëü ââîäèò äàííûå, âûïîëíÿåòñÿ ôóíêöèÿ ñ èìåíåì "showHint()". Âûïîëíåíèå ôóíêöèè çàïóñêàåòñÿ ñîáûòèåì "onkeyup". Äðóãèìè ñëîâàìè, âñÿêèé ðàç, êîãäà ïîëüçîâàòåëü óáèðàåò ñâîé ïàëåö ñ êëàâèàòóðû âíóòðè ïîëÿ ââîäà (îòïóñêàåò íàæàòóþ êëàâèøó), âûçûâàåòñÿ ôóíêöèÿ <strong>showHint</strong>.</p>
<p>Ôóíêöèÿ <strong>showHint()</strong> ÿâëÿåòñÿ î÷åíü ïðîñòîé ôóíêöèåé JavaScript, ïîìåùåííîé â ðàçäåë çàãîëîâêà <strong>&lt;head&gt;</strong> ñòðàíèöû HTML.</p>
<p>Ôóíêöèÿ èìååò ñëåäóþùèé êîä:</p>
<empty-line/>
<p>function showHint(str)</p>
<p><code>{</code></p>
<p><code>if (str.length==0)</code></p>
<p><code>{</code></p>
<p><code>document.getElementById("txtHint").innerHTML=""</code></p>
<p><code>return</code></p>
<p><code>}</code></p>
<p><code>xmlHttp=GetXmlHttpObject()</code></p>
<p><code>if (xmlHttp==null)</code></p>
<p><code>{</code></p>
<p><code>alert ("Áðàóçåð íå ïîääåðæèâàåò çàïðîñû HTTP")</code></p>
<p><code>return</code></p>
<p><code>}</code></p>
<p><code>var url="gethint.asp"</code></p>
<p><code>url=url+"?q="+str</code></p>
<p><code>url=url+"&amp;sid="+Math.random()</code></p>
<p><code>xmlHttp.onreadystatechange=stateChanged</code></p>
<p><code>xmlHttp.open("GET",url,true)</code></p>
<p><code>xmlHttp.send(null)</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Ôóíêöèÿ âûïîëíÿåòñÿ âñÿêèé ðàç, êîãäà â ïîëå ââîäà ââîäèòñÿ ñèìâîë.</p>
<p>Åñëè èìååòñÿ êàêîé-òî ââîä â òåêñòîâîå ïîëå (<strong>str.length &gt; 0</strong>), òî ôóíêöèÿ âûïîëíÿåò ñëåäóþùåå:</p>
<p><strong>[x]</strong> Îïðåäåëÿåò url (èìÿ ôàéëà) äëÿ îòïðàâêè íà ñåðâåð</p>
<p><strong>[x]</strong> Äîáàâëÿåò ê url ïàðàìåòð (<strong>q</strong>) ñ ñîäåðæèìûì ïîëÿ ââîäà</p>
<p><strong>[x]</strong> Äîáàâëÿåò ñëó÷àéíîå ÷èñëî, ÷òîáû ñåðâåð íå èñïîëüçîâàë êýøèðîâàííûé ôàéë</p>
<p><strong>[x]</strong> Ñîçäàåò îáúåêò XMLHTTP, è ïðèêàçûâàåò îáúåêòó âûïîëíèòü ôóíêöèþ ñ èìåíåì <strong>stateChanged</strong>, êîãäà ïðîèçîéäåò èçìåíåíèå.</p>
<p><strong>[x]</strong> Îòêðûâàåò îáúåêò <strong>XMLHTTP</strong> ñ çàäàííûì url.</p>
<p><strong>[x]</strong> Ïîñûëàåò çàïðîñ HTTP íà ñåðâåð</p>
<p>Åñëè ïîëå ââîäà áóäåò ïóñòûì, òî ôóíêöèÿ ïðîñòî î÷èùàåò ñîäåðæèìîå ïîëÿ äëÿ ïîäñòàíîâêè <strong>txtHint</strong>.</p>
<p>Ôóíêöèÿ <strong>stateChanged()</strong> ñîäåðæèò ñëåäóþùèé êîä:</p>
<empty-line/>
<p>function stateChanged()</p>
<p><code>{</code></p>
<p><code>if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete")</code></p>
<p><code>{</code></p>
<p><code>document.getElementById("txtHint").innerHTML=xmlHttp.responseText</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Ôóíêöèÿ <strong>stateChanged()</strong> âûïîëíÿåòñÿ âñÿêèé ðàç, êîãäà èçìåíÿåòñÿ ñîñòîÿíèå îáúåêòà XMLHTTP.</p>
<p>Êîãäà ñîñòîÿíèå áóäåò ðàâíî 4 (èëè "complete"), ïîëå äëÿ ïîäñòàíîâêè <strong>txtHint</strong> ïîëó÷àåò ñîäåðæèìîå òåêñòà ïðèøåäøåãî îòâåòà.</p>
<p>Ïðèëîæåíèÿ AJAX ìîãóò âûïîëíÿòüñÿ òîëüêî â Web-áðàóçåðàõ ñ ïîääåðæêîé XML.</p>
<p>Ïðèëîæåíèÿ AJAX ìîãóò âûïîëíÿòüñÿ òîëüêî â Web-áðàóçåðàõ ñ ïîëíîé ïîääåðæêîé XML, ò.å. âñåìè îñíîâíûìè ñîâðåìåííûìè áðàóçåðàìè.</p>
<p>Ïðåäûäóùèé ïðèìåð âûçûâàåò ôóíêöèþ ñ èìåíåì <strong>GetXmlHttpObject</strong>.</p>
<p>Ýòà ôóíêöèÿ ïðåäíàçíà÷åíà äëÿ ðåøåíèÿ ïðîáëåìû ñîçäàíèÿ ðàçëè÷íûõ îáúåêòîâ <strong>XMLHTTP</strong> äëÿ ðàçëè÷íûõ áðàóçåðîâ.</p>
<p>Ôóíêöèÿ èìååò ñëåäóþùèé êîä:</p>
<empty-line/>
<p>function GetXmlHttpObject(handler)</p>
<p><code>{</code></p>
<p><code>var objXMLHttp=null</code></p>
<p><code>if (window.XMLHttpRequest)</code></p>
<p><code>{</code></p>
<p><code>objXMLHttp=new XMLHttpRequest()</code></p>
<p><code>}</code></p>
<p><code>else if (window.ActiveXObject)</code></p>
<p><code>{</code></p>
<p><code>objXMLHttp=new ActiveXObject("Microsoft.XMLHTTP")</code></p>
<p><code>}</code></p>
<p><code>return objXMLHttp</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Äàëåå ïîêàçàí ïîëíûé èñõîäíûé êîä ðàññìîòðåííîãî âûøå ïðèìåðà AJAX.</p>
<p>Ýòà ñòðàíèöà HTML ñîäåðæèò ïðîñòóþ ôîðìó HTML è ññûëêó íà ôàéë JavaScript.</p>
<empty-line/>
<p><code>&lt;html&gt;</code></p>
<p><code>&lt;head&gt;</code></p>
<p><code>&lt;script src="clienthint.js"&gt;&lt;/script&gt;</code></p>
<p><code>&lt;/head&gt;</code></p>
<p><code>&lt;body&gt;</code></p>
<p><code>&lt;form&gt;</code></p>
<p><code>Èìÿ:</code></p>
<p><code>&lt;input type="text" id="txt1"</code></p>
<p><code>onkeyup="showHint(this.value)"&gt;</code></p>
<p><code>&lt;/form&gt;</code></p>
<p><code>&lt;p&gt;Ñîâåòóåì: &lt;span id="txtHint"&gt;&lt;/span&gt;&lt;/p&gt;</code></p>
<p><code>&lt;/body&gt;</code></p>
<p><code>&lt;/html&gt;</code></p>
<empty-line/>
<p>Ýòî êîä JavaScript, êîòîðûé íàõîäèòñÿ â ôàéëå "clienthint.js":</p>
<empty-line/>
<p><code>var xmlHttp</code></p>
<empty-line/>
<p><code>function showHint(str)</code></p>
<p><code>{</code></p>
<p><code>if (str.length==0)</code></p>
<p><code>{</code></p>
<p><code>document.getElementById("txtHint").innerHTML=""</code></p>
<p><code>return</code></p>
<p><code>}</code></p>
<p><code>xmlHttp=GetXmlHttpObject()</code></p>
<p><code>if (xmlHttp==null)</code></p>
<p><code>{</code></p>
<p><code>alert ("Áðàóçåð íå ïîääåðæèâàåò çàïðîñû HTTP")</code></p>
<p><code>return</code></p>
<p><code>}</code></p>
<p><code>var url="gethint.asp"</code></p>
<p><code>url=url+"?q="+str</code></p>
<p><code>url=url+"&amp;sid="+Math.random()</code></p>
<p><code>xmlHttp.onreadystatechange=stateChanged</code></p>
<p><code>xmlHttp.open("GET",url,true)</code></p>
<p><code>xmlHttp.send(null)</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function stateChanged()</code></p>
<p><code>{</code></p>
<p><code>if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete")</code></p>
<p><code>{</code></p>
<p><code>document.getElementById("txtHint").innerHTML=xmlHttp.responseText</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function GetXmlHttpObject()</code></p>
<p><code>{</code></p>
<p><code>var objXMLHttp=null</code></p>
<p><code>if (window.XMLHttpRequest)</code></p>
<p><code>{</code></p>
<p><code>objXMLHttp=new XMLHttpRequest()</code></p>
<p><code>}</code></p>
<p><code>else if (window.ActiveXObject)</code></p>
<p><code>{</code></p>
<p><code>objXMLHttp=new ActiveXObject("Microsoft.XMLHTTP")</code></p>
<p><code>}</code></p>
<p><code>return objXMLHttp</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Äàëåå ðå÷ü ïîéäåò î ñåðâåðíîé ñòðàíèöå AJAX.</p>
<p>Ñåðâåðà AJAX íå ñóùåñòâóåò.</p>
<p>Ñòðàíèöû AJAX ìîæåò îáðàáàòûâàòü ëþáîé ñåðâåð Èíòåðíåò.</p>
<p>Ñåðâåðíàÿ ñòðàíèöà, âûçûâàåìàÿ ñöåíàðèåì JavaScript â ðàññìàòðèâàåìîì ïðèìåðå, ÿâëÿåòñÿ ïðîñòûì ôàéëîì ASP ñ èìåíåì "gethint.asp".</p>
<p>Íèæå ïðåäñòàâëåíû äâà ïðèìåðà êîäà ñåðâåðíîé ñòðàíèöû, îäèí, íàïèñàííûé íà ASP, à äðóãîé – íà PHP.</p>
<p>Êîä íà ñòðàíèöå "gethint.asp" íàïèñàí íà VBScript äëÿ Èíôîðìàöèîííîãî ñåðâåðà Èíòåðíåò (IIS). Îí ïðîñòî ïðîâåðÿåò ìàññèâ èìåí è âîçâðàùàåò êëèåíòó ïîäõîäÿùèå èìåíà:</p>
<empty-line/>
<p><code>&lt;%</code></p>
<p><code>dim a(30)</code></p>
<p><code>'Çàïîëíåíèå ìàññèâà èìåíàìè</code></p>
<p><code>a(1)="Anna"</code></p>
<p><code>a(2)="Brittany"</code></p>
<p><code>a(3)="Cinderella"</code></p>
<p><code>a(4)="Diana"</code></p>
<p><code>a(5)="Eva"</code></p>
<p><code>a(6)="Fiona"</code></p>
<p><code>a(7)="Gunda"</code></p>
<p><code>a(8)="Hege"</code></p>
<p><code>a(9)="Inga"</code></p>
<p><code>a(10)="Johanna"</code></p>
<p><code>a(11)="Kitty"</code></p>
<p><code>a(12)="Linda"</code></p>
<p><code>a(13)="Nina"</code></p>
<p><code>a(14)="Ophelia"</code></p>
<p><code>a(15)="Petunia"</code></p>
<p><code>a(16)="Amanda"</code></p>
<p><code>a(17)="Raquel"</code></p>
<p><code>a(18)="Cindy"</code></p>
<p><code>a(19)="Doris"</code></p>
<p><code>a(20)="Eve"</code></p>
<p><code>a(21)="Evita"</code></p>
<p><code>a(22)="Sunniva"</code></p>
<p><code>a(23)="Tove"</code></p>
<p><code>a(24)="Unni"</code></p>
<p><code>a(25)="Violet"</code></p>
<p><code>a(26)="Liza"</code></p>
<p><code>a(27)="Elizabeth"</code></p>
<p><code>a(28)="Ellen"</code></p>
<p><code>a(29)="Wenche"</code></p>
<p><code>a(30)="Vicky"</code></p>
<p><code>'èçâëå÷åíèå ïàðàìåòðà q èç URL</code></p>
<p><code>q=ucase(request.querystring("q"))</code></p>
<p><code>'ïîèñê âñåõ ðåêîìåíäàöèé èç ìàññèâà, åñëè äëèíà q&gt;0</code></p>
<p><code>if len(q)&gt;0 then</code></p>
<p><code>hint=""</code></p>
<p><code>for i=1 to 30</code></p>
<p><code>if q=ucase(mid(a(i),1,len(q))) then</code></p>
<p><code>if hint="" then</code></p>
<p><code>hint=a(i)</code></p>
<p><code>else</code></p>
<p><code>hint=hint &amp; "," &amp; a(i)</code></p>
<p><code>end if</code></p>
<p><code>end if</code></p>
<p><code>next</code></p>
<p><code>end if</code></p>
<p><code>'Âûâîä "íåò ïðåäëîæåíèé" åñëè ðåêîìåíäóåìîãî èìåíè íå íàéäåíî</code></p>
<p><code>'èëè âûâîä ïîäõîäÿùèõ çíà÷åíèé</code></p>
<p><code>if hint="" then</code></p>
<p><code>response.write("íåò ïðåäëîæåíèé")</code></p>
<p><code>else</code></p>
<p><code>response.write(hint)</code></p>
<p><code>end if</code></p>
<p><code>%&gt;</code></p>
<empty-line/>
<p>Ïðèâåäåííûé âûøå êîä ïåðåïèñàí íà PHP.</p>
<p>Ïðèìå÷àíèå: ×òîáû âûïîëíèòü âåñü ïðèìåð íà PHP, íå çàáóäüòå èçìåíèòü çíà÷åíèå ïåðåìåííîé url â "clienthint.js" ñ "gethint.asp" íà "gethint.php".</p>
<empty-line/>
<p><code>&lt;?php</code></p>
<p><code>// Çàïîëíÿåì ìàññèâ èìåíàìè</code></p>
<p><code>$a[]="Anna";</code></p>
<p><code>$a[]="Brittany";</code></p>
<p><code>$a[]="Cinderella";</code></p>
<p><code>$a[]="Diana";</code></p>
<p><code>$a[]="Eva";</code></p>
<p><code>$a[]="Fiona";</code></p>
<p><code>$a[]="Gunda";</code></p>
<p><code>$a[]="Hege";</code></p>
<p><code>$a[]="Inga";</code></p>
<p><code>$a[]="Johanna";</code></p>
<p><code>$a[]="Kitty";</code></p>
<p><code>$a[]="Linda";</code></p>
<p><code>$a[]="Nina";</code></p>
<p><code>$a[]="Ophelia";</code></p>
<p><code>$a[]="Petunia";</code></p>
<p><code>$a[]="Amanda";</code></p>
<p><code>$a[]="Raquel";</code></p>
<p><code>$a[]="Cindy";</code></p>
<p><code>$a[]="Doris";</code></p>
<p><code>$a[]="Eve";</code></p>
<p><code>$a[]="Evita";</code></p>
<p><code>$a[]="Sunniva";</code></p>
<p><code>$a[]="Tove";</code></p>
<p><code>$a[]="Unni";</code></p>
<p><code>$a[]="Violet";</code></p>
<p><code>$a[]="Liza";</code></p>
<p><code>$a[]="Elizabeth";</code></p>
<p><code>$a[]="Ellen";</code></p>
<p><code>$a[]="Wenche";</code></p>
<p><code>$a[]="Vicky";</code></p>
<p><code>//èçâëå÷åíèå ïàðàìåòðà q èç URL</code></p>
<p><code>$q=$_GET["q"];</code></p>
<p><code>//ïîèñê âñåõ ðåêîìåíäàöèé â ìàññèâå, åñëè äëèíà q&gt;0</code></p>
<p><code>if (strlen($q) &gt; 0)</code></p>
<p><code>{</code></p>
<p><code>$hint="";</code></p>
<p><code>for($i=0; $i&lt;count($a); $i++)</code></p>
<p><code>{</code></p>
<p><code>if (strtolower($q)==strtolower(substr($a[$i],0,strlen($q))))</code></p>
<p><code>{</code></p>
<p><code>if ($hint=="")</code></p>
<p><code>{</code></p>
<p><code>$hint=$a[$i];</code></p>
<p><code>}</code></p>
<p><code>else</code></p>
<p><code>{</code></p>
<p><code>$hint=$hint." ,".$a[$i];</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>// Âûâîä "íåò ïðåäëîæåíèé", åñëè ðåêîìåíäàöèé íå íàéäåíî</code></p>
<p><code>// èëè âûâîä ïîäõîäÿùèõ çíà÷åíèé</code></p>
<p><code>if ($hint == "")</code></p>
<p><code>{</code></p>
<p><code>$response="íåò ïðåäëîæåíèé";</code></p>
<p><code>}</code></p>
<p><code>else</code></p>
<p><code>{</code></p>
<p><code>$response=$hint;</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>//âûâîä îòâåòà</code></p>
<p><code>echo $response;</code></p>
<p><code>?&gt;</code></p>
<empty-line/>
<p>AJAX ìîæíî èñïîëüçîâàòü äëÿ èíòåðàêòèâíîãî âçàèìîäåéñòâèÿ ñ áàçîé äàííûõ.</p>
<p>Â ñëåäóþùåì ïðèìåðå ïðèëîæåíèÿ AJAX áóäåò ïîêàçàíî, êàê Web-ñòðàíèöà ìîæåò èçâëåêàòü èíôîðìàöèþ èç áàçû äàííûõ ñ ïîìîùüþ òåõíîëîãèè AJAX.</p>
<p>Íà Web-ñòðàíèöå âûâîäèòñÿ ñïèñîê âûáîðà ñ èìåíàìè êëèåíòîâ.</p>
<p>Ïðè âûáîðå ëþáîãî êëèåíòà íà ñòðàíèöå âûâîäèòñÿ ñâÿçàííàÿ ñ íèì èíôîðìàöèÿ èç áàçû äàííûõ.</p>
<p>Îïèñàííûé âûøå ïðèìåð ñòðàíèöû ñîäåðæèò ïðîñòóþ ôîðìó HTML è ññûëêó íà ñöåíàðèé JavaScript:</p>
<empty-line/>
<p>&lt;html&gt;</p>
<p><code>&lt;head&gt;</code></p>
<p><code>&lt;script src="selectcustomer.js"&gt;&lt;/script&gt;</code></p>
<p><code>&lt;/head&gt;</code></p>
<p><code>&lt;body&gt;</code></p>
<p><code>&lt;form&gt;</code></p>
<p><code>Âûáåðèòå çàêàç÷èêà:</code></p>
<p><code>&lt;select name="customers" onchange="showCustomer(this.value)"&gt;</code></p>
<p><code>&lt;option value="ALFKI"&gt;Alfreds Futterkiste</code></p>
<p><code>&lt;option value="NORTS "&gt;North/South</code></p>
<p><code>&lt;option value="WOLZA"&gt;Wolski Zajazd</code></p>
<p><code>&lt;/select&gt;</code></p>
<p><code>&lt;/form&gt;</code></p>
<p><code>&lt;p&gt;</code></p>
<p><code>&lt;div id="txtHint"&gt;&lt;b&gt;Èíôîðìàöèÿ î çàêàç÷èêå áóäåò âûâîäèòüñÿ çäåñü.&lt;/b&gt;&lt;/div&gt;</code></p>
<p><code>&lt;/p&gt;</code></p>
<p><code>&lt;/body&gt;</code></p>
<p><code>&lt;/html&gt;</code></p>
<empty-line/>
<p>Êàê ìîæíî âèäåòü, ýòî ïðîñòî ôîðìà HTML ñ ðàñêðûâàþùèìñÿ ñïèñêîì ñ íàçâàíèåì "customers".</p>
<p>Ïàðàãðàô íèæå ôîðìû ñîäåðæèò òåã <strong>div</strong> ñ èìåíåì "txtHint". Òåã div èñïîëüçóåòñÿ â êà÷åñòâå ïîëÿ äëÿ çàïîëíåíèÿ ïîëó÷àåìîé ñ Web-ñåðâåðà èíôîðìàöèåé.</p>
<p>Êîãäà ïîëüçîâàòåëü âûáèðàåò äàííûå (èìÿ çàêàç÷èêà), âûïîëíÿåòñÿ ôóíêöèÿ "showCustomer()". Âûïîëíåíèå ôóíêöèè çàïóñêàåòñÿ ñîáûòèåì "onchange". Äðóãèìè ñëîâàìè, êàæäûé ðàç, êîãäà ïîëüçîâàòåëü èçìåíÿåò çíà÷åíèå â ïîëå ðàñêðûâàþùåãîñÿ ñïèñêà, âûçûâàåòñÿ ôóíêöèÿ <strong>showCustomer</strong>.</p>
<p>Êîä JavaScript ïîêàçàí äàëåå.</p>
<p>Ñëåäóþùèé äàëåå êîä JavaScript íàõîäèòñÿ â ôàéëå "selectcustomer.js":</p>
<empty-line/>
<p><code>var xmlHttp</code></p>
<empty-line/>
<p><code>function showCustomer(str)</code></p>
<p><code>{</code></p>
<p><code>xmlHttp=GetXmlHttpObject()</code></p>
<p><code>if (xmlHttp==null)</code></p>
<p><code>{</code></p>
<p><code>alert ("Áðàóçåð íå ïîääåðæèâàåò çàïðîñû HTTP")</code></p>
<p><code>return</code></p>
<p><code>}</code></p>
<p><code>var url="getcustomer.asp"</code></p>
<p><code>url=url+"?q="+str</code></p>
<p><code>url=url+"&amp;sid="+Math.random()</code></p>
<p><code>xmlHttp.onreadystatechange=stateChanged</code></p>
<p><code>xmlHttp.open("GET",url,true)</code></p>
<p><code>xmlHttp.send(null)</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function stateChanged()</code></p>
<p><code>{</code></p>
<p><code>if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete")</code></p>
<p><code>{</code></p>
<p><code>document.getElementById("txtHint").innerHTML=xmlHttp.responseText</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function GetXmlHttpObject()</code></p>
<p><code>{</code></p>
<p><code>var objXMLHttp=null</code></p>
<p><code>if (window.XMLHttpRequest)</code></p>
<p><code>{</code></p>
<p><code>objXMLHttp=new XMLHttpRequest()</code></p>
<p><code>}</code></p>
<p><code>else if (window.ActiveXObject)</code></p>
<p><code>{</code></p>
<p><code>objXMLHttp=new ActiveXObject("Microsoft.XMLHTTP")</code></p>
<p><code>}</code></p>
<p><code>return objXMLHttp</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Ñåðâåðíàÿ ñòðàíèöà, âûçûâàåìàÿ ñöåíàðèåì JavaScript, ÿâëÿåòñÿ ïðîñòî ôàéëîì ASP file ñ èìåíåì "getcustomer.asp".</p>
<p>Ñòðàíèöà íàïèñàíà íà VBScript äëÿ Èíôîðìàöèîííîãî ñåðâåðà Èíòåðíåò (IIS). Åå ìîæíî ëåãêî ïåðåïèñàòü íà PHP, èëè ëþáîé äðóãîé ñåðâåðíûé ÿçûê.</p>
<p>Êîä âûïîëíÿåò êîìàíäû SQL íà áàçå äàííûõ è âîçâðàùàåò ðåçóëüòàò â âèäå òàáëèöû HTML:</p>
<empty-line/>
<p><code>sql="SELECT * FROM CUSTOMERS WHERE CUSTOMERID="</code></p>
<p><code>sql=sql &amp; request.querystring("q")</code></p>
<empty-line/>
<p><code>set conn=Server.CreateObject("ADODB.Connection")</code></p>
<p><code>conn.Provider="Microsoft.Jet.OLEDB.4.0"</code></p>
<p><code>conn.Open(Server.Mappath("/db/northwind.mdb"))</code></p>
<p><code>set rs = Server.CreateObject("ADODB.recordset")</code></p>
<p><code>rs.Open sql, conn</code></p>
<empty-line/>
<p><code>response.write("&lt;table&gt;")</code></p>
<p><code>do until rs.EOF</code></p>
<p><code>for each x in rs.Fields</code></p>
<p><code>response.write("&lt;tr&gt;&lt;td&gt;&lt;b&gt;" &amp; x.name &amp; "&lt;/b&gt;&lt;/td&gt;")</code></p>
<p><code>response.write("&lt;td&gt;" &amp; x.value &amp; "&lt;/td&gt;&lt;/tr&gt;")</code></p>
<p><code>next</code></p>
<p><code>rs.MoveNext</code></p>
<p><code>loop</code></p>
<empty-line/>
<p><code>response.write("&lt;/table&gt;")</code></p>
<empty-line/>
<p>AJAX ìîæíî èñïîëüçîâàòü äëÿ èíòåðàêòèâíîãî âçàèìîäåéñòâèÿ ñ ôàéëîì XML.</p>
<p>Â ñëåäóþùåì äàëåå ïðèìåðå ïðèëîæåíèÿ AJAX ïîêàçàíî, êàê Web-ñòðàíèöà ìîæåò èçâëåêàòü èíôîðìàöèþ èç ôàéëà XML ñ ïîìîùüþ òåõíîëîãèè AJAX.</p>
<p>Íà Web-ñòðàíèöå âûâîäèòñÿ ñïèñîê âûáîðà ñ èìåíàìè èñïîëíèòåëåé ìóçûêàëüíûõ ïðîèçâåäåíèé. Ïðè âûáîðå èñïîëíèòåëÿ íà ñòðàíèöå ïîÿâëÿåòñÿ èíôîðìàöèÿ ñ îïèñàíèåì êîìïàêò-äèñêà ñ çàïèñÿìè ýòîãî ìóçûêàíòà.</p>
<p>Ðàññìàòðèâàåìûé ïðèìåð ñîäåðæèò ïðîñòóþ ôîðìó HTML è ññûëêó íà êîä JavaScript:</p>
<empty-line/>
<p><code>&lt;html&gt;</code></p>
<p><code>&lt;head&gt;</code></p>
<p><code>&lt;script src="selectcd.js"&gt;&lt;/script&gt;</code></p>
<p><code>&lt;/head&gt;</code></p>
<p><code>&lt;body&gt;</code></p>
<p><code>&lt;form&gt;</code></p>
<p><code>Âûáåðèòå êîìïàêò-äèñê:</code></p>
<p><code>&lt;select name="cds" onchange="showCD(this.value)"&gt;</code></p>
<p><code>&lt;option value="Bob Dylan"&gt;Bob Dylan&lt;/option&gt;</code></p>
<p><code>&lt;option value="Bonnie Tyler"&gt;Bonnie Tyler&lt;/option&gt;</code></p>
<p><code>&lt;option value="Dolly Parton"&gt;Dolly Parton&lt;/option&gt;</code></p>
<p><code>&lt;/select&gt;</code></p>
<p><code>&lt;/form&gt;</code></p>
<p><code>&lt;p&gt;</code></p>
<p><code>&lt;div id="txtHint"&gt;&lt;b&gt;Çäåñü âûâîäèòñÿ èíôîðìàöèÿ î êîìïàêò-äèñêå.&lt;/b&gt;&lt;/div&gt;</code></p>
<p><code>&lt;/p&gt;</code></p>
<p><code>&lt;/body&gt;</code></p>
<p><code>&lt;/html&gt;</code></p>
<empty-line/>
<p>Êàê ìîæíî âèäåòü, ýòî ïðîñòàÿ ôîðìà HTML ñ ïðîñòûì ðàñêðûâàþùèìñÿ ñïèñêîì âûáîðà ñ èìåíåì "cds".</p>
<p>Ïàðàãðàô íèæå ôîðìû ñîäåðæèò òåã <strong>div</strong> ñ èìåíåì "txtHint". Òåã div èñïîëüçóåòñÿ â êà÷åñòâå ïîëÿ äëÿ çàïîëíåíèÿ èíôîðìàöèåé, ïîëó÷àåìîé ñ Web-ñåðâåðà.</p>
<p>Êîãäà ïîëüçîâàòåëü äåëàåò ñâîé âûáîð, âûïîëíÿåòñÿ ôóíêöèÿ ñ èìåíåì "showCD". Âûïîëíåíèå ôóíêöèè çàïóñêàåòñÿ ñîáûòèåì "onchange". Äðóãèìè ñëîâàìè, êàæäûé ðàç, êîãäà ïîëüçîâàòåëü èçìåíÿåò çíà÷åíèå â ïîëå ðàñêðûâàþùåãîñÿ ñïèñêà, âûçûâàåòñÿ ôóíêöèÿ <strong>showCD</strong>.</p>
<p>Êîä JavaScript ïîêàçàí äàëåå.</p>
<p>Ñëåäóþùèé äàëåå êîä JavaScript íàõîäèòñÿ â ôàéëå "selectcd.js":</p>
<empty-line/>
<p><code>var xmlHttp</code></p>
<empty-line/>
<p><code>function showCD(str)</code></p>
<p><code>{</code></p>
<p><code>xmlHttp=GetXmlHttpObject()</code></p>
<p><code>if (xmlHttp==null)</code></p>
<p><code>{</code></p>
<p><code>alert ("Áðàóçåð íå ïîääåðæèâàåò çàïðîñû HTTP")</code></p>
<p><code>return</code></p>
<p><code>}</code></p>
<p><code>var url="getcd.asp"</code></p>
<p><code>url=url+"?q="+str</code></p>
<p><code>url=url+"&amp;sid="+Math.random()</code></p>
<p><code>xmlHttp.onreadystatechange=stateChanged</code></p>
<p><code>xmlHttp.open("GET",url,true)</code></p>
<p><code>xmlHttp.send(null)</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function stateChanged()</code></p>
<p><code>{</code></p>
<p><code>if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete")</code></p>
<p><code>{</code></p>
<p><code>document.getElementById("txtHint").innerHTML=xmlHttp.responseText</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>function GetXmlHttpObject()</code></p>
<p><code>{</code></p>
<p><code>var objXMLHttp=null</code></p>
<p><code>if (window.XMLHttpRequest)</code></p>
<p><code>{</code></p>
<p><code>objXMLHttp=new XMLHttpRequest()</code></p>
<p><code>}</code></p>
<p><code>else if (window.ActiveXObject)</code></p>
<p><code>{</code></p>
<p><code>objXMLHttp=new ActiveXObject("Microsoft.XMLHTTP")</code></p>
<p><code>}</code></p>
<p><code>return objXMLHttp</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Ñåðâåðíàÿ ñòðàíèöà, âûçûâàåìàÿ êîäîì JavaScript, áóäåò ïðîñòûì ôàéëîì ASP ñ èìåíåì "getcd.asp".</p>
<p>Ñòðàíèöà íàïèñàíà íà VBScript äëÿ Èíôîðìàöèîííîãî ñåðâåðà Èíòåðíåò (IIS). Åå ìîæíî ëåãêî ïåðåïèñàòü íà PHP, èëè ëþáîì äðóãîì ñåðâåðíîì ÿçûêå.</p>
<p>Êîä âûïîëíÿåò çàïðîñ íà ôàéëå XML è âîçâðàùàåò ðåçóëüòàò â âèäå HTML.</p>
<empty-line/>
<p>q=request.querystring("q")</p>
<empty-line/>
<p><code>set xmlDoc=Server.CreateObject("Microsoft.XMLDOM")</code></p>
<p><code>xmlDoc.async="false"</code></p>
<p><code>xmlDoc.load(Server.MapPath("cd_catalog.xml"))</code></p>
<empty-line/>
<p><code>set nodes=xmlDoc.selectNodes("CATALOG/CD[ARTIST='" &amp; q &amp; "']")</code></p>
<empty-line/>
<p><code>for each x in nodes</code></p>
<p><code>for each y in x.childnodes</code></p>
<p><code>response.write("&lt;b&gt;" &amp; y.nodename &amp; ":&lt;/b&gt; ")</code></p>
<p><code>response.write(y.text)</code></p>
<p><code>response.write("&lt;br /&gt;")</code></p>
<p><code>next</code></p>
<p><code>next</code></p>
<empty-line/>
<p>Îáúåêò <strong>XMLHttpRequest</strong> äåëàåò âîçìîæíîé òåõíîëîãèþ AJAX.</p>
<p>×òîáû ñîçäàâàòü Web-ïðèëîæåíèÿ AJAX, íåîáõîäèìî õîðîøî çíàòü îáúåêò JavaScript, íàçûâàåìûé <strong>XMLHttpRequest</strong>.</p>
<p>Îáúåêò <strong>XMLHttpRequest</strong> ÿâëÿåòñÿ êëþ÷åâûì ïîíÿòèåì òåõíîëîãèè AJAX. Îí áûë äîñòóïåí ñ ìîìåíòà ïîÿâëåíèÿ â èþëå 2000 áðàóçåðà Internet Explorer 5.5, íî íå áûë ïîëíîñòüþ ïîíÿò äî 2005 ãîäà, êîãäà íà÷àëèñü ðàçãîâîðû îá AJAX è Web 2.0.</p>
<p>Íèæå ïðåäñòàâëåíû íåêîòîðûå ìåòîäû è ñâîéñòâà ýòîãî îáúåêòà, ñ êîòîðûìè íåîáõîäèìî áûòü çíàêîìûì.</p>
<p>Ðàçëè÷íûå áðàóçåðû èñïîëüçóþò äëÿ ñîçäàíèÿ îáúåêòà <strong>XMLHttpRequest</strong> ðàçëè÷íûå ìåòîäû.</p>
<p>Internet Explorer èñïîëüçóåò ActiveXObject.</p>
<p>Äðóãèå áðàóçåðû èñïîëüçóþò âñòðîåííûé â JavaScript îáúåêò, íàçûâàåìûé <strong>XMLHttpRequest</strong>.</p>
<p>Âîò ïðîñòåéøèé êîä, êîòîðûé ìîæíî èñïîëüçîâàòü, ÷òîáû îáîéòè ýòó ïðîáëåìó.</p>
<empty-line/>
<p><code>var XMLHttp=null</code></p>
<empty-line/>
<p><code>if (window.XMLHttpRequest)</code></p>
<p><code>{</code></p>
<p><code>XMLHttp=new XMLHttpRequest()</code></p>
<p><code>}</code></p>
<p><code>else if (window.ActiveXObject)</code></p>
<p><code>{</code></p>
<p><code>XMLHttp=new ActiveXObject("Microsoft.XMLHTTP")</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Ñíà÷àëà ñîçäàåòñÿ ïåðåìåííàÿ <strong>XMLHttp</strong> äëÿ èñïîëüçîâàíèÿ â êà÷åñòâå îáúåêòà <strong>XMLHttpRequest</strong>. Åå çíà÷åíèå çàäàåòñÿ êàê <strong>null</strong>.</p>
<p>Çàòåì ïðîâåðÿåòñÿ, äîñòóïåí ëè îáúåêò <strong>window.XMLHttpRequest</strong>. Ýòîò îáúåêò äîñòóïåí â áîëåå íîâûõ âåðñèÿõ áðàóçåðîâ, òàêèõ êàê Firefox, Mozilla, è Opera.</p>
<p>Åñëè îáúåêò äîñòóïåí, òî îí èñïîëüçóåòñÿ äëÿ ñîçäàíèÿ íîâîãî îáúåêòà.</p>
<empty-line/>
<p>XMLHttp=new XMLHttpRequest().</p>
<empty-line/>
<p>Åñëè îí íå äîñòóïåí, òî ïðîâåðÿåòñÿ, äîñòóïåí ëè îáúåêò <strong>window.ActiveXObject</strong>. Ýòîò îáúåêò áóäåò äîñòóïåí â áðàóçåðå Internet Explorer âåðñèè 5.5 è âûøå.</p>
<p>Åñëè ýòîò îáúåêò äîñòóïåí, òî îí èñïîëüçóåòñÿ äëÿ ñîçäàíèÿ íîâîãî îáúåêòà:</p>
<empty-line/>
<p>XMLHttp=new ActiveXObject().</p>
<empty-line/>
<p>Íåêîòîðûå ïðîãðàììèñòû ïðåäïî÷òóò èñïîëüçîâàòü ñàìóþ íîâóþ è áûñòðóþ âåðñèþ îáúåêòà <strong>XMLHttpRequest</strong>.</p>
<p>Ñëåäóþùèé ïðèìåð ïûòàåòñÿ èñïîëüçîâàòü ñàìóþ ïîñëåäíþþ âåðñèþ îáúåêòà "Msxml2.XMLHTTP" êîìïàíèè Microsoft, äîñòóïíóþ â Internet Explorer 6, ïðåæäå ÷åì îáðàòèòüñÿ ê îáúåêòó "Microsoft.XMLHTTP", äîñòóïíîìó â Internet Explorer 5.5 è âûøå.</p>
<empty-line/>
<p><code>var XMLHttp=null</code></p>
<p><code>try</code></p>
<p><code>{</code></p>
<p><code>XMLHttp=new ActiveXObject("Msxml2.XMLHTTP")</code></p>
<p><code>}</code></p>
<p><code>catch(e)</code></p>
<p><code>{</code></p>
<p><code>try</code></p>
<p><code>{</code></p>
<p><code>XMLHttp=new ActiveXObject("Microsoft.XMLHTTP")</code></p>
<p><code>}</code></p>
<p><code>}</code></p>
<empty-line/>
<p><code>if (XMLHttp==null)</code></p>
<p><code>{</code></p>
<p><code>XMLHttp=new XMLHttpRequest()</code></p>
<p><code>}</code></p>
<empty-line/>
<p>Ñíà÷àëà ñîçäàåòñÿ ïåðåìåííàÿ <strong>XMLHttp</strong> äëÿ èñïîëüçîâàíèÿ â êà÷åñòâå îáúåêòà <strong>XMLHttpRequest</strong>. Åå çíà÷åíèå çàäàåòñÿ êàê <strong>null</strong>.</p>
<p>Çàòåì äåëàåòñÿ ïîïûòêà ñîçäàíèÿ îáúåêòà ñïîñîáîì êîìïàíèè Microsoft, äîñòóïíûì â Internet Explorer 6 è áîëåå ïîçäíèõ âåðñèÿõ:</p>
<empty-line/>
<p><code>XMLHttp=new ActiveXObject("Msxml2.XMLHTTP")</code></p>
<empty-line/>
<p>Åñëè ýòî ïîðîæäàåò îøèáêó, òî èñïîëüçóåòñÿ ñòàðûé ñïîñîá (Internet Explorer 5.5):</p>
<empty-line/>
<p><code>XMLHttp=new ActiveXObject("Microsoft.XMLHTTP")</code></p>
<empty-line/>
<p>Åñëè <strong>XMLHttp</strong> ïî ïðåæíåìó èìååò çíà÷åíèå <strong>null</strong>, òî äåëàåòñÿ ïîïûòêà ñîçäàíèÿ îáúåêòà "ñòàíäàðòíûì" ñïîñîáîì:</p>
<empty-line/>
<p><code>XMLHttp=new XMLHttpRequest()</code></p>
<empty-line/>
<p><strong>Ìåòîä open()</strong></p>
<p>Ìåòîä <strong>open()</strong> ñîçäàåò çàïðîñ äëÿ Web-ñåðâåðà.</p>
<p><strong>Ìåòîä send()</strong></p>
<p>Ìåòîä <strong>send()</strong> ïîñûëàåò çàïðîñ ñåðâåðó.</p>
<p><strong>Ìåòîä abort()</strong></p>
<p>Ìåòîä <strong>abort()</strong> îòìåíÿåò òåêóùèé çàïðîñ ê ñåðâåðó.</p>
<p>Ñâîéñòâî <strong>readyState</strong> îïðåäåëÿåò òåêóùåå ñîñòîÿíèå îáúåêòà <strong>XMLHttpRequest</strong>.</p>
<p>Â òàáëèöå ïîêàçàíû âîçìîæíûå çíà÷åíèÿ ñâîéñòâà <strong>readyState</strong>:</p>
<empty-line/>
<table><tr>
<th>Ñîñòîÿíèå</th>
<th>Îïèñàíèå</th>
</tr><tr>
<td>0</td>
<td>Çàïðîñ íå èíèöèàëèçèðîâàí</td>
</tr><tr>
<td>1</td>
<td>Çàïðîñ ñîçäàí</td>
</tr><tr>
<td>2</td>
<td>Çàïðîñ ïîñëàí</td>
</tr><tr>
<td>3</td>
<td>Çàïðîñ îáðàáàòûâàåòñÿ</td>
</tr><tr>
<td>4</td>
<td>Çàïðîñ çàâåðøåí</td>
</tr></table>
<empty-line/>
<p><strong>readyState=0</strong> ïîñëå ñîçäàíèÿ îáúåêòà <strong>XMLHttpRequest</strong>, íî äî âûçîâà ìåòîäà <strong>open()</strong>.</p>
<p><strong>readyState=1</strong> ïîñëå âûçîâà ìåòîäà <strong>open()</strong>, íî äî âûçîâà ìåòîäà <strong>send()</strong>.</p>
<p><strong>readyState=2</strong> ïîñëå âûçîâà ìåòîäà <strong>send()</strong>.</p>
<p><strong>readyState=3</strong> ïîñëå òîãî, êàê áðàóçåð ñîåäèíèòñÿ ñ ñåðâåðîì, íî äî çàâåðøåíèÿ ñåðâåðîì îòâåòà.</p>
<p><strong>readyState=4</strong> ïîñëå çàâåðøåíèÿ çàïðîñà è ïîëíîãî ïîëó÷åíèÿ âñåõ äàííûõ îòâåòà ñ ñåðâåðà.</p>
<p>Ðàçëè÷íûå áðàóçåðû èñïîëüçóþò ñâîéñòâî ñîñòîÿíèÿ ãîòîâíîñòè ïî-ðàçíîìó. Íå ñòîèò ðàññ÷èòûâàòü, ÷òî âñå áðàóçåðû áóäóò ñîîáùàòü îáî âñåõ ñîñòîÿíèÿõ. Íåêîòîðûå íå ñîîáùàþò î ñîñòîÿíèè 0 è 1.</p>
<p>Äëÿ ïðèëîæåíèé AJAX ïðåäñòàâëÿåò èíòåðåñ ôàêòè÷åñêè òîëüêî ñîñòîÿíèå 4. Òå åñòü, êîãäà çàïðîñ çàâåðøåí, è ìîæíî èñïîëüçîâàòü ïîëó÷åííûå äàííûå.</p>
<p>Ñâîéñòâî <strong>responseText</strong> ñîäåðæèò ïðèñëàííûé ñåðâåðîì òåêñò.</p>
</section>
<section>
<title>
<p><emphasis>Äîïîëíåíèå II.</emphasis> Ó÷åáíîå ðóêîâîäñòâî ïî XHTML</p>
</title>
<p>ßçûê XHTML ÿâëÿåòñÿ áîëåå ñòðîãîé è ÷åòêîé âåðñèåé ÿçûêà ðàçìåòêè HTML.</p>
<p>Â äàííîì ðóêîâîäñòâå ðàññìîòðåíû ðàçëè÷èÿ ìåæäó HTML è XHTML, à òàêæå ïîêàçàíî, êàê ïðåîáðàçîâàòü Web-ñàéò íà èñïîëüçîâàíèå XHTML.</p>
<p>ßçûê XHTML ÿâëÿåòñÿ áîëåå ñòðîãîé è ÷åòêîé âåðñèåé ÿçûêà HTML.</p>
<p>Äëÿ ïîíèìàíèÿ èçëîæåííîãî ìàòåðèàëà íåîáõîäèìî çíàòü ÿçûê HTML è îñíîâû ñîçäàíèÿ Web-ñòðàíèö.</p>
<p>XHTML ÿâëÿåòñÿ ñîêðàùåíèåì îò àíãëèéñêîãî EXtensible HyperText Markup Language, ÷òî îçíà÷àåò "Ðàñøèðÿåìûé ÿçûê ðàçìåòêè ãèïåðòåêñòà".</p>
<p>XHTML ïðåäíàçíà÷åí äëÿ çàìåíû HTML.</p>
<p>XHTML ïî÷òè ñîâïàäàåò ñ HTML 4.01.</p>
<p>XHTML ÿâëÿåòñÿ áîëåå ñòðîãîé è ÷åòêîé âåðñèåé ÿçûêà HTML.</p>
<p>XHTML ÿâëÿåòñÿ ÿçûêîì HTML, îïðåäåëåííûì êàê ïðèëîæåíèå XML.</p>
<p>XHTML îäîáðåí â êà÷åñòâå Ðåêîìåíäàöèè êîíñîðöèóìîì W3C.</p>
<p>XHTML 1.0 áûë îäîáðåí êàê Ðåêîìåíäàöèÿ W3C 26 ÿíâàðÿ 2000 ã..</p>
<p>W3C îïðåäåëÿåò XHTML êàê ïîñëåäíþþ âåðñèþ HTML. XHTML áóäåò ïîñòåïåííî çàìåíÿòü HTML.</p>
<p>ßçûê XHTML ñîâìåñòèì ñ HTML 4.01.</p>
<p>Âñå íîâûå áðàóçåðû ïîääåðæèâàþò XHTML.</p>
<p>XHTML ÿâëÿåòñÿ ïåðåðàáîòêîé HTML 4.01 â ñîîòâåòñòâèè ñ XML, è ìîæåò ñðàçó èñïîëüçîâàòüñÿ ñóùåñòâóþùèìè áðàóçåðàìè ïðè ñîáëþäåíèè íåñêîëüêèõ ïðîñòûõ ïðàâèë.</p>
<p>Äàííîå ðóêîâîäñòâî ðàññìàòðèâàåò:</p>
<p><strong>[x]</strong> Ïî÷åìó íåîáõîäèìî èñïîëüçîâàòü XHTML</p>
<p><strong>[x]</strong> Ñèíòàêñèñ XHTML</p>
<p><strong>[x]</strong> Êàê ïðåîáðàçîâàòü ñàéò íà XHTML</p>
<p><strong>[x]</strong> Ïðîâåðêà XHTML</p>
<p><strong>[x]</strong> Ìîäóëÿðèçàöèÿ XHTML</p>
<p>XHTML ÿâëÿåòñÿ îáúåäèíåíèåì HTML è XML (EXtensible Markup Language – Ðàñøèðÿåìîãî ÿçûêà ðàçìåòêè).</p>
<p>XHTML ñîñòîèò èç âñåõ ýëåìåíòîâ HTML 4.01, îáúåäèíåííûõ ñ ñèíòàêñèñîì XML.</p>
<p>Â íàñòîÿùåå âðåìÿ ìíîãèå ñòðàíèöû â Èíòåðíåò ñîäåðæàò "ïëîõîé" êîä HTML.</p>
<p>Ñëåäóþùèé êîä HTML áóäåò íîðìàëüíî ðàáîòàòü ïðè ïðîñìîòðå â áðàóçåðå, äàæå õîòÿ îí íå ïîëíîñòüþ ñëåäóåò ïðàâèëàì HTML:</p>
<empty-line/>
<p><code>&lt;html&gt;</code></p>
<p><code>&lt;head&gt;</code></p>
<p><code>&lt;title&gt;Ýòî ïëîõîé êîä HTML&lt;/title&gt;</code></p>
<p><code>&lt;body&gt;</code></p>
<p><code>&lt;h1&gt;Ïëîõîé êîä HTML</code></p>
<p><code>&lt;/body&gt;</code></p>
<empty-line/>
<p>XML ÿâëÿåòñÿ ÿçûêîì ðàçìåòêè, â êîòîðîì êàæäûé ýëåìåíò äîëæåí áûòü ïðàâèëüíî ðàçìå÷åí, ÷òî ïðèâîäèò ê "ãðàììàòè÷åñêè-ïðàâèëüíûì" ("well-formed") äîêóìåíòàì.</p>
<p>ßçûê XML ïðåäíàçíà÷åí äëÿ îïèñàíèÿ äàííûõ, à ÿçûê HTML ñîçäàí äëÿ ïðåäñòàâëåíèÿ äàííûõ.</p>
<p>Íà ñîâðåìåííîì ðûíêå ïðåäñòàâëåíû ðàçëè÷íûå òåõíîëîãèè áðàóçåðîâ, îäíè áðàóçåðû ïðåäíàçíà÷åíû äëÿ èñïîëüçîâàíèÿ Èíòåðíåò íà êîìïüþòåðàõ, äðóãèå äëÿ èñïîëüçîâàíèÿ Èíòåðíåò íà ìîáèëüíûõ òåëåôîíàõ è c ïîìîùüþ êàðìàííûõ êîììóíèêàòîðîâ. Ïîñëåäíèå óñòðîéñòâà èìåþò íåäîñòàòî÷íî ðåñóðñîâ èëè ìîùíîñòè äëÿ èíòåðïðåòàöèè "ïëîõîãî" ÿçûêà ðàçìåòêè.</p>
<p>Îáúåäèíÿÿ ñèëüíûå ñòîðîíû HTML è XML, ìû ïîëó÷àåì ÿçûê ðàçìåòêè, êîòîðûé áóäåò ïîëåçåí ñåãîäíÿ è â áóäóùåì -- XHTML.</p>
<p>Ñòðàíèöû XHTML ìîæíî ÷èòàòü ñ ïîìîùüþ ëþáûõ óñòðîéñòâ, êîòîðûå ïîääåðæèâàþò XML. Ïîêà âåñü ìèð íå ïåðåéäåò íà èñïîëüçîâàíèå ïîääåðæèâàþùèõ XML áðàóçåðîâ, XHTML ïðåäîñòàâëÿåò âîçìîæíîñòü ñåé÷àñ ïèñàòü "ñèíòàêñè÷åñêè-ïðàâèëüíûå" äîêóìåíòû, êîòîðûå ìîæíî èñïîëüçîâàòü âî âñåõ áðàóçåðàõ.</p>
<p>XHTML ìîæíî íà÷àòü èñïîëüçîâàòü ïðîñòî ñòðîãî ñëåäóÿ ïðàâèëàì HTML.</p>
<p>XHTML íå î÷åíü ñóùåñòâåííî îòëè÷àåòñÿ îò ñòàíäàðòà HTML 4.01.</p>
<p>Ïîýòîìó õîðîøèì íà÷àëîì áóäåò ïðèâåäåíèå êîäà ê ñòàíäàðòó 4.01.</p>
<p>Êðîìå òîãî, íåîáõîäèìî ïèñàòü êîä HTML ñèìâîëàìè íèæíåãî ðåãèñòðà, è íèêîãäà íå ïðîïóñêàòü çàâåðøàþùèå òåãè (òàêèå êàê <strong>&lt;/p&gt;</strong>).</p>
<p>Âîò ñîáñòâåííî è âñå. Óäà÷íîãî êîäèðîâàíèÿ!</p>
<p>Ýëåìåíòû XHTML äîëæíû áûòü ïðàâèëüíî âëîæåíû</p>
<p>Ýëåìåíòû XHTML âñåãäà äîëæíû áûòü çàìêíóòûìè</p>
<p>Ýëåìåíòû XHTML äîëæíû çàïèñûâàòüñÿ â íèæíåì ðåãèñòðå</p>
<p>Äîêóìåíòû XHTML äîëæíû èìåòü îäèí êîðíåâîé ýëåìåíò</p>
<p>Â HTML íåêîòîðûå ýëåìåíòû ìîãóò âêëàäûâàòüñÿ äðóã â äðóãà íåêîððåêòíî, íàïðèìåð êàê â ñëó÷àå: <strong>&lt;b&gt;&lt;i&gt;Ýòîò òåêñò æèðíûé è íàêëîííûé&lt;/b&gt;&lt;/i&gt;</strong></p>
<p>Â XHTML âñå ýëåìåíòû äîëæíû ïðàâèëüíî âêëàäûâàòüñÿ äðóã â äðóãà, íàïðèìåð: <strong>&lt;b&gt;&lt;i&gt;Ýòîò òåêñò æèðíûé è íàêëîííûé&lt;/i&gt;&lt;/b&gt;</strong></p>
<p><strong>Ïðèìå÷àíèå:</strong> Äîñòàòî÷íî ÷àñòî ïðè ñîçäàíèè âëîæåííûõ ñïèñêîâ çàáûâàþò î òîì, ÷òî âíóòðåííèé ñïèñîê äîëæåí íàõîäèòñÿ ìåæäó òåãàìè <strong>&lt;li&gt;</strong> è <strong>&lt;/li&gt;</strong>.</p>
<p>Íåïðàâèëüíî:</p>
<empty-line/>
<p><code>&lt;ul&gt;</code></p>
<p><code>&lt;li&gt;Êîôå&lt;/li&gt;</code></p>
<p><code>&lt;li&gt;×àé</code></p>
<p><code>&lt;ul&gt;</code></p>
<p><code>&lt;li&gt;×åðíûé ÷àé&lt;/li&gt;</code></p>
<p><code>&lt;li&gt;Çåëåíûé ÷àé&lt;/li&gt;</code></p>
<p><code>&lt;/ul&gt;</code></p>
<p><code>&lt;li&gt;Ìîëîêî&lt;/li&gt;</code></p>
<p><code>&lt;/ul&gt;</code></p>
<empty-line/>
<p>Ïðàâèëüíî:</p>
<empty-line/>
<p><code>&lt;ul&gt;</code></p>
<p><code>&lt;li&gt;Êîôå&lt;/li&gt;</code></p>
<p><code>&lt;li&gt;×àé</code></p>
<p><code>&lt;ul&gt;</code></p>
<p><code>&lt;li&gt;×åðíûé ÷àé&lt;/li&gt;</code></p>
<p><code>&lt;li&gt;Çåëåíûé ÷àé&lt;/li&gt;</code></p>
<p><code>&lt;/ul&gt;</code></p>
<p><code>&lt;/li&gt;</code></p>
<p><code>&lt;li&gt;Ìîëîêî&lt;/li&gt;</code></p>
<p><code>&lt;/ul&gt;</code></p>
<empty-line/>
<p>Îáðàòèòå âíèìàíèå, ÷òî â ïðèìåðå "ïðàâèëüíîãî" êîäà âñòàâëåí òåã <strong>&lt;/li&gt;</strong> ïîñëå òåãà <strong>&lt;/ul&gt;</strong>.</p>
<p>Íåïóñòûå ýëåìåíòû äîëæíû èìåòü çàìûêàþùèé òåã.</p>
<p>Íåïðàâèëüíî:</p>
<empty-line/>
<p><code>&lt;p&gt;Ýòî -- ïàðàãðàô</code></p>
<p><code>&lt;p&gt;Ýòî -- åùå îäèí ïàðàãðàô</code></p>
<empty-line/>
<p>Ïðàâèëüíî:</p>
<empty-line/>
<p><code>&lt;p&gt;Ýòî -- ïàðàãðàô &lt;/p&gt;</code></p>
<p><code>&lt;p&gt;Ýòî -- åùå îäèí ïàðàãðàô &lt;/p&gt;</code></p>
<empty-line/>
<p>Ïóñòûå ýëåìåíòû äîëæíû èìåòü çàìûêàþùèé òåã èëè íà÷àëüíûé òåã äîëæåí çàêàí÷èâàòüñÿ ñèìâîëàìè <strong>/&gt;</strong>.</p>
<p>Íåïðàâèëüíî:</p>
<empty-line/>
<p><code>Ðàçðûâ ñòðîêè: &lt;br&gt;</code></p>
<p><code>Ãîðèçîíòàëüíàÿ ëèíèÿ: &lt;hr&gt;</code></p>
<p><code>Èçîáðàæåíèå: &lt;img src="happy.gif" alt="Âåñåëîå ëèöî "&gt;</code></p>
<empty-line/>
<p>Ïðàâèëüíî:</p>
<empty-line/>
<p><code>Ðàçðûâ ñòðîêè: &lt;br /&gt;</code></p>
<p><code>Ãîðèçîíòàëüíàÿ ëèíèÿ: &lt;hr /&gt;</code></p>
<p><code>Èçîáðàæåíèå: &lt;img src="happy.gif" alt="Âåñåëîå ëèöî" /&gt;</code></p>
<empty-line/>
<p>Ñïåöèôèêàöèÿ XHTML îïðåäåëÿåò, ÷òî èìåíà è àòðèáóòû òåãîâ äîëæíû çàïèñûâàòüñÿ â íèæíåì ðåãèñòðå.</p>
<p>Íåïðàâèëüíî:</p>
<empty-line/>
<p><code>&lt;BODY&gt;</code></p>
<p><code>&lt;P&gt;Ïàðàãðàô &lt;/P&gt;</code></p>
<p><code>&lt;/BODY&gt;</code></p>
<empty-line/>
<p>Ïðàâèëüíî:</p>
<empty-line/>
<p><code>&lt;body&gt;</code></p>
<p><code>&lt;p&gt;Ïàðàãðàô &lt;/p&gt;</code></p>
<p><code>&lt;/body&gt;</code></p>
<empty-line/>
<p>Âñå ýëåìåíòû XHTML äîëæíû áûòü âëîæåíû â êîðíåâîé ýëåìåíò <strong>&lt;html&gt;</strong>. Âñå äðóãèå ýëåìåíòû ìîãóò èìåòü âëîæåííûå ýëåìåíòû (ïîòîìêîâ). Âëîæåííûå ýëåìåíòû äîëæíû áûòü ïàðíûìè è ïðàâèëüíî âêëàäûâàòüñÿ â ñâîé ðîäèòåëüñêèé ýëåìåíò. Îáùàÿ ñòðóêòóðà äîêóìåíòà èìååò ñëåäóþùèé âèä:</p>
<empty-line/>
<p><code>&lt;html&gt;</code></p>
<p><code>&lt;head&gt; ... &lt;/head&gt;</code></p>
<p><code>&lt;body&gt; ... &lt;/body&gt;</code></p>
<p><code>&lt;/html&gt;</code></p>
<empty-line/>
<p>Ïðè çàïèñè äîêóìåíòà XHTML òðåáóåòñÿ èñïîëüçîâàòü ÷åòêèé ñèíòàêñèñ HTML.</p>
<p><strong>[x]</strong> Èìåíà àòðèáóòîâ äîëæíû çàïèñûâàòüñÿ â íèæíåì ðåãèñòðå</p>
<p><strong>[x]</strong> Çíà÷åíèÿ àòðèáóòîâ äîëæíû çàêëþ÷àòüñÿ â êàâû÷êè</p>
<p><strong>[x]</strong> Ìèíèìèçàöèÿ àòðèáóòîâ çàïðåùåíà</p>
<p><strong>[x]</strong> Àòðèáóò <strong>id</strong> çàìåíÿåò àòðèáóò name</p>
<p><strong>[x]</strong> DTD XHTML îïðåäåëÿåò îáÿçàòåëüíûå ýëåìåíòû</p>
<p>Íåïðàâèëüíî:</p>
<empty-line/>
<p><code>&lt;table WIDTH="100%"&gt;</code></p>
<empty-line/>
<p>Ïðàâèëüíî:</p>
<empty-line/>
<p><code>&lt;table width="100%"&gt;</code></p>
<empty-line/>
<p>Íåïðàâèëüíî:</p>
<empty-line/>
<p><code>&lt;table width=100%&gt;</code></p>
<empty-line/>
<p>Ïðàâèëüíî:</p>
<empty-line/>
<p><code>&lt;table width="100%"&gt;</code></p>
<empty-line/>
<p>Íåïðàâèëüíî:</p>
<empty-line/>
<p><code>&lt;input checked&gt;</code></p>
<p><code>&lt;input readonly&gt;</code></p>
<p><code>&lt;input disabled&gt;</code></p>
<p><code>&lt;option selected&gt;</code></p>
<p><code>&lt;frame noresize&gt;</code></p>
<empty-line/>
<p>Ïðàâèëüíî:</p>
<empty-line/>
<p><code>&lt;input checked="checked" /&gt;</code></p>
<p><code>&lt;input readonly="readonly" /&gt;</code></p>
<p><code>&lt;input disabled="disabled" /&gt;</code></p>
<p><code>&lt;option selected="selected" /&gt;</code></p>
<p><code>&lt;frame noresize="noresize" /&gt;</code></p>
<empty-line/>
<p>Íèæå ïðåäñòàâëåí ñïèñîê ìèíèìèçèðîâàííûõ àòðèáóòîâ HTML è èõ çàïèñü â XHTML.</p>
<empty-line/>
<table>
<tr>
<th>HTML</th>
<th>XHTML</th>
</tr>
<tr>
<td><strong>compact</strong></td>
<td><strong>compact="compact"</strong></td>
</tr>
<tr>
<td><strong>checked declare</strong></td>
<td><strong>checked="checked" declare="declare"</strong></td>
</tr>
<tr>
<td><strong>readonly</strong></td>
<td><strong>readonly="readonly"</strong></td>
</tr>
<tr>
<td><strong>disabled</strong></td>
<td><strong>disabled="disabled"</strong></td>
</tr>
<tr>
<td><strong>selected</strong></td>
<td><strong>selected="selected"</strong></td>
</tr>
<tr>
<td><strong>defer</strong></td>
<td><strong>defer="defer"</strong></td>
</tr>
<tr>
<td><strong>ismap</strong></td>
<td><strong>ismap="ismap"</strong></td>
</tr>
<tr>
<td><strong>nohref</strong></td>
<td><strong>nohref="nohref"</strong></td>
</tr>
<tr>
<td><strong>noshade</strong></td>
<td><strong>noshade="noshade"</strong></td>
</tr>
<tr>
<td><strong>nowrap</strong></td>
<td><strong>nowrap="nowrap"</strong></td>
</tr>
<tr>
<td><strong>multiple</strong></td>
<td><strong>multiple="multiple"</strong></td>
</tr>
<tr>
<td><strong>noresize</strong></td>
<td><strong>noresize="noresize"</strong></td>
</tr>
</table>
<empty-line/>
<p>HTML 4.01 îïðåäåëÿåò àòðèáóò <strong>name</strong> äëÿ ýëåìåíòîâ <strong>a, applet, frame, iframe, img,</strong> è <strong>map</strong>. Â XHTML àòðèáóò <strong>name</strong> èñêëþ÷åí. Âìåñòî íåãî èñïîëüçóåòñÿ àòðèáóò <strong>id</strong>.</p>
<p>Íåïðàâèëüíî:</p>
<empty-line/>
<p><code>&lt;img src="picture.gif" name="ðèñ. 1" /&gt;</code></p>
<empty-line/>
<p>Ïðàâèëüíî:</p>
<empty-line/>
<p><code>&lt;img src="picture.gif" id="ðèñ. 1" /&gt;</code></p>
<empty-line/>
<p><strong>Ïðèìå÷àíèå:</strong> Äëÿ âçàèìîäåéñòâèÿ ñî ñòàðûìè áðàóçåðàìè â òå÷åíèå íåêîòîðîãî âðåìåíè íåîáõîäèìî áóäåò èñïîëüçîâàòü îáà àòðèáóòà <strong>name</strong> è <strong>id</strong>, ñ îäèíàêîâûìè çíà÷åíèÿìè àòðèáóòîâ, íàïðèìåð: <strong>&lt;img src="picture.gif" id="ðèñ. 1" name="ðèñ. 1" /&gt;</strong>.</p>
<p>Äëÿ ñîâìåñòèìîñòè XHTML ñ ñîâðåìåííûìè áðàóçåðàìè, íåîáõîäèìî äîáàâèòü äîïîëíèòåëüíûé ïðîáåë ïåðåä ñèìâîëîì "/".</p>
<p>Àòðèáóò <strong>lang</strong> ïðèìåíèì ïî÷òè ê ëþáîìó ýëåìåíòó XHTML. Îí îïðåäåëÿåò ÿçûê ñîäåðæèìîãî âíóòðè ýëåìåíòà.</p>
<p>Åñëè â êàêîì-òî ýëåìåíòå èñïîëüçóåòñÿ àòðèáóò <strong>lang</strong>, òî íåîáõîäèìî äîáàâèòü àòðèáóò <strong>xml:lang</strong>, íàïðèìåð: <strong>&lt;div lang="fr" xml:lang="fr"&gt;Bonjour, madam!&lt;/div&gt;</strong>.</p>
<p>Âñå äîêóìåíòû XHTML äîëæíû èìåòü îáúÿâëåíèå DOCTYPE. Òàêæå äîëæíû ïðèñóòñòâîâàòü ýëåìåíòû <strong>html, head è body</strong>, à âíóòðè ýëåìåíòà <strong>head</strong> äîëæåí ïðèñóòñòâîâàòü ýëåìåíò <strong>title</strong>.</p>
<p>Øàáëîí ìèíèìàëüíîãî äîêóìåíòà XHTML èìååò ñëåäóþùèé âèä:</p>
<empty-line/>
<p><code>&lt;!DOCTYPE Çäåñü îïðåäåëÿåòñÿ òèï äîêóìåíòà&gt;</code></p>
<p><code>&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;</code></p>
<p><code>&lt;head&gt;</code></p>
<p><code>&lt;title&gt;Çäåñü çàäàåòñÿ çàãîëîâîê &lt;/title&gt;</code></p>
<p><code>&lt;/head&gt;</code></p>
<p><code>&lt;body&gt;</code></p>
<p><code>&lt;/body&gt;</code></p>
<p><code>&lt;/html&gt;</code></p>
<empty-line/>
<p><strong>Ïðèìå÷àíèå:</strong> Îáúÿâëåíèå DOCTYPE íå ÿâëÿåòñÿ ÷àñòüþ ñàìîãî äîêóìåíòà XHTML. Ýòî îáúÿâëåíèå íå ÿâëÿåòñÿ ýëåìåíòîì XHTML è íå äîëæíî èìåòü çàêðûâàþùèé òåã.</p>
<p><strong>Ïðèìå÷àíèå:</strong> Àòðèáóò xmlns â òåãå <strong>&lt;html&gt;</strong> ÿâëÿåòñÿ â XHTML îáÿçàòåëüíûì. Îäíàêî ïðîãðàììà ïðîâåðêè (âàëèäàòîð) íà ñàéòå w3.org íå âûñêàçûâàåò ïðåòåíçèé, êîãäà ýòîò àòðèáóò îòñóòñòâóåò â äîêóìåíòå XHTML. Ýòî îáóñëîâëåíî òåì, ÷òî àòðèáóò "xmlns=http://www.w3.org/1999/xhtml" èìååò ôèêñèðîâàííîå çíà÷åíèå è áóäåò äîáàâëåí â òåã <strong>&lt;html&gt;</strong>, äàæå åñëè îí íå áûë âêëþ÷åí.</p>
<p>Â ñëåäóþùåì ðàçäåëå ïðåäñòàâëåíà äîïîëíèòåëüíàÿ èíôîðìàöèÿ îá îïðåäåëåíèè òèïà äîêóìåíòà XHTML.</p>
<p>Ñòàíäàðò XHTML îïðåäåëÿåò òðè îïðåäåëåíèÿ òèïà äîêóìåíòà (Document Type Definitions – DTD).</p>
<p>Íàèáîëåå ðàñïðîñòðàíåííûì ÿâëÿåòñÿ XHTML Transitional (Ïåðåõîäíûé).</p>
<p>Äîêóìåíò XHTML ñîñòîèò èç òðåõ îñíîâíûõ ÷àñòåé:</p>
<p>Òèï äîêóìåíòà DOCTYPE</p>
<p>Çàãîëîâîê (Head)</p>
<p>Òåëî (Body)</p>
<p>Áàçîâàÿ ñòðóêòóðà äîêóìåíòà èìååò ñëåäóþùèé âèä:</p>
<empty-line/>
<p><code>&lt;!DOCTYPE ...&gt;</code></p>
<p><code>&lt;html&gt;</code></p>
<p><code>&lt;head&gt;</code></p>
<p><code>&lt;title&gt;... &lt;/title&gt;</code></p>
<p><code>&lt;/head&gt;</code></p>
<p><code>&lt;body&gt; ... &lt;/body&gt;</code></p>
<p><code>&lt;/html&gt;</code></p>
<empty-line/>
<p>Îáúÿâëåíèå DOCTYPE âñåãäà äîëæíî ïðèñóòñòâîâàòü â ïåðâîé ñòðîêå äîêóìåíòà XHTML.</p>
<p>Ýòî ïðîñòîé (ìèíèìàëüíûé) äîêóìåíò XHTML:</p>
<empty-line/>
<p><code>&lt;!DOCTYPE html</code></p>
<p><code>PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"</code></p>
<p><code>"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</code></p>
<p><code>&lt;html&gt;</code></p>
<p><code>&lt;head&gt;</code></p>
<p><code>&lt;title&gt;ïðîñòîé äîêóìåíò &lt;/title&gt;</code></p>
<p><code>&lt;/head&gt;</code></p>
<p><code>&lt;body&gt;</code></p>
<p><code>&lt;p&gt;ïðîñòîé ïàðàãðàô &lt;/p&gt;</code></p>
<p><code>&lt;/body&gt;</code></p>
<p><code>&lt;/html&gt;</code></p>
<empty-line/>
<p>Îáúÿâëåíèå DOCTYPE îïðåäåëÿåò òèï äîêóìåíòà:</p>
<empty-line/>
<p><code>&lt;!DOCTYPE html</code></p>
<p><code>PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"</code></p>
<p><code>"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</code></p>
<empty-line/>
<p>Îñòàâøàÿñÿ ÷àñòü äîêóìåíòà âûãëÿäèò êàê HTML:</p>
<empty-line/>
<p><code>&lt;html&gt;</code></p>
<p><code>&lt;head&gt;</code></p>
<p><code>&lt;title&gt;ïðîñòîé äîêóìåíò &lt;/title&gt;</code></p>
<p><code>&lt;/head&gt;</code></p>
<p><code>&lt;body&gt;</code></p>
<p><code>&lt;p&gt; ïðîñòîé ïàðàãðàô &lt;/p&gt;</code></p>
<p><code>&lt;/body&gt;</code></p>
<p><code>&lt;/html&gt;</code></p>
<empty-line/>
<p><strong>[x]</strong> DTD îïðåäåëÿåò ñèíòàêñèñ Web-ñòðàíèöû íà SGML.</p>
<p><strong>[x]</strong> DTD èñïîëüçóåòñÿ ïðèëîæåíèÿìè SGML, òàêèìè êàê HTML, äëÿ îïðåäåëåíèÿ ïðàâèë, êîòîðûå ïðèìåíÿþò ïðè ðàçìåòêå äîêóìåíòîâ îïðåäåëåííîãî òèïà, âêëþ÷àÿ ìíîæåñòâî îáúÿâëåíèé ýëåìåíòîâ è ñóùíîñòåé.</p>
<p><strong>[x]</strong> XHTML çàäàí â îïðåäåëåíèè òèïà äîêóìåíòà SGML èëè 'DTD'.</p>
<p><strong>[x]</strong> DTD XHTML îïèñûâàåò òî÷íûì, ïîíÿòíûì äëÿ êîìïüþòåðà ÿçûêîì äîïóñòèìûé ñèíòàêñèñ è ãðàììàòèêó ðàçìåòêè XHTML.</p>
<p>Â íàñòîÿùåå âðåìÿ èìååòñÿ òðè òèïà äîêóìåíòîâ XHTML:</p>
<p><strong>[x]</strong> STRICT</p>
<p><strong>[x]</strong> TRANSITIONAL</p>
<p><strong>[x]</strong> FRAMESET</p>
<p>XHTML 1.0 îïðåäåëÿåò òðè òèïà äîêóìåíòîâ XML, êîòîðûå ñîîòâåòñòâóþò òðåì DTD: Strict, Transitional, è Frameset.</p>
<empty-line/>
<p><code>&lt;!DOCTYPE html</code></p>
<p><code>PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"</code></p>
<p><code>"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</code></p>
<empty-line/>
<p>Ýòî îïðåäåëåíèå DTD èñïîëüçóåòñÿ, êîãäà òðåáóåòñÿ ïîëó÷èòü äåéñòâèòåëüíî ÷åòêóþ ðàçìåòêó, íå èìåþùóþ â ïðåäñòàâëåíèè íèêàêîãî áåñïîðÿäêà. Îíî èñïîëüçóåòñÿ âìåñòå ñ êàñêàäíûìè òàáëèöàìè ñòèëåé.</p>
<empty-line/>
<p><code>&lt;!DOCTYPE html</code></p>
<p><code>PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"</code></p>
<p><code>"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</code></p>
<empty-line/>
<p>Èñïîëüçóéòå ýòî îïðåäåëåíèå, êîãäà íàäî âîñïîëüçîâàòüñÿ ñðåäñòâàìè ïðåäñòàâëåíèÿ HTML, è êîãäà íåîáõîäèìî îáåñïå÷èòü ïîääåðæêó äëÿ áðàóçåðîâ, êîòîðûå íå ïîíèìàþò êàñêàäíûå òàáëèöû ñòèëåé.</p>
<empty-line/>
<p><code>&lt;!DOCTYPE html</code></p>
<p><code>PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN"</code></p>
<p><code>"http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd"&gt;</code></p>
<empty-line/>
<p>Óêàæèòå ýòî îïðåäåëåíèå, êîãäà áóäóò èñïîëüçîâàòüñÿ ôðåéìû HTML, ÷òîáû ðàçäåëèòü îêíî áðàóçåðà íà äâà èëè áîëüøåå êîëè÷åñòâî ôðåéìîâ.</p>
<p>×òîáû ïðåîáðàçîâàòü Web-ñàéò ñ ÿçûêà HTML íà XHTML, íåîáõîäèìî çíàòü ïðàâèëà ñèíòàêñèñà XHTML, êîòîðûå áûëè ðàññìîòðåíû âûøå. Çàòåì íåîáõîäèìî âûïîëíèòü ñëåäóþùèå äåéñòâèÿ (â óêàçàííîì ïîðÿäêå):</p>
<p>Â êà÷åñòâå ïåðâîé ñòðîêè êàæäîé ñòðàíèöû äîáàâëÿþò ñëåäóþùåå îáúÿâëåíèå DOCTYPE:</p>
<empty-line/>
<p><code>&lt;!DOCTYPE html PUBLIC</code></p>
<p><code>"-//W3C//DTD XHTML 1.0 Transitional//EN"</code></p>
<p><code>"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</code></p>
<empty-line/>
<p>Ëó÷øå èñïîëüçîâàòü ñíà÷àëà ïåðåõîäíîå îïðåäåëåíèå DTD (Transitional). Ìîæíî âûáðàòü è ñòðîãîå îïðåäåëåíèå DTD (Strict), íî îíî íåìíîãî ñëèøêîì "ñòðîãîå" íà íà÷àëüíîì ýòàïå, è åìó òðóäíåå ñîîòâåòñòâîâàòü.</p>
<p>Web-còðàíèöû äîëæíû èìåòü îáúÿâëåíèå DOCTYPE, åñëè æåëàòåëüíî, ÷òîáû îíè áûëè îïðåäåëåíû êàê ïðàâèëüíûå ñîãëàñíî XHTML.</p>
<p>Íàäî ïîìíèòü, îäíàêî, ÷òî áîëåå íîâûå áðàóçåðû (òàêèå êàê Internet Explorer 6) ìîãóò îáðàáàòûâàòü äîêóìåíò ïî-ðàçíîìó, â çàâèñèìîñòè îò îáúÿâëåíèÿ <strong>&lt;!DOCTYPE&gt;</strong>. Åñëè áðàóçåð ÷èòàåò äîêóìåíò ñ DOCTYPE, òî îí ìîæåò èíòåðïðåòèðîâàòü äîêóìåíò êàê "ïðàâèëüíûé". Ïëîõî ñôîðìèðîâàííûé XHTML ìîæåò âûâîäèòüñÿ èíà÷å, ÷åì ïðè îòñóòñòâèè DOCTYPE.</p>
<p>Òàê êàê XHTML ðàçëè÷àåò ðåãèñòð ñèìâîëîâ, è ïîñêîëüêó XHTML äîïóñêàåò èìåíà òåãîâ è àòðèáóòîâ HTML òîëüêî â íèæíåì ðåãèñòðå, òî íåîáõîäèìî âûïîëíèòü ãëîáàëüíûé ïîèñê è çàìåíó âñåõ òåãîâ â âåðõíåì ðåãèñòðå òåãàìè, çàïèñàííûìè â íèæíåì ðåãèñòðå. Àíàëîãè÷íóþ ïðîöåäóðó íåîáõîäèìî âûïîëíèòü òàêæå äëÿ èìåí àòðèáóòîâ.</p>
<p>Òàê êàê ðåêîìåíäàöèÿ W3C äëÿ XTML 1.0 ãîâîðèò, ÷òî çíà÷åíèÿ âñåõ àòðèáóòîâ äîëæíû áûòü çàêëþ÷åíû â êàâû÷êè, òî íåîáõîäèìî ïðîâåðèòü âñå Web-ñòðàíèöû, ÷òîáû çíà÷åíèÿ âñåõ àòðèáóòîâ áûëè ïðàâèëüíî çàêëþ÷åíû â êàâû÷êè. Ýòî òðóäîåìêàÿ ðàáîòà, ïîýòîìó ðåêîìåíäóåòñÿ â áóäóùåì íèêîãäà íå çàáûâàòü èñïîëüçîâàòü êàâû÷êè äëÿ çíà÷åíèé àòðèáóòîâ.</p>
<p>Â XHTML ïóñòûå òåãè íå ðàçðåøåíû. Òåãè <strong>&lt;hr&gt;</strong> è <strong>&lt;br&gt;</strong> äîëæíû áûòü çàìåíåíû ñîîòâåòñòâåííî íà <strong>&lt;hr /&gt;</strong> è <strong>&lt;br /&gt;</strong>.</p>
<p>Ýòî ñîçäàåò ïðîáëåìó ñ áðàóçåðîì Netscape, êîòîðûé íåïðàâèëüíî èíòåðïðåòèðóåò òåã <strong>&lt;br/&gt;</strong>. Íî ê ñ÷àñòüþ, ïî íåèçâåñòíîé ïðè÷èíå, çàìåíà åãî íà <strong>&lt;br /&gt;</strong> ïðåêðàñíî ðàáîòàåò. Â ýòîì ñëó÷àå òàêæå íåîáõîäèìî âûïîëíèòü ãëîáàëüíûé ïîèñê è çàìåíó ñîîòâåòñòâóþùèõ òåãîâ.</p>
<p>Íåêîòîðûå äðóãèå òåãè (òàêèå êàê òåã <strong>&lt;img&gt;</strong>) ñòðàäàþò îò òàêîé æå ïðîáëåìû. Â äàííîì ñëó÷àå ìîæíî íå èñïîëüçîâàòü òåã çàìûêàíèÿ <strong>&lt;/img&gt;</strong>, à äîáàâèòü <strong>/&gt;</strong> â êîíöå òåãà.</p>
<p>Ïîñëå âûïîëíåíèÿ âñåõ ïðåîáðàçîâàíèé âñå èìåþùèåñÿ ñòðàíèöû ïðîâåðÿþòñÿ ñîãëàñíî îôèöèàëüíîìó DTD W3C ñ ïîìîùüþ ñëåäóþùåé ññûëêè íà XHTML Validator (<a l:href="http://validator.w3.org/check/referer">http://validator.w3.org/check/referer</a>). Âîçìîæíûå íå âûÿâëåííûå íà íà÷àëüíîì ýòàïå îøèáêè íàäî áóäåò îòðåäàêòèðîâàòü âðó÷íóþ. Íàèáîëåå ðàñïðîñòðàíåííîé îøèáêîé áûâàåò îòñóòñòâèå â ñïèñêàõ òåãîâ çàìûêàþùåãî <strong>&lt;/li&gt;</strong>.</p>
<p>Èìåþòñÿ ëè êàêèå-ëèáî ñïåöèàëüíûå èíñòðóìåíòàëüíûå ñðåäñòâà äëÿ ïðåîáðàçîâàíèÿ? Äà, ìîæíî èñïîëüçîâàòü óòèëèòó TIDY.</p>
<p>Áåñïëàòíàÿ óòèëèòà Äåéâà Ðàãåòòà HTML TIDY (<a l:href="http://www.w3.org/People/Raggett/tidy/">http://www.w3.org/People/Raggett/tidy/</a>) ïðåäíàçíà÷åíà äëÿ ïðîâåðêè êîäà HTML. Îíà òàêæå îòëè÷íî ñïðàâëÿåòñÿ ñ òðóäíî÷èòàåìûìè ðàçìåòêàìè äîêóìåíòîâ, ñîçäàííûìè ñïåöèàëüíûìè ðåäàêòîðàìè HTML è èíñòðóìåíòàëüíûìè ñðåäñòâàìè êîíâåðòàöèè, è ìîæåò ïîìî÷ü îïðåäåëèòü ìåñòà êîäà, òðåáóþùèå äîïîëíèòåëüíîãî âíèìàíèÿ, ÷òîáû ñäåëàòü Web-ñòðàíèöû áîëåå äîñòóïíûìè äëÿ ëþäåé ñ ôèçè÷åñêèìè íåäîñòàòêàìè.</p>
<p>Äîêóìåíò XHTML ïðîâåðÿåòñÿ ñîãëàñíî Îïðåäåëåíèþ òèïà äîêóìåíòà.</p>
<p>Äîêóìåíò XHTML ïðîâåðÿþò íà ñîîòâåòñòâèå îïðåäåëåíèþ òèïà äîêóìåíòà (DTD). Ïðåæäå ÷åì ìîæíî áóäåò ïðîâåðèòü ôàéë XHTML, íåîáõîäèìî äîáàâèòü â êà÷åñòâå ïåðâîé ñòðîêè ïðàâèëüíûé DTD.</p>
<p>Strict DTD ñîäåðæèò ýëåìåíòû è àòðèáóòû, êîòîðûå íå áûëè èñêëþ÷åíû è íå ñâÿçàíû ñ ôðåéìàìè:</p>
<empty-line/>
<p><code>!DOCTYPE html PUBLIC</code></p>
<p><code>"-//W3C//DTD XHTML 1.0 Strict//EN"</code></p>
<p><code>"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"</code></p>
<empty-line/>
<p><code>Transitional DTD ñîäåðæèò âñå èç Strict DTD ïëþñ èñêëþ÷åííûå ýëåìåíòû è àòðèáóòû:</code></p>
<empty-line/>
<p><code>!DOCTYPE html PUBLIC</code></p>
<p><code>"-//W3C//DTD XHTML 1.0 Transitional//EN"</code></p>
<p><code>"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</code></p>
<empty-line/>
<p><code>Frameset DTD ñîäåðæèò âñå èç Transitional DTD ïëþñ ôðåéìû:</code></p>
<empty-line/>
<p><code>!DOCTYPE html PUBLIC</code></p>
<p><code>"-//W3C//DTD XHTML 1.0 Frameset//EN"</code></p>
<p><code>"http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd"</code></p>
<empty-line/>
<p>Ïðîñòîé äîêóìåíò XHTML èìååò ñëåäóþùèé âèä:</p>
<empty-line/>
<p>&lt;!DOCTYPE html</p>
<p><code>PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"</code></p>
<p><code>"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</code></p>
<p><code>&lt;html&gt;</code></p>
<p><code>&lt;head&gt;</code></p>
<p><code>&lt;title&gt;ïðîñòîé äîêóìåíò &lt;/title&gt;</code></p>
<p><code>&lt;/head&gt;</code></p>
<p><code>&lt;body&gt;</code></p>
<p><code>&lt;p&gt;ïðîñòîé ïàðàãðàô &lt;/p&gt;</code></p>
<p><code>&lt;/body&gt;</code></p>
<p><code>&lt;/html&gt;</code></p>
<empty-line/>
<p>Ìîäåëü ìîäóëÿðèçàöèè XHTML îïðåäåëÿåò ìîäóëè XHTML.</p>
<p>XHTML ÿâëÿåòñÿ ïðîñòûì, íî áîëüøèì ÿçûêîì. XHTML ñîäåðæèò áîëüøèíñòâî ôóíêöèé, êîòîðûå ìîãóò ïîíàäîáèòüñÿ Web-ðàçðàáîò÷èêó.</p>
<p>Äëÿ íåêîòîðûõ öåëåé XHTML ÿâëÿåòñÿ ñëèøêîì áîëüøèì è ñëîæíûì, à äëÿ äðóãèõ öåëåé îí ñëèøêîì ïðîñò.</p>
<p>Ðàçäåëÿÿ XHTML íà ìîäóëè, êîíñîðöèóì W3C ñîçäàë íåáîëüøèå è ñòðîãî îïðåäåëåííûå ìíîæåñòâà ýëåìåíòîâ XHTML, êîòîðûå ìîæíî èñïîëüçîâàòü îòäåëüíî äëÿ ïðîñòûõ óñòðîéñòâ, à òàêæå â ñîåäèíåíèè ñ äðóãèìè ñòàíäàðòàìè XML â áîëüøèõ è áîëåå ñëîæíûõ ïðèëîæåíèÿõ.</p>
<p>Èñïîëüçóÿ ìîäóëüíîñòü XHTML, ðàçðàáîò÷èêè ïðèëîæåíèé ìîãóò:</p>
<p><strong>[x]</strong> Âûáèðàòü ýëåìåíòû, êîòîðûå áóäóò ïîääåðæèâàòüñÿ óñòðîéñòâîì, èñïîëüçóÿ ñòàíäàðòíûå ñòðîèòåëüíûå áëîêè XHTML.</p>
<p><strong>[x]</strong> Äîáàâëÿòü â XHTML ðàñøèðåíèÿ, èñïîëüçóÿ XML, è íå íàðóøàÿ ñòàíäàðò XHTML.</p>
<p><strong>[x]</strong> Óïðîùàòü XHTML äëÿ òàêèõ óñòðîéñòâ, êàê êàðìàííûå êîìïüþòåðû-êîììóíèêàòîðû, ìîáèëüíûå òåëåôîíû, ÒÂ óñòðîéñòâà, è óñòðîéñòâà áûòîâîé òåõíèêè.</p>
<p><strong>[x]</strong> Ðàñøèðÿòü XHTML äëÿ ñëîæíûõ ïðèëîæåíèé, äîáàâëÿÿ íîâûå ôóíêöèè XML (òàêèå êàê MathML, SVG, Voice and Multimedia).</p>
<p><strong>[x]</strong> Îïðåäåëÿòü ïðîôèëè XHTML, òàêèå êàê XHTML Basic (ïîäìíîæåñòâî XHTML äëÿ ìîáèëüíûõ óñòðîéñòâ).</p>
<p>Êîíñîðöèóì W3C ðàçäåëèë îïðåäåëåíèå XHTML íà 28 ìîäóëåé:</p>
<empty-line/>
<table>
<tr>
<th>Èìÿ ìîäóëÿ</th>
<th>Îïèñàíèå</th>
</tr>
<tr>
<td>ìîäóëü <strong>Applet</strong></td>
<td>Îïðåäåëÿåò èñêëþ÷åííûé ýëåìåíò <strong>applet</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Base</strong></td>
<td>Îïðåäåëÿåò ýëåìåíò <strong>base</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Basic Forms</strong></td>
<td>Îïðåäåëÿåò áàçîâûå ýëåìåíòû ôîðì</td>
</tr>
<tr>
<td>ìîäóëü <strong>Basic Tables</strong></td>
<td>Îïðåäåëÿåò áàçîâûå ýëåìåíòû òàáëèö</td>
</tr>
<tr>
<td>ìîäóëü <strong>Bi-directional Text</strong></td>
<td>Îïðåäåëÿåò ýëåìåíò <strong>bdo</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Client Image Map</strong></td>
<td>Îïðåäåëÿåò ýëåìåíòû êàðò-èçîáðàæåíèé íà ñòîðîíå áðàóçåðà</td>
</tr>
<tr>
<td>ìîäóëü <strong>Edit</strong></td>
<td>Îïðåäåëÿåò ýëåìåíòû ðåäàêòèðîâàíèÿ <strong>del</strong> è <strong>ins</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Forms</strong></td>
<td>Îïðåäåëÿåò âñå ýëåìåíòû, èñïîëüçóåìûå â ôîðìàõ</td>
</tr>
<tr>
<td>ìîäóëü <strong>Frames</strong></td>
<td>Îïðåäåëÿåò ýëåìåíòû, ñâÿçàííûå ñ ôðåéìàìè</td>
</tr>
<tr>
<td>ìîäóëü <strong>Hypertext</strong></td>
<td>Îïðåäåëÿåò ýëåìåíò <strong>a</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Iframe</strong></td>
<td>Îïðåäåëÿåò ýëåìåíò <strong>iframe</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Image</strong></td>
<td>Îïðåäåëÿåò ýëåìåíò <strong>img</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Intrinsic Events</strong></td>
<td>Îïðåäåëÿåò àòðèáóòû ñîáûòèé, òàêèå êàê <strong>onblur</strong> è <strong>onchange</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Legacy</strong></td>
<td>Îïðåäåëÿåò èñêëþ÷åííûå ýëåìåíòû è àòðèáóòû</td>
</tr>
<tr>
<td>ìîäóëü <strong>Link</strong></td>
<td>Îïðåäåëÿåò ýëåìåíò <strong>link</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>List</strong></td>
<td>Îïðåäåëÿåò ýëåìåíòû ñïèñêà <strong>li, ul, dd, dt</strong>, è <strong>dl</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Metainformation</strong></td>
<td>Îïðåäåëÿåò ýëåìåíò <strong>meta</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Name Identification</strong></td>
<td>Îïðåäåëÿåò èñêëþ÷åííûé àòðèáóò <strong>name</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Object</strong></td>
<td>Îïðåäåëÿåò ýëåìåíòû <strong>object</strong> è <strong>param</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Presentation</strong></td>
<td>Îïðåäåëÿåò ýëåìåíòû ïðåäñòàâëåíèÿ, òàêèå êàê <strong>b</strong> è <strong>i</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Scripting</strong></td>
<td>Îïðåäåëÿåò ýëåìåíòû <strong>script</strong> è <strong>noscript</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Server Image Map</strong></td>
<td>Îïðåäåëÿåò ýëåìåíòû êàðò-èçîáðàæåíèé íà ñåðâåðå</td>
</tr>
<tr>
<td>ìîäóëü <strong>Structure</strong></td>
<td>Îïðåäåëÿåò ýëåìåíòû <strong>html, head, title</strong> è <strong>body</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Style Attribute</strong></td>
<td>Îïðåäåëÿåò àòðèáóò <strong>style</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Style Sheet</strong></td>
<td>Îïðåäåëÿåò ýëåìåíò <strong>style</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Tables</strong></td>
<td>Îïðåäåëÿåò ýëåìåíòû, èñïîëüçóåìûå â òàáëèöàõ</td>
</tr>
<tr>
<td>ìîäóëü <strong>Target</strong></td>
<td>Îïðåäåëÿåò àòðèáóò <strong>target</strong></td>
</tr>
<tr>
<td>ìîäóëü <strong>Text</strong></td>
<td>Îïðåäåëÿåò ýëåìåíòû êîíòåéíåðà òåêñòà, òàêèå êàê <strong>p</strong> è <strong>h1</strong></td>
</tr>
</table>
<empty-line/>
<p>Èñêëþ÷åííûå ýëåìåíòû íå äîëæíû èñïîëüçîâàòüñÿ â XHTML.</p>
<p>Òåãè XHTML ìîãóò èìåòü àòðèáóòû. Àòðèáóòû êàæäîãî òåãà ïåðå÷èñëåíû â îïèñàíèè òåãà. Çäåñü ïðåäñòàâëåíû áàçîâûå àòðèáóòû è àòðèáóòû ÿçûêà, êîòîðûå ÿâëÿþòñÿ ñòàíäàðòíûìè äëÿ âñåõ òåãîâ (ñ íåáîëüøèìè èñêëþ÷åíèÿìè).</p>
<p>Íåäåéñòâèòåëüíû â ýëåìåíòàõ <strong>base, head, html, meta, param, script, style</strong> è <strong>title</strong>. </p>
<empty-line/>
<table>
<tr>
<th>Àòðèáóò</th>
<th>Çíà÷åíèå</th>
<th>Îïèñàíèå</th>
</tr>
<tr>
<td><strong>class</strong></td>
<td><strong>ïðàâèëî_êëàññà</strong> èëè <strong>ïðàâèëî_ñòèëÿ</strong></td>
<td>Êëàññ ýëåìåíòà</td>
</tr>
<tr>
<td><strong>id</strong></td>
<td><strong>èìÿ_id</strong></td>
<td>Óíèêàëüíûé id ýëåìåíòà</td>
</tr>
<tr>
<td><strong>style</strong></td>
<td><strong>îïðåäåëåíèå_ñòèëÿ</strong></td>
<td>Âñòðîåííîå îïðåäåëåíèå ñòèëÿ</td>
</tr>
<tr>
<td><strong>title</strong></td>
<td><strong>òåêñò_ïîäñêàçêè</strong></td>
<td>Òåêñò äëÿ âûâîäà ïîäñêàçêè</td>
</tr>
</table>
<empty-line/>
<p>Íåäåéñòâèòåëüíû â ýëåìåíòàõ <strong>base, br, frame, frameset, hr, iframe, param</strong>, è <strong>script</strong>.</p>
<empty-line/>
<table>
<tr>
<th>Àòðèáóò</th>
<th>Çíà÷åíèå</th>
<th>Îïèñàíèå</th>
</tr>
<tr>
<td><strong>dir</strong></td>
<td><strong>ltr | rtl</strong></td>
<td>Çàäàåò íàïðàâëåíèå òåêñòà</td>
</tr>
<tr>
<td><strong>lang</strong></td>
<td><strong>êîä_ÿçûêà</strong></td>
<td>Çàäàåò êîä ÿçûêà</td>
</tr>
</table>
<empty-line/>
<table>
<tr>
<th>Àòðèáóò</th>
<th>Çíà÷åíèå</th>
<th>Îïèñàíèå</th>
</tr>
<tr>
<td><strong>accesskey</strong></td>
<td>ñèìâîë</td>
<td>Çàäàåò êëàâèàòóðíîå ñîêðàùåíèå äëÿ äîñòóïà ê ýëåìåíòó</td>
</tr>
<tr>
<td><strong>tabindex</strong></td>
<td>÷èñëî</td>
<td>Çàäàåò ïîðÿäîê ýëåìåíòà ïðè ïåðåõîäå ïî êëàâèøå òàáóëÿöèè</td>
</tr>
</table>
<empty-line/>
<p>Íîâûì â HTML 4.0 áûëà âîçìîæíîñòü äëÿ ñîáûòèé HTML çàïóñêàòü â áðàóçåðå äåéñòâèÿ, òàêèå êàê çàïóñê ñöåíàðèÿ JavaScript, êîãäà ïîëüçîâàòåëü ùåëêàë íà ýëåìåíòå HTML. Íèæå ïðåäñòàâëåí ñïèñîê àòðèáóòîâ, êîòîðûå ìîæíî âñòàâëÿòü â òåãè HTML äëÿ îïðåäåëåíèÿ äåéñòâèé ñîáûòèé.</p>
<p>Áîëåå ïîäðîáíî îá èñïîëüçîâàíèè ýòèõ ñîáûòèé â ïðîãðàììèðîâàíèè ìîæíî óçíàòü â ðóêîâîäñòâå ïî JavaScript è ðóêîâîäñòâå ïî DHTML.</p>
<p>Äåéñòâèòåëüíû òîëüêî â ýëåìåíòàõ <strong>body</strong> è <strong>frameset</strong></p>
<empty-line/>
<table>
<tr>
<th>Àòðèáóò</th>
<th>Çíà÷åíèå</th>
<th>Îïèñàíèå</th>
</tr>
<tr>
<td><strong>onload</strong></td>
<td>ñöåíàðèé</td>
<td>Ñöåíàðèé, êîòîðûé âûïîëíÿåòñÿ ïðè çàãðóçêå äîêóìåíòà</td>
</tr>
<tr>
<td><strong>onunload</strong></td>
<td>ñöåíàðèé</td>
<td>Ñöåíàðèé, êîòîðûé âûïîëíÿåòñÿ ïðè âûãðóçêå äîêóìåíòà</td>
</tr>
</table>
<empty-line/>
<p>Äåéñòâèòåëüíû òîëüêî â ýëåìåíòàõ ôîðì.</p>
<empty-line/>
<table>
<tr>
<th>Àòðèáóò</th>
<th>Çíà÷åíèå</th>
<th>Îïèñàíèå</th>
</tr>
<tr>
<td><strong>onchange</strong></td>
<td>ñöåíàðèé</td>
<td>Ñöåíàðèé, êîòîðûé âûïîëíÿåòñÿ ïðè èçìåíåíèè ýëåìåíòà</td>
</tr>
<tr>
<td><strong>onsubmit</strong></td>
<td>ñöåíàðèé</td>
<td>Ñöåíàðèé, êîòîðûé âûïîëíÿåòñÿ ïðè îòïðàâêå ôîðìû</td>
</tr>
<tr>
<td><strong>onreset</strong></td>
<td>ñöåíàðèé</td>
<td>Ñöåíàðèé, êîòîðûé âûïîëíÿåòñÿ ïðè ñáðîñå ôîðìû</td>
</tr>
<tr>
<td><strong>onselect</strong></td>
<td>ñöåíàðèé</td>
<td>Ñöåíàðèé, êîòîðûé âûïîëíÿåòñÿ ïðè âûáîðå ýëåìåíòà</td>
</tr>
<tr>
<td><strong>onblur</strong></td>
<td>ñöåíàðèé</td>
<td>Ñöåíàðèé, êîòîðûé âûïîëíÿåòñÿ, êîãäà ýëåìåíò òåðÿåò ôîêóñ</td>
</tr>
<tr>
<td><strong>onfocus</strong></td>
<td>ñöåíàðèé</td>
<td>Ñöåíàðèé, êîòîðûé âûïîëíÿåòñÿ, êîãäà ýëåìåíò ïîëó÷àåò ôîêóñ</td>
</tr>
</table>
<empty-line/>
<p>Íåäåéñòâèòåëüíû â ýëåìåíòàõ <strong>base, bdo, br, frame, frameset, head, html, iframe, meta, param, script, style</strong> è <strong>title</strong>.</p>
<empty-line/>
<table>
<tr>
<th>Àòðèáóò</th>
<th>Çíà÷åíèå</th>
<th>Îïèñàíèå</th>
</tr>
<tr>
<td><strong>onkeydown</strong></td>
<td>ñöåíàðèé</td>
<td>Äåéñòâèå ïîñëå íàæàòèÿ êëàâèøè</td>
</tr>
<tr>
<td><strong>onkeypress</strong></td>
<td>ñöåíàðèé</td>
<td>Äåéñòâèå ïîñëå íàæàòèÿ è îòïóñêàíèÿ êëàâèøè</td>
</tr>
<tr>
<td><strong>onkeyup</strong></td>
<td>ñöåíàðèé</td>
<td>Äåéñòâèå ïîñëå îòïóñêàíèÿ êëàâèøè</td>
</tr>
</table>
<empty-line/>
<p>Íåäåéñòâèòåëüíû â ýëåìåíòàõ <strong>base, bdo, br, frame, frameset, head, html, iframe, meta, param, script, style</strong> è <strong>title</strong>.</p>
<empty-line/>
<table>
<tr>
<th>Àòðèáóò</th>
<th>Çíà÷åíèå</th>
<th>Îïèñàíèå</th>
</tr>
<tr>
<td><strong>onclick</strong></td>
<td>ñöåíàðèé</td>
<td>×òî äåëàòü ïðè ùåë÷êå ìûøè</td>
</tr>
<tr>
<td><strong>ondblclick</strong></td>
<td>ñöåíàðèé</td>
<td>×òî äåëàòü ïðè äâîéíîì ùåë÷êå ìûøè</td>
</tr>
<tr>
<td><strong>onmousedown</strong></td>
<td>ñöåíàðèé</td>
<td>×òî äåëàòü ïðè íàæàòèè êíîïêè ìûøè</td>
</tr>
<tr>
<td><strong>onmousemove</strong></td>
<td>ñöåíàðèé</td>
<td>×òî äåëàòü ïðè ïåðåìåùåíèè óêàçàòåëÿ ìûøè</td>
</tr>
<tr>
<td><strong>onmouseover</strong></td>
<td>ñöåíàðèé</td>
<td>×òî äåëàòü ïðè ïåðåìåùåíèè óêàçàòåëÿ ìûøè íàä ýëåìåíòîì</td>
</tr>
<tr>
<td><strong>onmouseout</strong></td>
<td>ñöåíàðèé</td>
<td>×òî äåëàòü ïðè ñìåùåíèè óêàçàòåëÿ ìûøè ñ ýëåìåíòà</td>
</tr>
<tr>
<td><strong>onmouseup</strong></td>
<td>ñöåíàðèé</td>
<td>×òî äåëàòü ïðè îòïóêàíèè íàæàòîé êíîïêè ìûøè</td>
</tr>
</table>
<empty-line/>
<p>Â äàííîì ðóêîâîäñòâå áûëî ïîêàçàíî, êàê ñîçäàâàòü áîëåå ñòðîãèå è ÷åòêèå ñòðàíèöû HTML.</p>
<p>Ãëàâíîå çàêëþ÷àåòñÿ â òîì, ÷òî âñå ýëåìåíòû XHTML äîëæíû áûòü ïðàâèëüíî âëîæåíû, äîêóìåíòû XHTML äîëæíû áûòü ñèíòàêñè÷åñêè ïðàâèëüíûìè, âñå èìåíà òåãîâ äîëæíû áûòü çàïèñàíû â íèæíåì ðåãèñòðå, è âñå ýëåìåíòû XHTML äîëæíû áûòü çàêðûòû.</p>
<p>Âàæíî òàêæå òî, ÷òî âñå äîêóìåíòû XHTML äîëæíû èìåòü îáúÿâëåíèå DOCTYPE, è ÷òî äîëæíû ïðèñóòñòâîâàòü ýëåìåíòû <strong>html, head, title</strong>, è <strong>body</strong>.</p>
<p>Äîïîëíèòåëüíóþ èíôîðìàöèþ î XHTML ìîæíî íàéòè â ëþáîì ñïðàâî÷íîì ðóêîâîäñòâå ïî XHTML.</p>
<p>Ñëåäóþùèé øàã ñîñòîèò â èçó÷åíèè CSS è JavaScript.</p>
<p>CSS èñïîëüçóåòñÿ äëÿ óïðàâëåíèÿ ñòèëåì è êîìïîíîâêîé Web-ñòðàíèö.</p>
<p>Ïðè èñïîëüçîâàíèè CSS âñå ôîðìàòèðîâàíèå ìîæíî âûíåñòè èç äîêóìåíòà HTML è ñîõðàíèòü â îòäåëüíîì ôàéëå.</p>
<p>CSS ïðåäîñòàâëÿåò ïîëíûé êîíòðîëü íàä êîìïîíîâêîé, íå ñîçäàâàÿ ïóòàíèöó â ñîäåðæèìîì äîêóìåíòà.</p>
<p>Ïîçíàêîìèòüñÿ ñ êàñêàäíûìè òàáëèöàìè ñòèëåé ìîæíî â ëþáîì ðóêîâîäñòâå ïî CSS.</p>
<p>ßçûê JavaScript ìîæåò ñäåëàòü Web-ñàéò áîëåå äèíàìè÷íûì.</p>
<p>Ñòàòè÷íûé Web-ñàéò âïîëíå ïîäõîäèò äëÿ âûâîäà ïðîñòîãî ñîäåðæèìîãî, íî äèíàìè÷íûé Web-ñàéò ìîæåò ðåàãèðîâàòü íà ñîáûòèÿ è ïîçâîëÿåò îðãàíèçîâàòü âçàèìîäåéñòâèå ñ ïîëüçîâàòåëåì.</p>
<p>JavaScript ÿâëÿåòñÿ íàèáîëåå ïîïóëÿðíûì ÿçûêîì ñöåíàðèåâ â Èíòåðíåò, è îí ðàáîòàåò ñî âñåìè îñíîâíûìè áðàóçåðàìè.</p>
<p>Áîëåå ïîäðîáíî ïîçíàêîìèòüñÿ ñ JavaScript ìîæíî ñ ïîìîùüþ ëþáîãî ðóêîâîäñòâà ïî JavaScript.</p>
</section>
</body>
<binary content-type="image/png" id="img1.png">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</binary>
<binary content-type="image/png" id="logo.png">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</binary>
<binary content-type="image/png" id="scope1.png">iVBORw0KGgoAAAANSUhEUgAAAXQAAABsCAMAAABNT7kjAAADAFBMVEUEAgR/goTExMdEQ0Tk4+Sjo6QwQpwEF4zT09Xz9Pl8foScpNJ2g8IbMZRhYWPq7PQkIyS+xOK8vsREVarP0+tXZbJndLqTlJaJlMnj5fSzsrYPJJD8/vxub3QxMjRUVFQoO5wTEhSutNqMio2srrIsLjScnKE8PkMcHiTMzc5MTVI6TKTY3NyAjMTHzeTa3elebLRxfLySnMwMDgyjq9RLXKy0vNwkNpy8urxkZmQUKpRcWlwHHox0dnTh5Ow0RqQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACY8PhlAAABAHRSTlP/////////////////////////////////////AP//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////vwpYTwAAAAlwSFlzAAAATwAAAE8BY4r91wAAD+JJREFUeNrtXYliqjoQDW5tBIw+EUGpWrWLdV8QS63+/1+9mQAKqC1Ya3vvZUB2SHJmMtkOSIygrBqEvDEjke8UEtylxZXB3tMJLtcEfcXx7hhG7zUNywwsmbHqvuMO66RfBwlilwedzV+76FzYfWfV6LB5Z9VMG5057hjN5qozTzzP5UE3es170uwZ1VfDGKxwaRQHnSbsFAdF2Hl9TCC7POiI++s963S4m8FlesVXZEVQOglkFwf9kYPaWAl5WFU772jpPVyx+14DdhKf/g2g9+Y9QPaeDeYro5Me3MOyCD69x17fjWIHnMwqgezy7uXxPp2eg+PuFkm65y47zSJ5ZUYvTe4T7/I9Pn21CtdQOkKC03cXpAfSSez7+qCvEkd+fdAT+SbQWfWtQaJKo1nNJNB9GfRXEldeE+y+BnoqTUgzm4p6D+1lXwhJpxL0vgB6l5BiXAR7RUJqCXxng14j5I7GvpG9E9JN8DsT9MycBBo/h/if0IhA7pPi9EzQm6R5FGaKS/oR8E3ylgB4FugZQgZHIffv0tBRZz0gZG/qVFFoAmdE0KtgrvSDyZmdrfC5JqnuMF+YFSWBMyLobyRLOZy72QWZBlb7yTsGy8edf6Ht/lrVEzgjgl4ktyFQaRBqKqRgWU03awf4D0jRw7wsm6UEzaigz0mGhmRnylwEsqK02shW57fhCxlxGrR0WbYTzGOATkgYSuE/SrPd/2q1bq1LaSPdgGUafu9C+ErqgA52bpcXOnOEMk9z1HFWhm9hJIWtAzoLIZltZLrFzHsahdIaTdcYRc100ydAb7fW9Vaun9vmtv1c35MyiAlSMScgqjqdSpI01LSZKC7a7eWyBDIaKYoy3uigMBq5ffB3WDpzJ2dB2V2h+B9l3lGGVo4X1dK7i9wNF/TJzWey5tPNer2uo9i2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</binary>
<binary content-type="image/png" id="scope2.png">iVBORw0KGgoAAAANSUhEUgAAATwAAAC+CAMAAACf1ENTAAADAFBMVEUEAgSCgoTExMhDQ0Tk5OSjo6QsQpwEGIzz9PiYpNDS09V4hMJ8foRhYWPq7PQkIyQcL5SysrZXY7GTlZbO0+xndLrAxOO8vsRvcHRUVFTi5fT8/vyHlMdEVaoOJI80MjQTEhSus9wnPJyMioxMTVGsrbJlZ2UsLjScm54cHiTMzc08PkM5TaSkq9Ta3dyBjMRdbbTb3eZxfLzHy+SPnMwMDgxMW6y2vNy8urxcWlwkNpwUKpQHHox0dnTh5Ow0RqQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB7V0p+AAABAHRSTlP///////////////////////////////////8A////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////QFpgwwAAAAlwSFlzAAAATwAAAE8BY4r91wAADyhJREFUeNrtnQtDqjwYx4fg607hkLBSqKy8JZYdKgqPRd//W70bqGxcjFsCykTkpid+Z4xn4/88D9AKLhNQ2TIBRcMr/A/I8KfX8Gp4NbwaXg2vYHjWAIAlquGlgQclS0NffA0vDTzL4TbUNH3C4/kCz5Fmjb/IChryk0UNLxoeup2MyUULzaE1GCI87/Pa0FnR+n1raKIaXnSbp/dvQV/XlAmudtYDnmvSYtjHK9JCIp2ShxrezrutPrmFQ44scfhi1XjL+QCW0y8a1vAi4T04cAYWJzorX6Tm6eQD3eoDvFK3eTvg6bc6JnSLFqalDfnFLZ5L2vBWR5MvTRrii9eq4UVftg+3PH+LG7axBHh9PR/2JTBBms6D22Fd83a2eZblv6O6DWBt56Xqng2HNbzU8CyrhlcPDPwWPKT0B7EHwQd9RajhbUvyxxmTGt7aupsD0G/qsb+oN0cA8I0aHi5jAKZJSegSAHINT5MB6MHEX4Y9AMZHD08wwZCw8/PbxdPZx4Fb4djh9UGfZkJzhM6L2kbthOSbyyOHJwCwcFn4MUEfUvoAZ30BgHDc8BSwhFqslzvRryVQjhveEjwwfLZX63YD3F6+1KXs7Hso7LotCTwJnLD1C26rGNxUN4HHBcL1vs0uDS6AdNzwTCDAYKEg4kkeyLIcchQq7BxKAg+AECrwkoNQ4ASZFB1yHAwvNbxQLAMF8pzFz3l+jpfmwFRqeGHwEK5kEEH36kVkwi9d6o22GzBJXbp096yPdBZqeIBQWGMS1oDwh4jbQp374jhRdrZxHIJrsNvPus0DaF2gMzlvhITZVEQnIi7cWFfwhp5IHbNZqOGhsDISF6a1XjbMMRrP9JCjCoSXq6B6kh2e7c2HU4R5LdbbLQnMHuhjnLpZLDyQezVKZecZDhLbz2/33JkZwDxueBJo2GiDL/bkfjYK7GGUAh7u3G9gJHmRmaoU2LctBTwF9G3VxkV13z8ubzchu1/gqEop4AkAX7dbRHHe28VGkeN5pYCntcGIqk5J8I2KHEkuBzzBBKJqqwYBYsR72waZi4U+wygHPPLkcWJgHCqZ2THe7mtS7NOziPNN5wqRHh6RC0gyxkKqVLzJNmSpUNFAFLyUrhAZ4GkNHoCRIhsYYKxJVkYAzItVDESIC9O5QoBMV3r1tCrh55vSFSIbvOqppKKk/KlcITLCq1jZdbdN4Qqxz5q31xJazaPgpXSF2Hebt9+QAnHhpXSFyAIvqT5vryVUDBh52aZzhcgAL40+b7/8AmLAHW1eGleI9PDS6fP2WgJiwETds59dIbL0bYe0QCpaqwfDxWa06sz/lZC10P8nGLmw/oeGbEc6EbyfXSFSw6P0eezpQA9T1DkzAiDvVCGzxlBgd8AwrjAUOSsGLM94nqfPoyfmP94jGHIUs86e+pYYDFYmvxgQ+hizu1gxYABeNiM//UjyMrY6b/chyXdE/gNhckBGDOiHl7F7mf4ZxkMsJSN9MYcL+JhZYBuzK6D98/0+9LcSeEOTvm5ZeNgIyeYKkf7p2cmuyuCdOiXOi5I/JqmLP/2+X/KmndCP6hh42NSSsrlCpH9uK0ToxwJnELbdW27CpEVLtJ15wk7Dy8EVIi28CIlZ4iLz8JdLBDxiavnuRDHNP8/62Ts8IpbSm8v+yUmb5wTYnik60fBxUG7227LM8W2nSnMNXCnlE+XX4BFTC+6wsujbN6u59qyf9PC2+jzkSszWl7HgbnYVZwKkF4WNEE0GnLKYceM2D5eSMubxVoA4s9nkJFGeLsk3mlNBlhZEaLX+EejpAXf9/ubQtSaQ/HIoPGxqGQF7SdOCxjwMGI+e9ZOh5iFffUL0aVErzHbnNMdTiJQ2Pj9Jx+TGPNE7Qq6HIIfBOasI9paSRf26JwHc/fvUoWgXPMWpeD+/wu5e24f2GWqev2xFeL4VZruzLs8REh2zaYwXyRrCNY9DzttZhUgweyhUArj79+lDYUDP5sFbgmaklcWK/H1mAG395AgvfhkTeISNThZxVSPwvkQM78vdiYs4MBcojxIOjzW1KFhbU4lr4LnC92XaLNIY6ydPeHbEiu0/jvDRifTRNMZTZJk66gEkijZ+b+BZpiGOwiSAP/1+QNUWDi/C1PJMRQ7gVkMZNBXzJNL6yaTP89Rj9J9rBxV5iJGjuXweZmDWtBczye6Z5hA44PDbHvP4kMX0AdlzcTwPkQDu/n0/akYM6MELWgvu/f3ScYOAcMBPxxDO8VKPi7yBZ9LnBZR3tg9T5u2TMJ1fnN/ZTo3wHkYQXnMgyDOhN+fxC9+2IC+T2xg2Dea5w3P1eew5sDK84GLy7cZD6t9xXnhSwvu2jKnl2gr4/t7YmgQIznHNIwc5ltTWEcK5l2eF5+rzVE98txVDqWVZVh16/fBRFdbUchwc8P0dW1DEDeKLrOKah8hBxHSi3CCStXno9aKLwsbzGvZGOabS+rtSLG8BNiLG89gbnmPgcFN8f1dEkRM5sjofIzSwIDELoM8iig/v9f37+vTPB0Jsd3ijz6Oqner95UUuM4LUUcRIctBauDQX1P0dIR7DE5eGPh1HWj8/w+u+/Ot0Oo9np2+vvmcYrj5PNVRPgleGZedvsh3tliFGPcPwwbOd+zuai97NmtS8xQiY4maLkAKeZny8nZ+tVq3OOaS/4unz7PLNnQXbiH56FjC1Ys9tz/qJd8Mwnt9brdYLA4/S55Vvcl5BMSDdw2BNrQSTZ/3Egte9emx1Vp0731eS6vP2OoWKAem+rULZWUk8IWzP+olz2T5d33yena8euwekVUnsCrGxKBBl/fwID338XbUer16fV3/VA1JJJXeF2DJsxB7Puzj917o/vdDQWecZHpI+L4UrxHo2ijmS3H37bq3+3mETr/t4f3dQ4sYUrhCq4bN+dpFQn95vPq//OFfrU+fx9aDgpXWFiPf0DH787bS+r9Z3iad/5+phwcvBFSKSxOvpfavzcrF57vF6daEdGLzsrhARJIy3x8/V2Z3q1UOoHRy839GqqHfvq8/HNzU3YVVZ4eWvkoIfL9g8ee7mqEorLby89Xmvz9+tzvlHtP6g0hn3MtY8tBOe8ee6dfN+p2qHWX6zzUN3Z7gv9mZo2jHAS+oK0Wj2o/V58II0dqevmnYU8NK4QjSi9HndK9IX+0DaccDLU59nP11/fr4/qZp2HPAcfd4OLwZmM72LC/Rt0Z0z8NTVtGOBt3GF8Evx6aC7MBStX593gfti/04vNO1o4K31eWwYYsbHgXHBoY9h9Xndt8f1wNPxwIvQ58VyY6BGkuHT2edm4Ol44Hn6PEaQ5xfrhfosUPq8i3tv4ClWOYgeRpgrRJiHg+coA8P0ed0zb+ApZY+ugn3bEH2ewqjHm1DoE779BkZ20ovQ50GUsLE7CHghan42MjHeP+Qh7LXxcmPA5yoxOyh4jfa8fwk5EQoc3z6BJ832SAEihH1OnuEK2jSX8xpemD6PSO9MTuZmpOaN+mPOFGQgKgrA9dAwJRJz91IgAkeUnz7vAGre1jFh0URQJ3J8fYYgag/lKQFEtHij2cJh5mr0UujzYsGrTE7vUJUUNwczIoqWnVuyOHZ9GxBqDno9R5lHBPup9Hlx4FUnp3cYvCGR4BF41nTj3uDAW5jWQhpvfB9S6fPiwKtOTu8weOIILdqOHH8mIn02duEt0Ei0kYUvXNuFJ/wSvOrk9A7o84iucQ7MnqljeNaciBkdZ4YREOdrssjdklaf92ObV5mc3vvX58W621Yjp/e+9Xkx4FUnp/d+9Xmx4FUnp/de9XkxL9vK5PTeoz4vQZtXkZzee9PnZeyelTKn9570eZnhlTKn9370eQc+MEDKb+nz4sKreLTagmJJ5fKPFw6voChmjnVXwZzeJQmsX82c3iWpedXM6V2ONs8NZBUMuhigRX2WIKd3KeLnsTFD/UoZGIhXSR3ZL0kmluLi57lCmaAKxoPF5viGJcnpXYr4eWFCGS1mlu9lGbJPrePnRVwd0c1PiD4vMbxgICsNxgNZbE7vgD4vpFXWNF/cPDYuXPb4eZGBrDzJDNfAH0wkK634nN6sPg9qQTFjRIBhj2P2+HlRMUPjRLIqQ6LMuPHzwq6lZfb4eTB9JKsSwIvQ54VG3PUfl0P8PCpmIxPJigSy4plIVnwJ4cXV57kh9dhNecTPWwtl4DbAJIlkhbwU33MZEXhI5tcpvVEJcnon1OdB2NfhSZtop3KMn+cFshK2ETpJJCs45L5IMCa8gXfCgCESQw1RlFEp2rwk+jyJkzkzT4lZWE5vJpKVG4xp0HADXLLxPcsGb7c+75I0OwP5V+BFRrKaR0ayKgW8mPo892IRJH0TURjlCm8t4/AiWa23UJGsypfTO7Y+z1XkTSbbqMx5xQytcE7vJPo8hJZtJtKwBw+fTKoeRrVzeifR5y2mvaj4ea+PCZ1/DiKndwJ9njEd+iIKU/C+6RAgCUZVKp3TO4E+bx1LPFSfBz/OO4l8gA4ip3du+jwS9qh1/cdONJJc8ZzeOerzSHTB2E7eB5HTO1d93trjFsaGV/Gc3vnq8xxf7++3bmx4Fc/pnbM+T/1z/XkTI8rAYeT0zl2f1736r7XaFczH/5Uqa1Vy1+e5kVWeX+PCq7RKKn99nnp3RgKYGTHhVaz8uj4vEDovt5pXvpzev6BV6T6ToI2RTd8h5fT+BZWU02O7j+qxHWJO75StQPhm3PSReCFe0wcR9H/lsHJ65wjPafpauOnb9Ng+vOBmx5LTOwM8N17tpscGr1anyN+3PfCc3pnguWHh/3OaPvh2c20wX6lzev9ktKlP76THZmvaxX/fH77xvEPI6f2b8LyIhOpZ5woyI8nVzOk9+VVTKFBIXoJ/px8vq3OVeYZRzZze+75nuYEJzzpMMpGq5vTe/y1f/XP2eXOzeqLgVTWndwEGk/r2/tlq0dmnqprTe9/kjI+rv++rzuf9Sx7wCs7pvWd23Zf7Tuff4/nVk6HR8KqZ03vf8N6/30+fLnx926rm9N53B7H7YQQTZVY1p3fhw7ER8CqR07u08KqQ07sU8Kqa07sU8Kqa07sU8Kqa07sU8Kqa07sU8Kqa07sU8Kqa07sc8Cqa07sc8Cqa07sk8KqZ07ss8CqZ07s08KqoVSkRvOqppMoEr2KlhlfDq+HV8Gp4Nbwa3uHDq3LSuP8B4ns9kizOrMkAAAAASUVORK5CYII=</binary>
</FictionBook>